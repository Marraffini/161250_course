<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>161250 Data Analysis - Chapter 8:Analysis of Variance (ANOVA) and Analysis of Covariance (ANCOVA)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">161250 Data Analysis</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../slides.html" rel="" target="">
 <span class="menu-text">Slides</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../studyguide/index.html" rel="" target="">
 <span class="menu-text">Study Guide</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../workshops/ws01.html" rel="" target="">
 <span class="menu-text">Workshops</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-extra-code" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Extra Code</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-extra-code">    
        <li>
    <a class="dropdown-item" href="../exercises/Chap2more.R" rel="" target="">
 <span class="dropdown-text">Ex2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../exercises/Chap3more.R" rel="" target="">
 <span class="dropdown-text">Ex3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../exercises/Chap4more.R" rel="" target="">
 <span class="dropdown-text">Ex4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../exercises/Chap5more.R" rel="" target="">
 <span class="dropdown-text">Ex5</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../exercises/Chap6more.R" rel="" target="">
 <span class="dropdown-text">Ex6</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../exercises/Chap7more.R" rel="" target="">
 <span class="dropdown-text">Ex7</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../exercises/Chap8more.R" rel="" target="">
 <span class="dropdown-text">Ex8</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <div class="quarto-navbar-tools ms-auto">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#learning-objectives" id="toc-learning-objectives" class="nav-link active" data-scroll-target="#learning-objectives">Learning Objectives</a></li>
  <li><a href="#anova" id="toc-anova" class="nav-link" data-scroll-target="#anova">ANOVA</a></li>
  <li><a href="#one-way-anova" id="toc-one-way-anova" class="nav-link" data-scroll-target="#one-way-anova">One-way ANOVA</a></li>
  <li><a href="#one-way-single-factor-anova-model" id="toc-one-way-single-factor-anova-model" class="nav-link" data-scroll-target="#one-way-single-factor-anova-model">One-way (single factor) ANOVA model</a></li>
  <li><a href="#one-way-single-factor-anova-model-1" id="toc-one-way-single-factor-anova-model-1" class="nav-link" data-scroll-target="#one-way-single-factor-anova-model-1">One-way (single factor) ANOVA model</a></li>
  <li><a href="#anova-table" id="toc-anova-table" class="nav-link" data-scroll-target="#anova-table">ANOVA table</a></li>
  <li><a href="#anova-table-1" id="toc-anova-table-1" class="nav-link" data-scroll-target="#anova-table-1">ANOVA table</a></li>
  <li><a href="#anova-table-2" id="toc-anova-table-2" class="nav-link" data-scroll-target="#anova-table-2">ANOVA table</a></li>
  <li><a href="#anova-table-practice" id="toc-anova-table-practice" class="nav-link" data-scroll-target="#anova-table-practice">ANOVA table practice</a></li>
  <li><a href="#reminder-on-p-values" id="toc-reminder-on-p-values" class="nav-link" data-scroll-target="#reminder-on-p-values">Reminder on P values</a></li>
  <li><a href="#reminder-of-sampling-distributions" id="toc-reminder-of-sampling-distributions" class="nav-link" data-scroll-target="#reminder-of-sampling-distributions">Reminder of Sampling Distributions</a></li>
  <li><a href="#reminder-of-sampling-distributions-1" id="toc-reminder-of-sampling-distributions-1" class="nav-link" data-scroll-target="#reminder-of-sampling-distributions-1">Reminder of Sampling Distributions</a></li>
  <li><a href="#reminder-of-sampling-distributions-2" id="toc-reminder-of-sampling-distributions-2" class="nav-link" data-scroll-target="#reminder-of-sampling-distributions-2">Reminder of Sampling Distributions</a></li>
  <li><a href="#graphical-comparison-of-means" id="toc-graphical-comparison-of-means" class="nav-link" data-scroll-target="#graphical-comparison-of-means">Graphical comparison of means</a></li>
  <li><a href="#one-way-anova-model-assumptions" id="toc-one-way-anova-model-assumptions" class="nav-link" data-scroll-target="#one-way-anova-model-assumptions">One-way ANOVA model Assumptions</a></li>
  <li><a href="#visualize-assumptions" id="toc-visualize-assumptions" class="nav-link" data-scroll-target="#visualize-assumptions">Visualize assumptions</a></li>
  <li><a href="#visualize-assumptions-1" id="toc-visualize-assumptions-1" class="nav-link" data-scroll-target="#visualize-assumptions-1">Visualize assumptions</a></li>
  <li><a href="#equal-variance" id="toc-equal-variance" class="nav-link" data-scroll-target="#equal-variance">Equal variance</a></li>
  <li><a href="#normality" id="toc-normality" class="nav-link" data-scroll-target="#normality">Normality</a></li>
  <li><a href="#tukey-hsd" id="toc-tukey-hsd" class="nav-link" data-scroll-target="#tukey-hsd">Tukey HSD</a></li>
  <li><a href="#tukey-hsd-interval-plot" id="toc-tukey-hsd-interval-plot" class="nav-link" data-scroll-target="#tukey-hsd-interval-plot">Tukey HSD (Interval Plot)</a></li>
  <li><a href="#two-way-two-factor-anova" id="toc-two-way-two-factor-anova" class="nav-link" data-scroll-target="#two-way-two-factor-anova">Two way (two factor) ANOVA</a></li>
  <li><a href="#two-way-two-factor-anova-example" id="toc-two-way-two-factor-anova-example" class="nav-link" data-scroll-target="#two-way-two-factor-anova-example">Two way (two factor) ANOVA example</a></li>
  <li><a href="#run-a-two-way-anova" id="toc-run-a-two-way-anova" class="nav-link" data-scroll-target="#run-a-two-way-anova">Run a Two-way ANOVA</a></li>
  <li><a href="#two-way-model-fit" id="toc-two-way-model-fit" class="nav-link" data-scroll-target="#two-way-model-fit">Two-way model fit</a></li>
  <li><a href="#main-effect-plots" id="toc-main-effect-plots" class="nav-link" data-scroll-target="#main-effect-plots">Main effect plots</a></li>
  <li><a href="#tukey-hsd-1" id="toc-tukey-hsd-1" class="nav-link" data-scroll-target="#tukey-hsd-1">Tukey HSD</a></li>
  <li><a href="#summary-so-far" id="toc-summary-so-far" class="nav-link" data-scroll-target="#summary-so-far">Summary so far</a></li>
  <li><a href="#learning-objectives-part-2" id="toc-learning-objectives-part-2" class="nav-link" data-scroll-target="#learning-objectives-part-2">Learning Objectives: Part 2</a></li>
  <li><a href="#interaction-effect" id="toc-interaction-effect" class="nav-link" data-scroll-target="#interaction-effect">Interaction effect</a></li>
  <li><a href="#two-way-anova-and-interaction-effects" id="toc-two-way-anova-and-interaction-effects" class="nav-link" data-scroll-target="#two-way-anova-and-interaction-effects">Two-way ANOVA and Interaction effects</a></li>
  <li><a href="#interaction-plots" id="toc-interaction-plots" class="nav-link" data-scroll-target="#interaction-plots">Interaction Plots</a></li>
  <li><a href="#interaction-plot-for-zooplankton-data" id="toc-interaction-plot-for-zooplankton-data" class="nav-link" data-scroll-target="#interaction-plot-for-zooplankton-data">Interaction Plot for Zooplankton data</a></li>
  <li><a href="#two-way-model-fit-1" id="toc-two-way-model-fit-1" class="nav-link" data-scroll-target="#two-way-model-fit-1">Two-way model fit</a></li>
  <li><a href="#two-way-model-fit-2" id="toc-two-way-model-fit-2" class="nav-link" data-scroll-target="#two-way-model-fit-2">Two-way model fit</a></li>
  <li><a href="#residual-diagnostics" id="toc-residual-diagnostics" class="nav-link" data-scroll-target="#residual-diagnostics">Residual diagnostics</a></li>
  <li><a href="#interpreting-interactions" id="toc-interpreting-interactions" class="nav-link" data-scroll-target="#interpreting-interactions">Interpreting interactions</a></li>
  <li><a href="#importance-of-interactions" id="toc-importance-of-interactions" class="nav-link" data-scroll-target="#importance-of-interactions">Importance of interactions</a></li>
  <li><a href="#anova-extensions-and-inference" id="toc-anova-extensions-and-inference" class="nav-link" data-scroll-target="#anova-extensions-and-inference">ANOVA extensions and inference</a></li>
  <li><a href="#indicator-variables" id="toc-indicator-variables" class="nav-link" data-scroll-target="#indicator-variables">Indicator variables</a></li>
  <li><a href="#anova-through-regression" id="toc-anova-through-regression" class="nav-link" data-scroll-target="#anova-through-regression">ANOVA through regression</a></li>
  <li><a href="#regression-summary" id="toc-regression-summary" class="nav-link" data-scroll-target="#regression-summary">Regression summary</a></li>
  <li><a href="#regression-and-anova" id="toc-regression-and-anova" class="nav-link" data-scroll-target="#regression-and-anova">Regression and ANOVA</a></li>
  <li><a href="#regression-and-anova-1" id="toc-regression-and-anova-1" class="nav-link" data-scroll-target="#regression-and-anova-1">Regression and ANOVA</a></li>
  <li><a href="#analysis-of-covariance-ancova" id="toc-analysis-of-covariance-ancova" class="nav-link" data-scroll-target="#analysis-of-covariance-ancova">Analysis of Covariance (ANCOVA)</a></li>
  <li><a href="#analysis-of-covariance-ancova-1" id="toc-analysis-of-covariance-ancova-1" class="nav-link" data-scroll-target="#analysis-of-covariance-ancova-1">Analysis of Covariance (ANCOVA)</a></li>
  <li><a href="#ancova-fit" id="toc-ancova-fit" class="nav-link" data-scroll-target="#ancova-fit">ANCOVA fit</a></li>
  <li><a href="#ancova-fit-1" id="toc-ancova-fit-1" class="nav-link" data-scroll-target="#ancova-fit-1">ANCOVA fit</a></li>
  <li><a href="#explanation-of-fit" id="toc-explanation-of-fit" class="nav-link" data-scroll-target="#explanation-of-fit">Explanation of fit</a></li>
  <li><a href="#graphing-the-model" id="toc-graphing-the-model" class="nav-link" data-scroll-target="#graphing-the-model">Graphing the model</a></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary">Summary</a></li>
  <li><a href="#linear-models" id="toc-linear-models" class="nav-link" data-scroll-target="#linear-models">Linear models</a></li>
  <li><a href="#whats-the-difference-between-a-t.test-and-an-anova" id="toc-whats-the-difference-between-a-t.test-and-an-anova" class="nav-link" data-scroll-target="#whats-the-difference-between-a-t.test-and-an-anova">What’s the difference between a t.test and an ANOVA?</a></li>
  <li><a href="#whats-the-difference-between-a-t.test-and-an-anova-1" id="toc-whats-the-difference-between-a-t.test-and-an-anova-1" class="nav-link" data-scroll-target="#whats-the-difference-between-a-t.test-and-an-anova-1">What’s the difference between a t.test and an ANOVA?</a></li>
  <li><a href="#when-to-use-a-t.test-or-an-anova" id="toc-when-to-use-a-t.test-or-an-anova" class="nav-link" data-scroll-target="#when-to-use-a-t.test-or-an-anova">When to use a t.test or an ANOVA?</a></li>
  <li><a href="#what-if-we-just-did-many-t-tests" id="toc-what-if-we-just-did-many-t-tests" class="nav-link" data-scroll-target="#what-if-we-just-did-many-t-tests">What if we just did many t-tests?</a></li>
  <li><a href="#whats-the-difference-between-a-regression-and-an-anova" id="toc-whats-the-difference-between-a-regression-and-an-anova" class="nav-link" data-scroll-target="#whats-the-difference-between-a-regression-and-an-anova">What’s the difference between a regression and an ANOVA?</a></li>
  <li><a href="#whats-the-difference-between-a-regression-and-an-anova-1" id="toc-whats-the-difference-between-a-regression-and-an-anova-1" class="nav-link" data-scroll-target="#whats-the-difference-between-a-regression-and-an-anova-1">What’s the difference between a regression and an ANOVA?</a></li>
  <li><a href="#when-to-use-a-regression-or-an-anova" id="toc-when-to-use-a-regression-or-an-anova" class="nav-link" data-scroll-target="#when-to-use-a-regression-or-an-anova">When to use a regression or an ANOVA?</a></li>
  <li><a href="#reminder-on-hypotheses" id="toc-reminder-on-hypotheses" class="nav-link" data-scroll-target="#reminder-on-hypotheses">Reminder on Hypotheses</a></li>
  <li><a href="#where-to-go-from-here" id="toc-where-to-go-from-here" class="nav-link" data-scroll-target="#where-to-go-from-here">Where to go from here?</a></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="Chapter08.html"><i class="bi bi-file-slides"></i>RevealJS</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Chapter 8:<br>Analysis of Variance (ANOVA) and Analysis of Covariance (ANCOVA)</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="learning-objectives" class="level2">
<h2 class="anchored" data-anchor-id="learning-objectives">Learning Objectives</h2>
<ul>
<li>Define and understand an ANOVA</li>
<li>Use a one-way ANOVA on example data</li>
<li>Understand and calculate an ANOVA table</li>
<li>Describe Tukey’s post hoc tests and assumptions of ANOVAs</li>
<li>Understand the difference between one-way and two-way ANOVAs</li>
</ul>
</section>
<section id="anova" class="level2">
<h2 class="anchored" data-anchor-id="anova">ANOVA</h2>
<ul>
<li><p>Analysis of variance, or ANOVA, is an approach to comparing data with multiple means across different groups, and allows us to see patterns and trends within complex and varied data.</p></li>
<li><p>Used for categorical or grouped data.</p></li>
<li><p>Often data from experiments (treatments make good factors).</p></li>
<li><p>EDA bar, points, or box plots are options to show differences between groups.</p></li>
</ul>
</section>
<section id="one-way-anova" class="level2">
<h2 class="anchored" data-anchor-id="one-way-anova">One-way ANOVA</h2>
<ul>
<li>fabric burn-time data</li>
</ul>
<table class="table">
<thead>
<tr class="header">
<th>fabric 1</th>
<th>fabric 2</th>
<th>fabric 3</th>
<th>fabric 4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>17.8</td>
<td>11.2</td>
<td>11.8</td>
<td>14.9</td>
</tr>
<tr class="even">
<td>16.2</td>
<td>11.4</td>
<td>11</td>
<td>10.8</td>
</tr>
<tr class="odd">
<td>17.5</td>
<td>15.8</td>
<td>10</td>
<td>12.8</td>
</tr>
<tr class="even">
<td>17.4</td>
<td>10</td>
<td>9.2</td>
<td>10.7</td>
</tr>
<tr class="odd">
<td>15</td>
<td>10.4</td>
<td>9.2</td>
<td>10.7</td>
</tr>
</tbody>
</table>
<ul>
<li>Can we regard the mean burn times of the four fabrics as equal?<br>

<ul>
<li>fabric 1 seems to take longer time to burn</li>
</ul></li>
</ul>
</section>
<section id="one-way-single-factor-anova-model" class="level2">
<h2 class="anchored" data-anchor-id="one-way-single-factor-anova-model">One-way (single factor) ANOVA model</h2>
<p>Start with hypotheses and EDA to visualize groups</p>
<ul>
<li><span class="math inline">\(H_0\)</span>: The mean burn times are equal for the four fabrics</li>
<li><span class="math inline">\(H_a\)</span>: The mean burn time of at least one fabric is different.</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>fabric<span class="ot">=</span><span class="fu">read.table</span>(<span class="st">"../data/fabric.txt"</span>, <span class="at">header=</span><span class="cn">TRUE</span>, <span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>fabric <span class="sc">|&gt;</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="fu">factor</span>(fabric), <span class="at">y=</span>burntime))<span class="sc">+</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> <span class="st">"mean_cl_boot"</span>, <span class="at">colour =</span> <span class="st">"blue"</span>, <span class="at">linewidth =</span> <span class="dv">2</span>, <span class="at">size =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Chapter08_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>fabric <span class="sc">|&gt;</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="fu">factor</span>(fabric), <span class="at">y=</span>burntime))<span class="sc">+</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary_bin</span>(<span class="at">fun =</span> <span class="st">"mean"</span>, <span class="at">geom =</span> <span class="st">"bar"</span>, <span class="at">orientation =</span> <span class="st">'x'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Chapter08_files/figure-html/unnamed-chunk-1-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="one-way-single-factor-anova-model-1" class="level2">
<h2 class="anchored" data-anchor-id="one-way-single-factor-anova-model-1">One-way (single factor) ANOVA model</h2>
<p><img src="img/oneway.png" class="img-fluid"></p>
</section>
<section id="anova-table" class="level2">
<h2 class="anchored" data-anchor-id="anova-table">ANOVA table</h2>
<blockquote class="blockquote">
<p>observation = mean + effect + error</p>
</blockquote>
<blockquote class="blockquote">
<p>SS Total = SS Factor + SS Error</p>
</blockquote>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">aov</span>(burntime <span class="sc">~</span> fabric, <span class="at">data =</span> fabric))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value   Pr(&gt;F)    
fabric       3 120.50   40.17   13.89 0.000102 ***
Residuals   16  46.26    2.89                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<ul>
<li>fabric effect on burntime is highly significant.
<ul>
<li>In other words, the null hypothesis of equal mean burntime is rejected.
<ul>
<li>Or alternatively the mean burntime is different for <strong>at least</strong> one fabric</li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="anova-table-1" class="level2">
<h2 class="anchored" data-anchor-id="anova-table-1">ANOVA table</h2>
<p>How are these values calculated?</p>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value   Pr(&gt;F)    
fabric       3 120.50   40.17   13.89 0.000102 ***
Residuals   16  46.26    2.89                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: left;">SS</th>
<th style="text-align: left;">df</th>
<th style="text-align: center;">MeanSq</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">FACTOR</td>
<td style="text-align: left;">k-1</td>
<td style="text-align: center;">FACTOR SS/(k-1)</td>
</tr>
<tr class="even">
<td style="text-align: left;">ERROR</td>
<td style="text-align: left;">n-k</td>
<td style="text-align: center;">ERROR SS/(n-k)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TOTAL</td>
<td style="text-align: left;">n-1</td>
<td style="text-align: center;">TOTAL SS/(n-1)</td>
</tr>
</tbody>
</table>
</section>
<section id="anova-table-2" class="level2">
<h2 class="anchored" data-anchor-id="anova-table-2">ANOVA table</h2>
<p>Calculating F values of a factor:</p>
<p><span class="math inline">\(F = \frac{MS_{Factor}}{MS_{Error}}\)</span></p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: left;">SS</th>
<th style="text-align: left;">df</th>
<th style="text-align: center;">MeanSq</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">FACTOR</td>
<td style="text-align: left;">k-1</td>
<td style="text-align: center;">FACTOR SS/(k-1)</td>
</tr>
<tr class="even">
<td style="text-align: left;">ERROR</td>
<td style="text-align: left;">n-k</td>
<td style="text-align: center;">ERROR SS/(n-k)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TOTAL</td>
<td style="text-align: left;">n-1</td>
<td style="text-align: center;">TOTAL SS/(n-1)</td>
</tr>
</tbody>
</table>
</section>
<section id="anova-table-practice" class="level2">
<h2 class="anchored" data-anchor-id="anova-table-practice">ANOVA table practice</h2>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: left;">SS</th>
<th style="text-align: left;">df</th>
<th style="text-align: left;">MeanSq</th>
<th style="text-align: left;">F- value</th>
<th style="text-align: center;">P-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">FACTOR</td>
<td style="text-align: left;">k-1</td>
<td style="text-align: left;">FACTOR SS/(k-1)</td>
<td style="text-align: left;">MSF/MSE</td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">ERROR</td>
<td style="text-align: left;">n-k</td>
<td style="text-align: left;">ERROR SS/(n-k)</td>
<td style="text-align: left;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">TOTAL</td>
<td style="text-align: left;">n-1</td>
<td style="text-align: left;">TOTAL SS/(n-1)</td>
<td style="text-align: left;"></td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">SS</th>
<th style="text-align: left;">df</th>
<th style="text-align: left;">MeanSq</th>
<th style="text-align: left;">F- value</th>
<th style="text-align: center;">P-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">fabric</td>
<td style="text-align: left;">120.5</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Residuals</td>
<td style="text-align: left;">46.3</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">TOTAL</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>
</section>
<section id="reminder-on-p-values" class="level2">
<h2 class="anchored" data-anchor-id="reminder-on-p-values">Reminder on P values</h2>
<p>In null-hypothesis significance testing, the p-value is the probability of obtaining test results at least as extreme as the result actually observed, under the assumption that the null hypothesis is correct.</p>
<p>A very small p-value means that such an extreme observed outcome would be very unlikely under the null hypothesis.</p>
<p>We calculate them based on our theoretical sampling distributions (normal, <span class="math inline">\(t\)</span>, <span class="math inline">\(F\)</span>, <span class="math inline">\(\chi^2\)</span>)</p>
</section>
<section id="reminder-of-sampling-distributions" class="level2">
<h2 class="anchored" data-anchor-id="reminder-of-sampling-distributions">Reminder of Sampling Distributions</h2>
<p>A sampling distribution is a probabilistic model of sampling variation–it describes the behaviour of some sample statistic</p>
<p>For a normal population, when the population parameters and are known, we can easily derive the sampling distributions of the sample mean or sample variance.</p>
<p>When the population parameters are unknown, we have to estimate them from data.</p>
</section>
<section id="reminder-of-sampling-distributions-1" class="level2">
<h2 class="anchored" data-anchor-id="reminder-of-sampling-distributions-1">Reminder of Sampling Distributions</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Chapter08_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Chapter08_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="reminder-of-sampling-distributions-2" class="level2">
<h2 class="anchored" data-anchor-id="reminder-of-sampling-distributions-2">Reminder of Sampling Distributions</h2>
</section>
<section id="graphical-comparison-of-means" class="level2">
<h2 class="anchored" data-anchor-id="graphical-comparison-of-means">Graphical comparison of means</h2>
<ul>
<li>The graph below shows individual 95% confidence intervals for the fabric means
<ul>
<li>Pooled SD (<span class="math inline">\(\sqrt{MSE}\)</span>) is NOT used</li>
</ul></li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Chapter08_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="one-way-anova-model-assumptions" class="level2">
<h2 class="anchored" data-anchor-id="one-way-anova-model-assumptions">One-way ANOVA model Assumptions</h2>
<ul>
<li>Residuals are randomly and normally distributed</li>
<li>Residuals must be independent of means.
<ul>
<li>If SD increases with mean, try square root or logarithmic transformation.</li>
</ul></li>
<li>The ANOVA model assumes equal SD for the treatments.</li>
<li>If experimental errors are more in some subgroups, divide the problem into separate ones.</li>
<li>Positive correlation among residuals leads to under estimation of error variance; negative correlation leads to overestimation.<br>
</li>
</ul>
<p><em>These assumptions are harder to validate to small experimental design data</em></p>
</section>
<section id="visualize-assumptions" class="level2">
<h2 class="anchored" data-anchor-id="visualize-assumptions">Visualize assumptions</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">aov</span>(burntime <span class="sc">~</span> fabric, <span class="at">data =</span> fabric))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Chapter08_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Chapter08_files/figure-html/unnamed-chunk-7-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Chapter08_files/figure-html/unnamed-chunk-7-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Chapter08_files/figure-html/unnamed-chunk-7-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="visualize-assumptions-1" class="level2">
<h2 class="anchored" data-anchor-id="visualize-assumptions-1">Visualize assumptions</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>fabric <span class="sc">|&gt;</span> </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(fabric) <span class="sc">|&gt;</span> </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean =</span> <span class="fu">mean</span>(burntime),</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd =</span> <span class="fu">sd</span>(burntime)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> mean, <span class="at">y =</span> sd, <span class="at">group =</span> <span class="fu">factor</span>(<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-meansd" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Chapter08_files/figure-html/fig-meansd-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;1: SD vs mean for four fabrics</figcaption>
</figure>
</div>
</div>
</div>
<p>With only four fabrics in the sample, it is difficult to make any definitive claim.</p>
<p>If the assumptions were valid, we would expect the four points to fall approximately along a horizontal band indicating constant standard deviations, and hence variances, regardless of the means of the groups.</p>
<p>This figure suggests that this is the case, so the assumption of equal variances appears to be valid.</p>
</section>
<section id="equal-variance" class="level2">
<h2 class="anchored" data-anchor-id="equal-variance">Equal variance</h2>
<p><strong>Bartlett’s test</strong>: - null hypothesis: equal variances - but it has an assumption of its own (response variable must be normally distributed)</p>
<p><strong>Levene’s test</strong> - null hypothesis: equal variances - is applicable for any continuous distribution</p>
<div class="cell" data-layout-align="center" data-warnings="false">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bartlett.test</span>(burntime <span class="sc">~</span> fabric, <span class="at">data =</span> fabric)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Bartlett test of homogeneity of variances

data:  burntime by fabric
Bartlett's K-squared = 2.6606, df = 3, p-value = 0.447</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">leveneTest</span>(burntime <span class="sc">~</span> fabric, <span class="at">data =</span> fabric)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Levene's Test for Homogeneity of Variance (center = median)
      Df F value Pr(&gt;F)
group  3  0.1788 0.9092
      16               </code></pre>
</div>
</div>
</section>
<section id="normality" class="level2">
<h2 class="anchored" data-anchor-id="normality">Normality</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>aov_fabric <span class="ot">&lt;-</span> <span class="fu">aov</span>(burntime <span class="sc">~</span> fabric, <span class="at">data =</span> fabric)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(aov_fabric<span class="sc">$</span>residuals)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  aov_fabric$residuals
W = 0.88926, p-value = 0.02606</code></pre>
</div>
</div>
<p>ANOVAs are robust to mild issues of non-normality</p>
<p>But if have issues with normality and unequal variance try transformations</p>
</section>
<section id="tukey-hsd" class="level2">
<h2 class="anchored" data-anchor-id="tukey-hsd">Tukey HSD</h2>
<ul>
<li>Tukey HSD (Honest Significant Differences) plot allows pairwise comparison of treatment means.</li>
<li>Which fabric types have different burn times? (remember the alternative hypothesis of a one-way ANOVA is <em>at least</em> one of the means are different)</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>  Tukey multiple comparisons of means
    95% family-wise confidence level

Fit: aov(formula = burntime ~ fabric, data = fabric)

$fabric
                   diff      lwr      upr     p adj
Fabric 2-Fabric 1 -5.02 -8.09676 -1.94324 0.0013227
Fabric 3-Fabric 1 -6.54 -9.61676 -3.46324 0.0000851
Fabric 4-Fabric 1 -4.80 -7.87676 -1.72324 0.0019981
Fabric 3-Fabric 2 -1.52 -4.59676  1.55676 0.5094118
Fabric 4-Fabric 2  0.22 -2.85676  3.29676 0.9968426
Fabric 4-Fabric 3  1.74 -1.33676  4.81676 0.3968476</code></pre>
</div>
</div>
</section>
<section id="tukey-hsd-interval-plot" class="level2">
<h2 class="anchored" data-anchor-id="tukey-hsd-interval-plot">Tukey HSD (Interval Plot)</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Chapter08_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="two-way-two-factor-anova" class="level2">
<h2 class="anchored" data-anchor-id="two-way-two-factor-anova">Two way (two factor) ANOVA</h2>
<ul>
<li><p>Two factors are present.</p></li>
<li><p>A two-way ANOVA is used to estimate how the mean of a continuous variable changes according to the levels of two categorical variables.</p></li>
<li><p>Use a two-way ANOVA when you want to know how two independent variables, in combination, affect a dependent variable.</p></li>
<li><p>Very similar to multiple regression but with categorical variables.</p></li>
</ul>
</section>
<section id="two-way-two-factor-anova-example" class="level2">
<h2 class="anchored" data-anchor-id="two-way-two-factor-anova-example">Two way (two factor) ANOVA example</h2>
<ul>
<li>Example: Twelve tanks, six each with water from one of the two lakes were set up. Three nutrient supplements were added to each tank. The count of zooplankton in a unit volume of water was then noted.</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code> Zooplankton Supplement     Lake
          34          1     Rose
          43          1     Rose
          57          1 Dennison
          40          1 Dennison
          85          2     Rose
          68          2     Rose
          67          2 Dennison
          53          2 Dennison
          41          3     Rose
          24          3     Rose
          42          3 Dennison
          52          3 Dennison</code></pre>
</div>
</div>
</section>
<section id="run-a-two-way-anova" class="level2">
<h2 class="anchored" data-anchor-id="run-a-two-way-anova">Run a Two-way ANOVA</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">aov</span>(Zooplankton<span class="sc">~</span><span class="fu">factor</span>(Supplement)<span class="sc">+</span>Lake, <span class="at">data=</span>zooplankton))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                   Df Sum Sq Mean Sq F value Pr(&gt;F)  
factor(Supplement)  2 1918.5   959.2   6.486 0.0212 *
Lake                1   21.3    21.3   0.144 0.7140  
Residuals           8 1183.2   147.9                 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>A two-way ANOVA tests two null hypotheses at the same time:</p>
<ul>
<li>All group means are equal at each level of the first variable</li>
<li>All group means are equal at each level of the second variable</li>
</ul>
</section>
<section id="two-way-model-fit" class="level2">
<h2 class="anchored" data-anchor-id="two-way-model-fit">Two-way model fit</h2>
<blockquote class="blockquote">
<p>Model:<br>
Observation = Overall Mean + Factor 1 Effect + Factor 2 Effect + Error</p>
</blockquote>
<ul>
<li><span class="math inline">\(H_0\)</span>: factor 1 means are equal; factor 2 means are equal</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>                   Df Sum Sq Mean Sq F value Pr(&gt;F)  
factor(Supplement)  2 1918.5   959.2   6.486 0.0212 *
Lake                1   21.3    21.3   0.144 0.7140  
Residuals           8 1183.2   147.9                 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Supplement effect is significant at 5% level but not the Lake effect</p>
</section>
<section id="main-effect-plots" class="level2">
<h2 class="anchored" data-anchor-id="main-effect-plots">Main effect plots</h2>
<ul>
<li>Simply plot of response means for factor levels</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Chapter08_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="tukey-hsd-1" class="level2">
<h2 class="anchored" data-anchor-id="tukey-hsd-1">Tukey HSD</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>zoo <span class="ot">&lt;-</span> <span class="fu">aov</span>(Zooplankton<span class="sc">~</span><span class="fu">factor</span>(Supplement)<span class="sc">+</span>Lake, <span class="at">data=</span>zooplankton)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">TukeyHSD</span>(zoo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Tukey multiple comparisons of means
    95% family-wise confidence level

Fit: aov(formula = Zooplankton ~ factor(Supplement) + Lake, data = zooplankton)

$`factor(Supplement)`
      diff         lwr       upr     p adj
2-1  24.75   0.1779866 49.322013 0.0485023
3-1  -3.75 -28.3220134 20.822013 0.9017260
3-2 -28.50 -53.0720134 -3.927987 0.0256900

$Lake
                   diff       lwr      upr     p adj
Rose-Dennison -2.666667 -18.85781 13.52447 0.7139803</code></pre>
</div>
</div>
</section>
<section id="summary-so-far" class="level2">
<h2 class="anchored" data-anchor-id="summary-so-far">Summary so far</h2>
<ul>
<li>ANOVA: 1 and 2 factor</li>
<li>ANOVA table</li>
<li>Assumptions</li>
<li>Tukey’s HSD</li>
</ul>
</section>
<section id="learning-objectives-part-2" class="level2">
<h2 class="anchored" data-anchor-id="learning-objectives-part-2">Learning Objectives: Part 2</h2>
<ul>
<li>Understand the use of interactions in linear models</li>
<li>Use a two-way ANOVA with interactions on example data</li>
<li>Understand and calculate an ANOVA table when interactions are present</li>
<li>Describe Tukey’s post hoc tests and assumptions of ANOVAs with interactions</li>
<li>Understand the difference and similarities between this chapter and previous linear models covered</li>
</ul>
</section>
<section id="interaction-effect" class="level2">
<h2 class="anchored" data-anchor-id="interaction-effect">Interaction effect</h2>
<ul>
<li>Whether Factor A effects are constant over Factor B effects or Factor B effects are constant over Factor A effects?
<ul>
<li>If the answer is no, then there is an interaction between A &amp; B.</li>
</ul></li>
<li>Example:
<ul>
<li>Temperature and pressure are factors affecting the yield in chemical experiments.</li>
<li>They do <code>interact</code> in a mechanistic sense.</li>
</ul></li>
</ul>
<p><code>Interaction</code> may or may not have physical meaning.</p>
</section>
<section id="two-way-anova-and-interaction-effects" class="level2">
<h2 class="anchored" data-anchor-id="two-way-anova-and-interaction-effects">Two-way ANOVA and Interaction effects</h2>
<p>A two-way ANOVA with interaction tests three null hypotheses at the same time:</p>
<ul>
<li>All group means are equal at each level of the first variable</li>
<li>All group means are equal at each level of the second variable</li>
<li>There is no interaction effect between the two variables</li>
</ul>
</section>
<section id="interaction-plots" class="level2">
<h2 class="anchored" data-anchor-id="interaction-plots">Interaction Plots</h2>
<ul>
<li>In the absence of interaction, the plotted means of factor will be roughly parallel
<ul>
<li>see Plot 1. A &amp; B do not interact.</li>
</ul></li>
<li>If the the plotted means of factor crossings are far from parallel, then there is interaction
<ul>
<li>Plot 2 shows extreme (antagonistic) interaction between A &amp; B.</li>
</ul></li>
</ul>
<p><img src="img/interaction.png" class="img-fluid"></p>
</section>
<section id="interaction-plot-for-zooplankton-data" class="level2">
<h2 class="anchored" data-anchor-id="interaction-plot-for-zooplankton-data">Interaction Plot for Zooplankton data</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(zooplankton)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>p1<span class="ot">=</span> <span class="fu">ggplot</span>(<span class="at">data =</span> zooplankton, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(Supplement), <span class="at">y =</span> Zooplankton, <span class="at">group=</span>Lake, <span class="at">colour=</span>Lake)) <span class="sc">+</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun=</span>mean, <span class="at">geom=</span><span class="st">"point"</span>)<span class="sc">+</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun=</span>mean, <span class="at">geom=</span><span class="st">"line"</span>)<span class="sc">+</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="fu">mean</span>(Zooplankton), <span class="at">slope=</span><span class="dv">0</span>)<span class="sc">+</span> </span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"Lake*Supplement Interaction effect"</span>)</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>p2<span class="ot">=</span> <span class="fu">ggplot</span>(<span class="at">data =</span> zooplankton, <span class="fu">aes</span>(<span class="at">x =</span> Lake, <span class="at">y =</span> Zooplankton, <span class="at">group=</span><span class="fu">factor</span>(Supplement), <span class="at">colour=</span><span class="fu">factor</span>(Supplement))) <span class="sc">+</span><span class="fu">stat_summary</span>(<span class="at">fun=</span>mean, <span class="at">geom=</span><span class="st">"point"</span>)<span class="sc">+</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun=</span>mean, <span class="at">geom=</span><span class="st">"line"</span>)<span class="sc">+</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="fu">mean</span>(Zooplankton), <span class="at">slope=</span><span class="dv">0</span>)<span class="sc">+</span> </span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"Lake*Supplement Interaction effect"</span>)</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>p1<span class="sc">+</span>p2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Chapter08_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Interaction effect may be present</li>
</ul>
</section>
<section id="two-way-model-fit-1" class="level2">
<h2 class="anchored" data-anchor-id="two-way-model-fit-1">Two-way model fit</h2>
<blockquote class="blockquote">
<p>observation = mean + Factor A + Factor B + interaction effect + error</p>
</blockquote>
<ul>
<li><p>The above model is known as <code>multiplicative</code> model</p></li>
<li><p>If interaction effect is ignored, we deal with an <code>additive</code> model</p></li>
</ul>
<p>Example: zooplankton data</p>
</section>
<section id="two-way-model-fit-2" class="level2">
<h2 class="anchored" data-anchor-id="two-way-model-fit-2">Two-way model fit</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>zooplankton <span class="sc">|&gt;</span> </span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Supplement =</span> <span class="fu">factor</span>(Supplement)) <span class="sc">|&gt;</span> </span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aov</span>(<span class="at">formula =</span> Zooplankton <span class="sc">~</span> Supplement <span class="sc">*</span> Lake) <span class="sc">|&gt;</span> </span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                Df Sum Sq Mean Sq F value Pr(&gt;F)  
Supplement       2 1918.5   959.2   9.253 0.0147 *
Lake             1   21.3    21.3   0.206 0.6660  
Supplement:Lake  2  561.2   280.6   2.707 0.1453  
Residuals        6  622.0   103.7                 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section>
<section id="residual-diagnostics" class="level2">
<h2 class="anchored" data-anchor-id="residual-diagnostics">Residual diagnostics</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Chapter08_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="interpreting-interactions" class="level2">
<h2 class="anchored" data-anchor-id="interpreting-interactions">Interpreting interactions</h2>
<ul>
<li><p>If an interaction term is significant, the effect of Factor A <strong>depends</strong> on Factor B (and vice versa)</p></li>
<li><p>Use interaction plots to visualize</p></li>
<li><p>Posthoc tests to examine different level combinations</p></li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">TukeyHSD</span>(modl)<span class="sc">$</span><span class="st">`</span><span class="at">Supplement:Lake</span><span class="st">`</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                       diff        lwr       upr      p adj
2:Dennison-1:Dennison  11.5 -29.021538 52.021538 0.85366635
3:Dennison-1:Dennison  -1.5 -42.021538 39.021538 0.99998404
1:Rose-1:Dennison     -10.0 -50.521538 30.521538 0.90834374
2:Rose-1:Dennison      28.0 -12.521538 68.521538 0.19396469
3:Rose-1:Dennison     -16.0 -56.521538 24.521538 0.64065141
3:Dennison-2:Dennison -13.0 -53.521538 27.521538 0.78826884
1:Rose-2:Dennison     -21.5 -62.021538 19.021538 0.38790493
2:Rose-2:Dennison      16.5 -24.021538 57.021538 0.61553864
3:Rose-2:Dennison     -27.5 -68.021538 13.021538 0.20490820
1:Rose-3:Dennison      -8.5 -49.021538 32.021538 0.94964396
2:Rose-3:Dennison      29.5 -11.021538 70.021538 0.16443780
3:Rose-3:Dennison     -14.5 -55.021538 26.021538 0.71593144
2:Rose-1:Rose          38.0  -2.521538 78.521538 0.06517642
3:Rose-1:Rose          -6.0 -46.521538 34.521538 0.98804470
3:Rose-2:Rose         -44.0 -84.521538 -3.478462 0.03503205</code></pre>
</div>
</div>
</section>
<section id="importance-of-interactions" class="level2">
<h2 class="anchored" data-anchor-id="importance-of-interactions">Importance of interactions</h2>
<ul>
<li><p>When you have statistically significant interaction effects, you can’t interpret the main effects without considering the interactions</p></li>
<li><p>Interactions can be used to control for unhelpful variation (blocking effect in experiments)</p></li>
<li><p>Interactions can be mechanistically meaningful</p></li>
</ul>
</section>
<section id="anova-extensions-and-inference" class="level2">
<h2 class="anchored" data-anchor-id="anova-extensions-and-inference">ANOVA extensions and inference</h2>
<p>Linear models can theoretically be performed with an infinite amount of predictors</p>
<p>The more predictors the more samples needed, your effect sample number is no longer your total sample size but the lowest treatment</p>
<p>Interaction effects with more than 3 (sometimes even more than 2) become very difficult to interpret and visualize</p>
<p>Good experimental design and causal thinking can aid in analysis design, design test then collect data, it is much harder the other way around</p>
</section>
<section id="indicator-variables" class="level2">
<h2 class="anchored" data-anchor-id="indicator-variables">Indicator variables</h2>
<ul>
<li>Indicator variables are used if the predictor is qualitative rather than quantitative.
<ul>
<li>Consider gender, a categorical variable.
<ul>
<li>Let <span class="math inline">\(I_1\)</span> be an indicator variable that takes a value 1 for males and 0 for females.<br>
</li>
<li>Let <span class="math inline">\(I_2\)</span> takes 1 for females and 0 for males.</li>
<li>Note only one of <span class="math inline">\(I_1\)</span> &amp; <span class="math inline">\(I_2\)</span> is sufficient.</li>
</ul></li>
</ul></li>
<li>The minimum number of indicator variables needed is related to degrees of freedom.</li>
</ul>
</section>
<section id="anova-through-regression" class="level2">
<h2 class="anchored" data-anchor-id="anova-through-regression">ANOVA through regression</h2>
<ul>
<li>Consider the burn-time data for the four fabrics.
<ul>
<li>The four fabric types are categorical.</li>
<li>Define-
<ul>
<li><span class="math inline">\(I_1\)</span> = 1 for fabric 1 and 0 otherwise</li>
<li><span class="math inline">\(I_2\)</span> = 1 for fabric 2 and 0 otherwise</li>
<li><span class="math inline">\(I_3\)</span> = 1 for fabric 3 and 0 otherwise</li>
<li><span class="math inline">\(I_4\)</span> = 1 for fabric 4 and 0 otherwise</li>
</ul></li>
</ul></li>
<li>Note that any THREE indicator variables are sufficient for the four fabrics.
<ul>
<li>3 df for 4 fabrics</li>
</ul></li>
</ul>
</section>
<section id="regression-summary" class="level2">
<h2 class="anchored" data-anchor-id="regression-summary">Regression summary</h2>
<ul>
<li>Regress the burn-time response on the indicator variables <span class="math inline">\(I_1\)</span>,<span class="math inline">\(I_2\)</span>, <span class="math inline">\(I_3\)</span> &amp; <span class="math inline">\(I_4\)</span></li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>   burntime   fabric I1 I2 I3 I4
1      17.8 Fabric 1  1  0  0  0
2      16.2 Fabric 1  1  0  0  0
3      17.5 Fabric 1  1  0  0  0
4      17.4 Fabric 1  1  0  0  0
5      15.0 Fabric 1  1  0  0  0
6      11.2 Fabric 2  0  1  0  0
7      11.4 Fabric 2  0  1  0  0
8      15.8 Fabric 2  0  1  0  0
9      10.0 Fabric 2  0  1  0  0
10     10.4 Fabric 2  0  1  0  0
11     11.8 Fabric 3  0  0  1  0
12     11.0 Fabric 3  0  0  1  0
13     10.0 Fabric 3  0  0  1  0
14      9.2 Fabric 3  0  0  1  0
15      9.2 Fabric 3  0  0  1  0
16     14.9 Fabric 4  0  0  0  1
17     10.8 Fabric 4  0  0  0  1
18     12.8 Fabric 4  0  0  0  1
19     10.7 Fabric 4  0  0  0  1
20     10.7 Fabric 4  0  0  0  1</code></pre>
</div>
</div>
</section>
<section id="regression-and-anova" class="level2">
<h2 class="anchored" data-anchor-id="regression-and-anova">Regression and ANOVA</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = burntime ~ I1 + I2 + I3, data = fabric)

Residuals:
   Min     1Q Median     3Q    Max 
-1.780 -1.205 -0.460  0.775  4.040 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  11.9800     0.7604  15.754 3.65e-11 ***
I1            4.8000     1.0754   4.463 0.000392 ***
I2           -0.2200     1.0754  -0.205 0.840485    
I3           -1.7400     1.0754  -1.618 0.125206    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.7 on 16 degrees of freedom
Multiple R-squared:  0.7226,    Adjusted R-squared:  0.6706 
F-statistic: 13.89 on 3 and 16 DF,  p-value: 0.0001016</code></pre>
</div>
</div>
<ul>
<li>Compare with the one-way output</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value   Pr(&gt;F)    
fabric       3 120.50   40.17   13.89 0.000102 ***
Residuals   16  46.26    2.89                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section>
<section id="regression-and-anova-1" class="level2">
<h2 class="anchored" data-anchor-id="regression-and-anova-1">Regression and ANOVA</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>fabric <span class="sc">|&gt;</span> <span class="fu">lm</span>(<span class="at">formula =</span> burntime<span class="sc">~</span>I1<span class="sc">+</span>I2<span class="sc">+</span>I3) <span class="sc">|&gt;</span> <span class="fu">anova</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: burntime
          Df  Sum Sq Mean Sq F value    Pr(&gt;F)    
I1         1 111.521 111.521 38.5718 1.248e-05 ***
I2         1   1.408   1.408  0.4871    0.4952    
I3         1   7.569   7.569  2.6179    0.1252    
Residuals 16  46.260   2.891                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<ul>
<li>Compare with the one-way output</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>  Tukey multiple comparisons of means
    95% family-wise confidence level

Fit: aov(formula = burntime ~ fabric, data = fabric)

$fabric
                   diff      lwr      upr     p adj
Fabric 2-Fabric 1 -5.02 -8.09676 -1.94324 0.0013227
Fabric 3-Fabric 1 -6.54 -9.61676 -3.46324 0.0000851
Fabric 4-Fabric 1 -4.80 -7.87676 -1.72324 0.0019981
Fabric 3-Fabric 2 -1.52 -4.59676  1.55676 0.5094118
Fabric 4-Fabric 2  0.22 -2.85676  3.29676 0.9968426
Fabric 4-Fabric 3  1.74 -1.33676  4.81676 0.3968476</code></pre>
</div>
</div>
</section>
<section id="analysis-of-covariance-ancova" class="level2">
<h2 class="anchored" data-anchor-id="analysis-of-covariance-ancova">Analysis of Covariance (ANCOVA)</h2>
<p>Analysis of covariance (ANCOVA) is a statistical method that combines linear regression and analysis of variance (ANOVA) to evaluate the relationship between a response variable and various independent variables while controlling for covariates.</p>
</section>
<section id="analysis-of-covariance-ancova-1" class="level2">
<h2 class="anchored" data-anchor-id="analysis-of-covariance-ancova-1">Analysis of Covariance (ANCOVA)</h2>
<ul>
<li>Indicator variables are used as additional regressors along with a quantitative predictor (covariate).</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code> Restaurant  Sales Households Location I1 I2
          1 135.27        155  Highway  0  0
          2  72.74         93  Highway  0  0
          3 114.95        128  Highway  0  0
          4 102.93        114  Highway  0  0
          5 131.77        158  Highway  0  0
          6 160.91        183  Highway  0  0
          7 179.86        178     Mall  1  0
          8 220.14        215     Mall  1  0
          9 179.64        172     Mall  1  0
         10 185.92        197     Mall  1  0
         11 207.82        207     Mall  1  0
         12 113.51         95     Mall  1  0
         13 203.98        224   Street  0  1
         14 174.48        199   Street  0  1
         15 220.43        240   Street  0  1
         16  93.19        100   Street  0  1</code></pre>
</div>
</div>
<ul>
<li>Plot of data. Do we need three separate models?</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Chapter08_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="ancova-fit" class="level2">
<h2 class="anchored" data-anchor-id="ancova-fit">ANCOVA fit</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>restaurant <span class="sc">|&gt;</span> </span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(<span class="at">formula =</span> Sales<span class="sc">~</span>Households<span class="sc">*</span>Location) <span class="sc">|&gt;</span> </span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>() <span class="sc">|&gt;</span> <span class="fu">coef</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="at">digits=</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                          Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)                 -6.203     11.818  -0.525    0.611
Households                   0.909      0.083  10.906    0.000
LocationMall                39.223     16.451   2.384    0.038
LocationStreet               8.036     16.273   0.494    0.632
Households:LocationMall     -0.074      0.104  -0.710    0.494
Households:LocationStreet   -0.012      0.101  -0.120    0.907</code></pre>
</div>
</div>
</section>
<section id="ancova-fit-1" class="level2">
<h2 class="anchored" data-anchor-id="ancova-fit-1">ANCOVA fit</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Chapter08_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><p>In order to allow for different slopes for each location, we define the product (or interaction) variables <span class="math inline">\(I_1*X\)</span>, and <span class="math inline">\(I_2*X\)</span> (<span class="math inline">\(X\)</span> being the covariate, Households)</p></li>
<li><p>Location is categorical with levels Mall, Street, and Highway</p></li>
</ul>
</section>
<section id="explanation-of-fit" class="level2">
<h2 class="anchored" data-anchor-id="explanation-of-fit">Explanation of fit</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)   -6.203     11.818  -0.525    0.611
X              0.909      0.083  10.906    0.000
I1            39.223     16.451   2.384    0.038
I2             8.036     16.273   0.494    0.632
X:I1          -0.074      0.104  -0.710    0.494
X:I2          -0.012      0.101  -0.120    0.907</code></pre>
</div>
</div>
<ul>
<li><p>For <span class="math inline">\(I_1=0\)</span> &amp; <span class="math inline">\(I_2=0\)</span>, the model becomes the fit for <code>Highway</code></p>
<ul>
<li>So this set-up compares Mall/Street with Highway</li>
</ul></li>
<li><p>Significant <span class="math inline">\(I_1\)</span> coefficient means that Mall location has a constant level of higher sales</p></li>
<li><p>Mall location model has a higher intercept but the slopes are the same for all three locations.</p></li>
</ul>
</section>
<section id="graphing-the-model" class="level2">
<h2 class="anchored" data-anchor-id="graphing-the-model">Graphing the model</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Chapter08_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="summary" class="level2">
<h2 class="anchored" data-anchor-id="summary">Summary</h2>
<p>ANOVA models study categorical predictors (factors).</p>
<pre><code>-   Interaction between factors is important. 
-   ANOVA models and regression models are related and fall under a general family of linear models.</code></pre>
<p>ANCOVA models employs both numerical variables (covariates) and qualitative factors for modelling.</p>
<pre><code>-   Interaction between factors and covariates is important.</code></pre>
</section>
<section id="linear-models" class="level2">
<h2 class="anchored" data-anchor-id="linear-models">Linear models</h2>
<p>Family tree</p>
<p>T-tests, regressions, ANOVAs, and ANCOVAs are related</p>
<p>Similarities:</p>
<pre><code>-   1 continuous response variable
-   Assumptions: normality, equal variance, and independence of residuals</code></pre>
<p>Differences:</p>
<pre><code>- EDA
- test statistics
- number and type of predictors</code></pre>
</section>
<section id="whats-the-difference-between-a-t.test-and-an-anova" class="level2">
<h2 class="anchored" data-anchor-id="whats-the-difference-between-a-t.test-and-an-anova">What’s the difference between a t.test and an ANOVA?</h2>
<p>A t-test is used to determine whether or not there is a statistically significant difference between the means of two groups</p>
<ul>
<li>sample group vs hypothetical population <strong>One-sample t-test</strong></li>
<li>two independent samples <strong>Two-sample t-test</strong>
<ul>
<li>also called independent t-test because the two samples are considered independent</li>
</ul></li>
<li>samples linked in some why, not independent <strong>Paired t-test</strong></li>
</ul>
<p>An ANOVA is used to determine whether or not there is a statistically significant difference between the means of three or more groups, <strong>but not which group</strong></p>
<ul>
<li>one factor split into 3 or more groups (levels) <strong>One-way ANOVA</strong></li>
<li>two factors split into 3 or more groups (levels) <strong>Two-way ANOVA</strong></li>
<li>more than two factors <strong>Three factor ANOVA</strong> etc…</li>
</ul>
</section>
<section id="whats-the-difference-between-a-t.test-and-an-anova-1" class="level2">
<h2 class="anchored" data-anchor-id="whats-the-difference-between-a-t.test-and-an-anova-1">What’s the difference between a t.test and an ANOVA?</h2>
<p>The main difference between a t-test and an ANOVA is in how the two tests calculate their test statistic to determine if there is a statistically significant difference between groups.</p>
<p>T-test:</p>
<ul>
<li>T statistic: ratio of the mean difference between two groups relative to overal standard deviation of the differences</li>
<li>One-sample t-test: <span class="math inline">\(t = \frac{x-\mu}{s/\sqrt n}\)</span></li>
<li>Two-sample t-test: <span class="math inline">\(t = \frac{(\bar{x_{1}}-\bar{x_{2}})-d}{\frac{s_1}{\sqrt n} + \frac{s_2}{\sqrt n}}\)</span><br>
</li>
<li>Paired t-test: <span class="math inline">\(t=\frac{\bar{d}}{\frac{S_{d}}{\sqrt n}}\)</span></li>
</ul>
<p><span class="math inline">\(s =\)</span> sample standard deviation <span class="math inline">\(d =\)</span> difference</p>
<p>ANOVA:</p>
<ul>
<li><p>F statistic: ratio of the variance between the groups relative to the variance within the groups<br>
</p></li>
<li><p><span class="math inline">\(F = \frac{s_b^2}{s_w^2}\)</span> Where <span class="math inline">\(s_b^2\)</span> is the between sample variance, and <span class="math inline">\(s_w^2\)</span> is the within sample variance.</p></li>
<li><p>MSF/MSE</p></li>
</ul>
</section>
<section id="when-to-use-a-t.test-or-an-anova" class="level2">
<h2 class="anchored" data-anchor-id="when-to-use-a-t.test-or-an-anova">When to use a t.test or an ANOVA?</h2>
<p>In practice, when we want to compare the means of two groups, we use a t-test. When we want to compare the means of three or more groups, we use an ANOVA.</p>
<p>Suppose we have three groups we wish to compare the means between: group A, group B, and group C.</p>
<p>If you did the following t-tests:</p>
<ul>
<li><p>A t-test to compare the difference in means between group A and group B</p></li>
<li><p>A t-test to compare the difference in means between group A and group C</p></li>
<li><p>A t-test to compare the difference in means between group B and group C</p></li>
</ul>
</section>
<section id="what-if-we-just-did-many-t-tests" class="level2">
<h2 class="anchored" data-anchor-id="what-if-we-just-did-many-t-tests">What if we just did many t-tests?</h2>
<p>For each t-test there is a chance that we will commit a type I error, which is the probability that we reject the null hypothesis when it is actually true. Let’s say we set this to 0.05 (<span class="math inline">\(\alpha = 0.05\)</span>). This means that when we perform multiple t-tests, this error rate increases.</p>
<ul>
<li>The probability that we commit a type I error with one t-test is 1 – 0.95 = 0.05.</li>
<li>The probability that we commit a type I error with two t-tests is 1 – (0.95^2) = 0.0975.</li>
<li>The probability that we commit a type I error with three t-tests is 1 – (0.95^3) = 0.1427.</li>
</ul>
<p>The type I error just increases!</p>
<p>We use a post-hoc (after) test to see which group is driving differences, these pairwise comparisons have a correction factor to adjust our Type I error</p>
</section>
<section id="whats-the-difference-between-a-regression-and-an-anova" class="level2">
<h2 class="anchored" data-anchor-id="whats-the-difference-between-a-regression-and-an-anova">What’s the difference between a regression and an ANOVA?</h2>
<p>A regression is used to understand the relationship between predictor variable(s) and a response variable</p>
<ul>
<li>one predictor <strong>Simple Regression</strong></li>
<li>two or more predictors <strong>Multiple Regression</strong></li>
</ul>
<p>An ANOVA is used to determine whether or not there is a statistically significant difference between the means of three or more groups, <strong>but not which group</strong></p>
<ul>
<li>one factor split into 3 or more groups (levels) <strong>One-way ANOVA</strong></li>
<li>two factors split into 3 or more groups (levels) <strong>Two-way ANOVA</strong></li>
<li>more than two factors <strong>Three factor ANOVA</strong> etc…</li>
</ul>
<p>Not too much difference there</p>
</section>
<section id="whats-the-difference-between-a-regression-and-an-anova-1" class="level2">
<h2 class="anchored" data-anchor-id="whats-the-difference-between-a-regression-and-an-anova-1">What’s the difference between a regression and an ANOVA?</h2>
<p>Regression:</p>
<ul>
<li>T statistic: test if each predictor’s estimate is different from 0</li>
<li><span class="math inline">\(R^2\)</span>: proportion of variance explained <span class="math inline">\(\frac{SSR}{SST}\)</span></li>
<li>F statistic: overall F statistic for the regression model, <span class="math inline">\(\frac{MS_{reg}}{MS_{error}}\)</span> where <span class="math inline">\(MS = \frac{SS}{df}\)</span></li>
</ul>
<p>ANOVA:</p>
<ul>
<li>F statistic: ratio of the variance between the groups relative to the variance within the groups<br>
</li>
<li><span class="math inline">\(F = \frac{s_b^2}{s_w^2}\)</span></li>
</ul>
<p>where <span class="math inline">\(s_b^2\)</span> is the between sample variance, and <span class="math inline">\(s_w^2\)</span> is the within sample variance.</p>
<ul>
<li>MSF/MSE</li>
</ul>
<p>The F statistic is the same, thats why you can produce an ANOVA table from your regression</p>
</section>
<section id="when-to-use-a-regression-or-an-anova" class="level2">
<h2 class="anchored" data-anchor-id="when-to-use-a-regression-or-an-anova">When to use a regression or an ANOVA?</h2>
<p>Conventionally, a regression refers to continuous predictors and ANOVAs are used for discrete variables.</p>
<p>BUT …</p>
<p>You can code discrete variable as indicator variables and then treat them as continuous and run a regression!</p>
<p>Generally, if you have 1 continuous and 1 discrete variable you should generate indicator variables and run a multiple regression</p>
<p>If you are using the continuous predictor as a covariate it would be called an <strong>ANCOVA</strong>.</p>
<p>You can code a discrete variable into continuous but if you do the reverse you lose statistical inference.</p>
</section>
<section id="reminder-on-hypotheses" class="level2">
<h2 class="anchored" data-anchor-id="reminder-on-hypotheses">Reminder on Hypotheses</h2>
<p>T-Test: difference between the means of two groups</p>
<ul>
<li>Null: <span class="math inline">\(\mu_{1} - \mu_{2}\)</span> is equal to <span class="math inline">\(0\)</span> Can be <span class="math inline">\(=\)</span>, <span class="math inline">\(\le\)</span>, or <span class="math inline">\(\ge\)</span></li>
<li>Alt: <span class="math inline">\(\mu_{1} - \mu_{2}\)</span> is not equal to <span class="math inline">\(0\)</span> Can be <span class="math inline">\(\ne\)</span>, <span class="math inline">\(&lt;\)</span>, or <span class="math inline">\(&gt;\)</span></li>
</ul>
<p>Regressions: understand the relationship between predictor variable(s) and a response variable</p>
<ul>
<li>Null: true slope coefficient is <span class="math inline">\(= 0\)</span> (i.e.&nbsp;no relationship)</li>
<li>Alt: true slope coefficient <span class="math inline">\(\ne 0\)</span> (i.e.&nbsp;relationship)</li>
</ul>
<p>ANOVA: difference between the means of three or more groups</p>
<ul>
<li>Null: group means are equal</li>
<li>Alt: At least one mean is different</li>
</ul>
</section>
<section id="where-to-go-from-here" class="level2">
<h2 class="anchored" data-anchor-id="where-to-go-from-here">Where to go from here?</h2>
<p>Linear models form the basis of a lot more statistics tests. <!-- ## Exercises --></p>
<!-- download.file("https://www.massey.ac.nz/~kgovinda/220exer/Chap6moreexamples.R", destfile="Chap6moreexamples.R") -->
<!-- download.file("https://www.massey.ac.nz/~kgovinda/220exer/chapter-6-exercises.html", destfile="chapter-6-exercises.html") -->
<!-- install.packages("remotes") -->
<!-- remotes::install_github("ricompute/ricomisc") -->
<!-- ricomisc::rstudio_viewer("chapter-6-exercises.html", file_path = NULL) -->


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>