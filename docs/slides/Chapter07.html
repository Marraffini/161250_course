<!DOCTYPE html>
<html lang="en"><head>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-html/tabby.min.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.3.450">

  <title>161250 Data Analysis - Chapter 7:Models with Multiple Predictors</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="../site_libs/revealjs/dist/theme/quarto.css">
  <link href="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  
  <script src="../site_libs/kePrint-0.0.1/kePrint.js"></script>
  <link href="../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Chapter 7:<br>Models with Multiple Predictors</h1>

<div class="quarto-title-authors">
</div>

</section>
<section id="multiple-regression" class="slide level2">
<h2>Multiple Regression</h2>
<ul>
<li><p>In a simple regression, there is only one predictor. Multiple regression modelling involves many predictors.</p></li>
<li><p>Perform EDA first</p>
<ul>
<li>A scatter plot matrix can show nonlinear relationships</li>
<li>A correlation matrix will only show the strength of pairwise linear relationships</li>
</ul></li>
<li><p>Look for the predictors having the largest correlation with response</p>
<ul>
<li><p>Look for inter-correlations between the predictors and choose the one with high correlation with response variable but uncorrelated with the rest.</p></li>
<li><p>Try <a href="https://shiny.massey.ac.nz/anhsmith/demos/explore.multiple.numerical.variables/" class="uri">https://shiny.massey.ac.nz/anhsmith/demos/explore.multiple.numerical.variables/</a></p></li>
</ul></li>
</ul>
</section>
<section id="pinetree-data-example" class="slide level2">
<h2>Pinetree data example</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>         Top Third Second First
Top    1.000 0.917  0.955 0.972
Third  0.917 1.000  0.947 0.908
Second 0.955 0.947  1.000 0.967
First  0.972 0.908  0.967 1.000</code></pre>
</div>
</div>
</section>
<section id="inter-relationships" class="slide level2">
<h2>Inter-relationships</h2>
<ul>
<li>Strong relationships revealed
<ul>
<li>We may not need all predictors</li>
<li>Area effect also revealed below</li>
</ul></li>
</ul>

<img data-src="Chapter07_files/figure-revealjs/unnamed-chunk-3-1.png" width="960" class="r-stretch quarto-figure-center"></section>
<section id="full-regression" class="slide level2">
<h2>Full regression</h2>
<p>Places all of the predictors in the model</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<table class="lightable-classic" data-quarto-postprocess="true" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>t-tests for model parameters</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">term</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">std.error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-6.043</td>
<td style="text-align: right;">0.799</td>
<td style="text-align: right;">-7.56</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Third</td>
<td style="text-align: right;">0.160</td>
<td style="text-align: right;">0.085</td>
<td style="text-align: right;">1.88</td>
<td style="text-align: right;">0.066</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Second</td>
<td style="text-align: right;">0.044</td>
<td style="text-align: right;">0.137</td>
<td style="text-align: right;">0.32</td>
<td style="text-align: right;">0.750</td>
</tr>
<tr class="even">
<td style="text-align: left;">First</td>
<td style="text-align: right;">0.605</td>
<td style="text-align: right;">0.090</td>
<td style="text-align: right;">6.69</td>
<td style="text-align: right;">0.000</td>
</tr>
</tbody>
</table>


</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<table class="lightable-classic" data-quarto-postprocess="true" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>Model summary measures</caption>
<tbody>
<tr class="odd">
<td style="text-align: left;">r.squared</td>
<td style="text-align: right;">0.95</td>
</tr>
<tr class="even">
<td style="text-align: left;">sigma</td>
<td style="text-align: right;">1.23</td>
</tr>
<tr class="odd">
<td style="text-align: left;">statistic</td>
<td style="text-align: right;">370.85</td>
</tr>
<tr class="even">
<td style="text-align: left;">p.value</td>
<td style="text-align: right;">0.00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">AIC</td>
<td style="text-align: right;">201.34</td>
</tr>
<tr class="even">
<td style="text-align: left;">BIC</td>
<td style="text-align: right;">211.81</td>
</tr>
</tbody>
</table>


</div>
</div>
<ul>
<li>Old summary</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Top ~ ., data = pinetree[, -1])

Residuals:
   Min     1Q Median     3Q    Max 
-2.041 -0.928 -0.297  0.656  3.320 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  -6.0430     0.7989   -7.56  4.0e-10 ***
Third         0.1595     0.0851    1.88    0.066 .  
Second        0.0437     0.1365    0.32    0.750    
First         0.6047     0.0904    6.69  1.1e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.23 on 56 degrees of freedom
Multiple R-squared:  0.952, Adjusted R-squared:  0.95 
F-statistic:  371 on 3 and 56 DF,  p-value: &lt;2e-16</code></pre>
</div>
</div>
<ul>
<li>Also try the app - <a href="https://shiny.massey.ac.nz/anhsmith/demos/fit.multiple.regression/" class="uri">https://shiny.massey.ac.nz/anhsmith/demos/fit.multiple.regression/</a></li>
</ul>
</section>
<section id="multicollinearity" class="slide level2 increment">
<h2>Multicollinearity</h2>
<ul>
<li><p><em>Multicollinearity</em> is where at least two predictor variables are highly correlated.</p></li>
<li><p>Multicollinearity does <em>not</em> affect the residual SD very much, and doesn’t pose a major problem for prediction.</p></li>
<li><p>The major effects of multicolinearity are:</p>
<ul>
<li>It changes the estimates of the coefficients.</li>
<li>It inflates the variance of the estimates of the coefficients. That is, it increases the uncertainty about what the slope parameters are.</li>
<li>Therefore, it matters when testing hypotheses about the effects of specific predictors.</li>
</ul></li>
<li><p>The impact of multicollinearity on the variance of the estimates can be quantified using the Variance Inflation Factor (VIF &lt; 5 is considered ok).</p></li>
<li><p>There are several ways to deal with multicollinarity, depending on context. We can discard one of highly correlated variable, perform ridge regression, or think more carefully about how the variables relate to each other.</p></li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code> Third Second  First 
  9.73  26.18  15.51 </code></pre>
</div>
</div>
<ul>
<li>Try <a href="https://shiny.massey.ac.nz/anhsmith/demos/explore.collinearity/" class="uri">https://shiny.massey.ac.nz/anhsmith/demos/explore.collinearity/</a></li>
</ul>
</section>
<section id="additional-variation-explained" class="slide level2">
<h2>Additional variation explained</h2>
<ul>
<li><p>Variation in <span class="math inline">\(Y\)</span> is separated into two parts SSR and SSE.</p>
<ul>
<li>The shaded overlap of two circles represent the variation in <span class="math inline">\(Y\)</span> explained by the <span class="math inline">\(X\)</span> variables.</li>
</ul></li>
<li><p>The total overlap of <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span>, and <span class="math inline">\(Y\)</span> depends on</p>
<ul>
<li>relationship of <span class="math inline">\(Y\)</span> with <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span></li>
<li>correlation between <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span></li>
</ul>
<p><img data-src="img/5_5.png"></p></li>
</ul>
</section>
<section id="sequential-addition-of-predictors" class="slide level2">
<h2>Sequential addition of predictors</h2>
<ul>
<li>Addition of variables decreases SSE and increases SSR and <span class="math inline">\(R^2\)</span>.</li>
<li><span class="math inline">\(s^2\)</span> = MSE = SSE/df decreases to a minimum and then increases since addition of variable decreases SSE but adds to df.</li>
</ul>

<img data-src="img/5_7.png" class="r-stretch"></section>
<section id="significance-of-type-i-or-seq.ss" class="slide level2">
<h2>Significance of Type I or Seq.SS</h2>
<ul>
<li><p>The Type I SS is the SS of a predictor after adjusting for the effects of the <em>preceding</em> predictors in the model.</p></li>
<li><p>F test for the significance of the additional variation explained</p></li>
</ul>

<img data-src="img/type1.png" class="r-stretch"><ul>
<li>For pinetree data, Second (middle circumference) does not explain significant additional variation after First (bottom circumference)</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Model 1: Top ~ First
Model 2: Top ~ First + Second
  Res.Df  RSS Df Sum of Sq    F Pr(&gt;F)  
1     58 96.6                           
2     57 90.6  1      6.01 3.78  0.057 .
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section>
<section id="type-ii-and-or-type-iii-ss" class="slide level2">
<h2>Type II and or Type III SS</h2>
<ul>
<li><p>R function <code>anova()</code> calculates sequential or Type-I SS</p></li>
<li><p>Type II SS is based on the principle of marginality.</p>
<ul>
<li>Each variable effect is adjusted for all other appropriate effects.
<ul>
<li>equivalent to the Type I SS when the variable is the last predictor entered the model.</li>
</ul></li>
<li>Order matters for Type I SS but not for Type II SS</li>
</ul></li>
</ul>

<img data-src="img/type2.png" class="r-stretch"><ul>
<li><p>Type III SS is the SS added to the regression SS after <em>ALL</em> other predictors including an intercept term.</p>
<ul>
<li>Violates the marginality principle and so avoided for hypothesis tests</li>
</ul></li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: Top
          Df Sum Sq Mean Sq F value  Pr(&gt;F)    
Third      1   1494    1494   981.7 &lt; 2e-16 ***
Second     1    131     131    86.1 6.4e-13 ***
First      1     68      68    44.8 1.1e-08 ***
Residuals 56     85       2                    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Anova Table (Type II tests)

Response: Top
          Sum Sq Df F value  Pr(&gt;F)    
Third        5.4  1    3.52   0.066 .  
Second       0.2  1    0.10   0.750    
First       68.1  1   44.76 1.1e-08 ***
Residuals   85.2 56                    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Anova Table (Type III tests)

Response: Top
            Sum Sq Df F value  Pr(&gt;F)    
(Intercept)   87.1  1   57.22 4.0e-10 ***
Third          5.4  1    3.52   0.066 .  
Second         0.2  1    0.10   0.750    
First         68.1  1   44.76 1.1e-08 ***
Residuals     85.2 56                    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<ul>
<li>SS explained is not always a good criterion for selection of variables</li>
</ul>
</section>
<section id="model-selection" class="slide level2">
<h2>Model selection</h2>
<ul>
<li><p><span class="math inline">\(R^2\)</span> (the proportion of variance explained by the model) should not be used to select among candidate models. Adding another predictor variable always increases the <span class="math inline">\(R^2\)</span>, even if the new variable is unrelated in the population.</p></li>
<li><p><span class="math inline">\(R^2_{adj}\)</span> is adjusted to remove the variation that is explained by chance alone</p></li>
<li><p><span class="math inline">\(R^2_{adj}=1-\frac{MS~Error}{MS~Total}\)</span></p>
<ul>
<li>Try <a href="https://shiny.massey.ac.nz/anhsmith/demos/demo.RSq.and.adjusted.RSq/" class="uri">https://shiny.massey.ac.nz/anhsmith/demos/demo.RSq.and.adjusted.RSq/</a></li>
</ul></li>
<li><p>Residual SD depends on its degrees of freedom</p>
<ul>
<li>So comparison of models based on Residual SD is not fully fair</li>
</ul></li>
<li><p>Other summaries similar to residual SD include</p></li>
<li><p>Mean Squared Deviation (MSD)</p></li>
</ul>
<p><span class="math display">\[\frac{\sum \left({\rm observation-fit}\right)^{{\rm 2}} }{{\rm number~of~ observations}}\]</span></p>
<ul>
<li>Mean Absolute Deviation (MAD)</li>
</ul>
<p><span class="math display">\[\frac{\sum \left|{\rm observation-fit}\right| }{{\rm number~of~observations}}\]</span></p>
<ul>
<li>Mean Absolute Percentage Error (MAPE)</li>
</ul>
<p><span class="math display">\[\frac{\sum \frac{\left|{\rm observation-fit}\right|}{{\rm observation}} }{{\rm number~of~observations}} {\times100}\]</span></p>
</section>
<section id="model-selection-continued" class="slide level2">
<h2>Model selection (continued)</h2>
<ul>
<li><p>Avoid over-fitting.</p>
<ul>
<li>Try <a href="https://shiny.massey.ac.nz/anhsmith/demos/demo.over-fitting.model/" class="uri">https://shiny.massey.ac.nz/anhsmith/demos/demo.over-fitting.model/</a></li>
</ul></li>
<li><p>So place a penalty for excessive model parameters</p></li>
<li><p>Akaike Information Criterion (AIC; <em>smaller is better</em>)</p></li>
</ul>
<p><span class="math display">\[AIC  =  n\log \left(\frac{SSE}{n} \right) + 2p\]</span></p>
<ul>
<li><p>We can also benchmark a small model with the full regression</p></li>
<li><p>Mallow’s <span class="math inline">\(C_p\)</span> (look for <span class="math inline">\(C_p\)</span> just less than <span class="math inline">\(p\)</span> or equal)</p></li>
</ul>
<p><span class="math display">\[C_{p} =\; \frac{{\rm SS\; Error\; for\; Smaller\; Model}}{{\rm Mean\; Square\; Error\; for\; full\; regression}} -(n-2p)\]</span></p>
</section>
<section id="selection-of-predictors" class="slide level2">
<h2>Selection of predictors</h2>
<ul>
<li>Heuristic (short-cut) procedures based on criteria such as <span class="math inline">\(F\)</span>, <span class="math inline">\(R^2_{adj}\)</span>, <span class="math inline">\(AIC\)</span>, <span class="math inline">\(C_p\)</span> etc
<ul>
<li><p><code>Forward Selection</code>: Add variables sequentially</p>
<ul>
<li>convenient to obtain the simplest feasible model</li>
</ul></li>
<li><p><code>Backward Elimination</code>: Drop variables sequentially</p>
<ul>
<li><p>If difference between two variables is significant but not the variables themselves, forward regression would obtain the wrong model since both may not enter the model.</p>
<ul>
<li>Known as <em>suppressor</em> variables case</li>
</ul></li>
</ul></li>
</ul></li>
</ul>
<p>Example: (try)</p>
<ul>
<li><code>Best Subsets</code>: Stop at each step and check whether predictors, in the model or outside, are the best combination for that step.
<ul>
<li>time consuming to perform when the predictor set is large</li>
</ul></li>
</ul>
</section>
<section id="software" class="slide level2">
<h2>Software</h2>
<ul>
<li><p>In <span class="math inline">\(R\)</span>, <code>lm()</code> and <code>step()</code> function will perform the tasks</p>
<ul>
<li><code>leaps()</code> and <code>HH</code> packages contain additional functions</li>
<li>Also <code>MASS</code>, <code>car</code>, <code>caret</code>, and <code>SignifReg</code> R packages</li>
</ul></li>
<li><p>R base package step-wise selection is based on <span class="math inline">\(AIC\)</span> only.</p></li>
<li><p><strong><code>Note</code></strong></p>
<ul>
<li>If a model stands out, it will perform well in terms of all summary measures.</li>
<li>If a model does not stand out, summary measures will contradict.</li>
</ul></li>
</ul>
<p>Examples:</p>
<p><a href="https://shiny.massey.ac.nz/anhsmith/demos/explore.multiple.regression/" class="uri">https://shiny.massey.ac.nz/anhsmith/demos/explore.multiple.regression/</a></p>
</section>
<section id="cross-validated-selection" class="slide level2">
<h2>Cross validated selection</h2>
<ul>
<li>Model selection can be done focussing on prediction
<ul>
<li>method = “leapForward” &amp; method = “leapBackward” options</li>
</ul></li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>Subset selection object
3 Variables  (and intercept)
       Forced in Forced out
Third      FALSE      FALSE
Second     FALSE      FALSE
First      FALSE      FALSE
1 subsets of each size up to 2
Selection Algorithm: backward
         Third Second First
1  ( 1 ) " "   " "    "*"  
2  ( 1 ) "*"   " "    "*"  </code></pre>
</div>
</div>
</section>
<section id="polynomial-models" class="slide level2">
<h2>Polynomial models</h2>
<ul>
<li>A polynomial model includes the square, cube of predictor variables as additional variables.</li>
<li>High correlation (multicollinearity) between the predictor variables may be a problem in polynomial models.</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>                                  Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)                         44.121      7.039    6.27        0
poly(First, degree = 3, raw = T)1   -3.972      0.695   -5.71        0
poly(First, degree = 3, raw = T)2    0.142      0.022    6.39        0
poly(First, degree = 3, raw = T)3   -0.001      0.000   -5.95        0</code></pre>
</div>
</div>
<ul>
<li><p>Multicollinearity can occur with polynomial modelling but not always</p>
<pre><code>- For the pinetree example, all the slope coefficients are highly significant for the cubic regression
- Not so for the quadratic regression</code></pre></li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>                                  Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)                           3.85      2.450   1.569    0.122
poly(First, degree = 2, raw = T)1     0.10      0.155   0.646    0.521
poly(First, degree = 2, raw = T)2     0.01      0.002   4.319    0.000</code></pre>
</div>
</div>
<ul>
<li>Raw polynomials do not preserve the coefficient estimates but orthogonal polynomials do.</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>                         Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)                 17.40      0.146  119.26        0
poly(First, degree = 2)1    41.01      1.130   36.29        0
poly(First, degree = 2)2     4.88      1.130    4.32        0</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                         Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)                 17.40      0.115  151.03        0
poly(First, degree = 3)1    41.01      0.892   45.96        0
poly(First, degree = 3)2     4.88      0.892    5.47        0
poly(First, degree = 3)3    -5.31      0.892   -5.95        0</code></pre>
</div>
</div>
</section>
<section id="residual-diagnostics" class="slide level2">
<h2>Residual diagnostics</h2>
<ul>
<li><p>For multiple regression fits, including polynomial fits, examine the residuals as usual to-</p>
<pre><code>- Validate the model assumptions
- Look for model improvement clues</code></pre></li>
<li><p>Quadratic regression for pinetree data is not satisfactory based on the residual plots shown below:</p></li>
</ul>

<img data-src="Chapter07_files/figure-revealjs/unnamed-chunk-16-1.png" width="960" class="r-stretch quarto-figure-center"></section>
<section id="local-polynomial-ﬁtting-or-spline-smoothing." class="slide level2">
<h2>Local polynomial ﬁtting or spline smoothing.</h2>
<ul>
<li><p>Instead of a single polynomial for all the data, local polynomials or splines can also be fitted.</p></li>
<li><p>For pinetree data, compare the cubic fit with the fifth degree spline fit</p>
<ul>
<li>very similar fits</li>
</ul></li>
</ul>

<img data-src="Chapter07_files/figure-revealjs/unnamed-chunk-17-1.png" width="960" class="r-stretch quarto-figure-center"></section>
<section id="robust-modelling" class="slide level2">
<h2>Robust modelling</h2>
<ul>
<li>Instead of the regression fit using the <code>lm()</code> function, we can also fit robust models
<ul>
<li>We covered <code>MASS::rlm()</code> &amp; <code>robustbase::lmrob()</code> functions in the last chapter</li>
<li>Robust modelling syntax is similar for employing many predictors.</li>
<li>Pinetree example</li>
</ul></li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>                         Value Std. Error t value
(Intercept)              17.40      0.125  139.54
poly(First, degree = 3)1 40.93      0.966   42.37
poly(First, degree = 3)2  4.76      0.966    4.93
poly(First, degree = 3)3 -5.17      0.966   -5.36</code></pre>
</div>
</div>
</section>
<section id="comparison-of-regression-and-robust-fits" class="slide level2">
<h2>Comparison of regression and robust fits</h2>

<img data-src="Chapter07_files/figure-revealjs/unnamed-chunk-19-1.png" width="960" class="r-stretch quarto-figure-center"><ul>
<li>other summaries such as MAPE, MAD can also be obtained</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0629 0.0598 0.0602</code></pre>
</div>
</div>
<ul>
<li>Try for the polynomial fit <code>Top~poly(First,degree=3)</code> which is a better model structure for the pinetree data.</li>
</ul>
</section>
<section id="categorical-predictors" class="slide level2">
<h2>Categorical predictors</h2>
<ul>
<li><p>Models can include categorical predictors such as <strong>Area</strong> in the pinetree dataset</p></li>
<li><p>Make sure that you use the <em>factor()</em> function when numerical codes are assigned to categorical variables.</p></li>
<li><p>Area effect on Top circumference is clear from the following plot</p></li>
</ul>

<img data-src="Chapter07_files/figure-revealjs/unnamed-chunk-21-1.png" width="960" class="r-stretch quarto-figure-center"></section>
<section id="indicator-variables" class="slide level2">
<h2>Indicator variables</h2>
<ul>
<li><p>Factors are employed in a multiple regression using indicator variables which are simply binary variables taking either zero or one</p></li>
<li><p>For for males and females, indicator variables are defined as follows:</p>
<ul>
<li>Indicator variable of males: <span class="math inline">\(~~~~~~~~\begin{array}{cccc} I_{\text {male}} &amp; = &amp; 1 &amp; \text{for males}\\ &amp; &amp; 0&amp; \text{for females} \end{array}\)</span></li>
<li>Indicator variable of females <span class="math inline">\(~~~~~~~~\begin{array}{cccc} I_{\text{female}} &amp; = &amp; 1 &amp; \text{for females}\\ &amp; &amp; 0&amp; \text{for males} \end{array}\)</span></li>
</ul></li>
<li><p>There are three different areas of the forest in the pinetree dataset. So we can define three indicator variables.</p></li>
<li><p>Only two indicator variables are needed because there is only 2 degrees of freedom for the 3 areas.</p></li>
</ul>
</section>
<section id="regression-output" class="slide level2">
<h2>Regression output</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<table class="table table-striped" data-quarto-postprocess="true" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>Regression of Top Circumference on Area Indicator Variables</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">term</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">std.error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">20.02</td>
<td style="text-align: right;">1.11</td>
<td style="text-align: right;">17.98</td>
<td style="text-align: right;">0.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">I2</td>
<td style="text-align: right;">-1.96</td>
<td style="text-align: right;">1.57</td>
<td style="text-align: right;">-1.24</td>
<td style="text-align: right;">0.22</td>
</tr>
<tr class="odd">
<td style="text-align: left;">I3</td>
<td style="text-align: right;">-5.92</td>
<td style="text-align: right;">1.57</td>
<td style="text-align: right;">-3.76</td>
<td style="text-align: right;">0.00</td>
</tr>
</tbody>
</table>


</div>
</div>
<ul>
<li>The y-intercept is the mean of the response for the omitted category
<ul>
<li><code>20.02</code> is the mean Top circumference for the first Area</li>
</ul></li>
<li>slopes are the difference in the mean response
<ul>
<li><code>-1.96</code> is the drop in the mean top circumference in Area 2 when compared to Area 1 (which is not a significant drop)</li>
<li><code>-5.92</code> is the drop in the mean top circumference in Area 3 when compared to Area 1 (which is a highly significant drop)</li>
</ul></li>
</ul>
<p>Analysis of Covariance model employs both numerical and categorical predictors (covered later on).</p>
<ul>
<li>We specifically include the interaction between them</li>
</ul>
</section>
<section id="permutation-tests" class="slide level2">
<h2>Permutation tests</h2>
<p>R package <em>lmPerm</em> function <code>lmp()</code> will obtain the P values by permuting the predictor data.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="fu">library</span>(lmPerm)</span>
<span id="cb17-2"><a href="#cb17-2"></a>mdl  <span class="ot">&lt;-</span>  <span class="fu">lmp</span>(Top<span class="sc">~</span>I2<span class="sc">+</span>I3,  <span class="at">data=</span>pinetree1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Settings:  unique SS : numeric variables centered"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="fu">summary</span>(mdl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lmp(formula = Top ~ I2 + I3, data = pinetree1)

Residuals:
   Min     1Q Median     3Q    Max 
 -8.92  -3.10  -1.01   3.68  11.93 

Coefficients:
   Estimate Iter Pr(Prob)   
I2    -1.96  110   0.4818   
I3    -5.93 5000   0.0048 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 4.98 on 57 degrees of freedom
Multiple R-Squared: 0.205,  Adjusted R-squared: 0.177 
F-statistic: 7.35 on 2 and 57 DF,  p-value: 0.00145 </code></pre>
</div>
</div>
<p>Also try all other cases covered just replacing the <code>lm()</code> command with <code>lmp()</code> command.</p>
</section>
<section id="time-series-smoothing" class="slide level2">
<h2>Time series smoothing</h2>
<ul>
<li>This is a technique to remove the random variation but retain any trend and cyclic type of variations in a time series.
<ul>
<li><code>Moving Average Smoothing</code><br>
</li>
<li><code>Exponential (Average) Smoothing</code></li>
</ul></li>
<li>Moving average smoothing
<ul>
<li>Compute the mean of successive smaller periods of past data (moving window).</li>
</ul></li>
</ul>
<p><span class="math display">\[M_t = (x_t + x_{t-1} + ... + x_{t-N+1}) / N\]</span> where - <span class="math inline">\(x_t\)</span>- the observation at time <span class="math inline">\(t\)</span> &amp; <span class="math inline">\(N\)</span> - the moving average length/span</p>
<ul>
<li>Longer the span <span class="math inline">\(N\)</span>, greater the smoothing</li>
</ul>
</section>
<section id="ma-smoothing-for-20-bills-data" class="slide level2">
<h2>MA smoothing for $20 bills data</h2>

<img data-src="Chapter07_files/figure-revealjs/unnamed-chunk-24-1.png" width="960" class="r-stretch quarto-figure-center"></section>
<section id="ma-centering" class="slide level2">
<h2>MA Centering</h2>
<ul>
<li><p>We need to place moving averages in the middle time period.</p>
<pre><code>- moving average must fall at t = 1.5 2.5, 3.5 etc when the MA length is an even number.  </code></pre></li>
<li><p>So, smooth again (in pairs) to place the moving averages at t = 2, 3, 4 etc.</p></li>
</ul>

<img data-src="Chapter07_files/figure-revealjs/unnamed-chunk-25-1.png" width="960" class="r-stretch quarto-figure-center"></section>
<section id="exponential-average-smoothing" class="slide level2">
<h2>Exponential (Average) Smoothing</h2>
<ul>
<li><p>In exponential average smoothing, past observations are given exponentially decreasing weights.</p></li>
<li><p>The average computed using exponentially decreasing weights is known as the Exponentially Weighted Moving average (EWMA).</p></li>
</ul>
<p>EWMA definition: <span class="math display">\[S_t = \alpha x_t + (1-\alpha) S_{t-1}\]</span> where <span class="math inline">\(S_t\)</span> = EWMA at time <span class="math inline">\(t\)</span>, <span class="math inline">\(x_t\)</span> = value of time series at time <span class="math inline">\(t\)</span> &amp; <span class="math inline">\(\alpha\)</span> = weighting factor <span class="math inline">\((0 &lt; \alpha &lt; 1)\)</span></p>
<h3 id="ewma-for-20-bills-data">EWMA for $20 bills data</h3>

<img data-src="Chapter07_files/figure-revealjs/unnamed-chunk-26-1.png" width="960" class="r-stretch quarto-figure-center"></section>
<section id="double-triple-exponential-smoothing" class="slide level2">
<h2>Double &amp; triple exponential smoothing</h2>
<p><br></p>
<h3 id="double-smoothing-includes-trend">Double Smoothing (includes trend)</h3>
<p><span class="math inline">\(S_t = \alpha X_t+(1-\alpha)[S_{t-1} + T_{t-1}]\)</span> (level equation)</p>
<p><span class="math inline">\(T_t = \gamma [S_t - S_{t-1}] + (1 - \gamma)T_{t-1}\)</span> (trend equation)</p>
<p><span class="math inline">\(\hat{Y}= S_{t-1}+T_{t-1}\)</span></p>
<p><br></p>
<h3 id="triple-smoothing-includes-trend-seasonal">Triple Smoothing (includes trend, seasonal)</h3>
<p>Also called <code>Holt and Winter</code> method</p>
<p><span class="math inline">\(S_t = \alpha(X_t-P_{t-p}) + (1-\alpha)[S_{t-1}+T_{t-1}]\)</span> (level equation)</p>
<p><span class="math inline">\(T_t = \gamma[S_t-S_{t-1}]+ (1-\gamma)T_{t-1}\)</span> (trend equation)</p>
<p><span class="math inline">\(P_t = \delta (X_t-S_t)+(1-\delta)P_{t-p}\)</span> (seasonal equation at period <span class="math inline">\(p\)</span>)</p>
<p><span class="math inline">\(\hat{Y}= S_{t-1}+T_{t-1}+P_{t-p}\)</span></p>
</section>
<section id="double-triple-exponential-smoothing-1" class="slide level2">
<h2>Double &amp; triple exponential smoothing</h2>

<img data-src="Chapter07_files/figure-revealjs/unnamed-chunk-27-1.png" width="960" class="r-stretch quarto-figure-center"></section>
<section id="forecasting" class="slide level2">
<h2>Forecasting</h2>
<ul>
<li>Projecting the present time series for future time points (Prediction)</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Chapter07_files/figure-revealjs/unnamed-chunk-28-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Chapter07_files/figure-revealjs/unnamed-chunk-29-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><p>Assessment of fit | Forecast accuracy using</p>
<ul>
<li>Mean Squared Deviation (MSD)</li>
<li>Mean Absolute Deviation (MAD)</li>
<li>Mean Absolute Percentage Error (MAPE)</li>
</ul></li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>RMSE  MAE MAPE 
81.1 59.2 14.2 </code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>RMSE  MAE MAPE 
64.9 48.7 10.1 </code></pre>
</div>
</div>
</section>
<section id="time-series-modelling" class="slide level2">
<h2>Time series modelling</h2>
<ul>
<li><p>We can fit linear models to time series data including trend and seasonality components.</p></li>
<li><p>Indicator variables to capture seasonality</p></li>
</ul>
<p>Examples:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Chapter07_files/figure-revealjs/unnamed-chunk-32-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Chapter07_files/figure-revealjs/unnamed-chunk-33-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="box-jenkins-modelling" class="slide level2">
<h2>Box-Jenkins modelling</h2>
<ul>
<li><p>A Box-Jenkins model is an improvement over the regression approach - combines regression and moving average approaches - suitable when data collected at equally spread time intervals</p></li>
<li><p>Box-Jenkins approach consists of the following three stages:</p>
<ul>
<li>Identification</li>
<li>Estimation</li>
<li>Diagnostics</li>
</ul></li>
<li><p>Past data or lagged data (or simply <code>lags</code>) play an important role</p></li>
</ul>
</section>
<section id="identification-stage-of-modelling" class="slide level2">
<h2>Identification stage of modelling</h2>
<ul>
<li><p>A time series is <code>stationary</code> if the mean and variance do not change over time.</p>
<ul>
<li>Alternatively the same probability law applies over time</li>
<li>For a <em>white noise</em> series has a constant mean and variance for all time <span class="math inline">\(t\)</span>.</li>
</ul></li>
<li><p>Stationarity is investigated using the sample autocorrelation function (ACF) (covered in Chapter 2)</p></li>
<li><p>Using ACFs, a tentative assessment of the terms or order of the model is made.</p></li>
</ul>

<img data-src="Chapter07_files/figure-revealjs/unnamed-chunk-34-1.png" width="960" class="r-stretch quarto-figure-center"></section>
<section id="common-patterns" class="slide level2">
<h2>Common patterns</h2>
<ul>
<li>Drifting random walk series (non-stationary)</li>
</ul>
<p><span class="math display">\[X_t = \delta + X_{t-1} + W_t \]</span></p>

<img data-src="Chapter07_files/figure-revealjs/unnamed-chunk-35-1.png" width="960" class="r-stretch quarto-figure-center"><ul>
<li><p>Model the difference <span class="math inline">\(X_{t} - X_{t-1}\)</span> or just use the first lag <span class="math inline">\(X_{t-1}\)</span> as a predictor in the usual regression</p></li>
<li><p>The process of differencing can be done on the differences too. This process brings stationarity to a series</p></li>
</ul>
</section>
<section id="auto-regressive-ar-model" class="slide level2">
<h2>Auto-regressive (AR) model</h2>
<p><span class="math display">\[X_t=\alpha_1 X_{t-1}+ \alpha_2 X_{t-2}+ \dots + \alpha_p X_{t-p} + \epsilon_t\]</span></p>
<ul>
<li><p>Also called the <span class="math inline">\(AR(p)\)</span> process.</p></li>
<li><p>An AR model is approximately the same as the multiple regression fit.</p>
<ul>
<li>If sample mean replaces the true mean <span class="math inline">\(\mu\)</span> of the process, the AR model becomes the multiple regression model with lags as predictors.</li>
</ul></li>
<li><p><strong>moving average process</strong> for <code>errors</code></p></li>
</ul>
<p><span class="math display">\[X_t=\beta_0 z_{t}+ \beta_1 z_{t-1}+ \dots + \beta_q z_{t-q}\]</span></p>
<ul>
<li><span class="math inline">\(X_t\)</span> is modelled with errors <span class="math inline">\(z_1\)</span>, <span class="math inline">\(z_2\)</span>,…, whose means are assumed to be zero and constant variance.</li>
</ul>
</section>
<section id="autoregressive-moving-average-arma-model" class="slide level2">
<h2>Autoregressive moving average (ARMA) model</h2>
<ul>
<li><span class="math inline">\(ARMA(p, q)\)</span> model combines both the <span class="math inline">\(AR(p)\)</span> and <span class="math inline">\(MA(q)\)</span> models.</li>
</ul>
<p><span class="math display">\[X_t=\alpha_1 X_{t-1}+ \alpha_2 X_{t-2}+ \dots + \alpha_p X_{t-p} + \beta_o z_{t}+ \beta_1 z_{t-1}+ \dots + \beta_q z_{t-q}\]</span></p>
<ul>
<li><p>Estimation of parameters</p>
<ul>
<li>done using advanced (non-linear) iterative methods</li>
</ul></li>
<li><p>Usual Diagnostics guidelines apply</p>
<ul>
<li>examine residuals for randomness</li>
<li>may indicate transformation</li>
</ul></li>
<li><p>For nonstationary series, we perform differencing and then do the modelling</p></li>
<li><p>ARIMA (p,d,q) (P,D,Q) Models</p>
<ul>
<li>includes ARMA (Stationary) Models
<ul>
<li><span class="math inline">\(p\)</span>, number of lag terms</li>
<li><span class="math inline">\(q\)</span>, number of successive error terms (moving average part)</li>
<li><span class="math inline">\(d\)</span>, number of differences in model (to deal with non-stationarity)</li>
<li><span class="math inline">\(P\)</span>,<span class="math inline">\(D\)</span>,<span class="math inline">\(Q\)</span> - corresponding parameters for the seasonal part</li>
</ul></li>
</ul></li>
</ul>
<p>(will not be examined)</p>
</section>
<section id="automated-arima-modelling" class="slide level2">
<h2>Automated ARIMA modelling</h2>
<div class="left-narrow">
<ul>
<li><code>forecast</code> R package has functions such as <code>auto.arima</code> for speedy ARIMA modelling
<ul>
<li>milk data example</li>
</ul></li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>Series: Y 
ARIMA(1,1,4) 

Coefficients:
         ar1    ma1    ma2     ma3     ma4
      -0.305  0.246  0.150  -0.426  -0.649
s.e.   0.116  0.082  0.055   0.049   0.061

sigma^2 = 1380:  log likelihood = -840
AIC=1692   AICc=1692   BIC=1710</code></pre>
</div>
</div>
<ul>
<li>Residual diagnostics</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>
    Ljung-Box test

data:  Residuals from ARIMA(1,1,4)
Q* = 47, df = 5, p-value = 5e-09

Model df: 5.   Total lags used: 10</code></pre>
</div>
</div>
</div>
<div class="right-wide">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Chapter07_files/figure-revealjs/unnamed-chunk-38-1.png" width="576"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Residuals are unsatisfactory - the 12-month lag shows that seasonality is not captured.</li>
</ul>
</div>
</section>
<section id="improved-model" class="slide level2">
<h2>Improved model</h2>
<div class="left-narrow">
<ul>
<li>auto-ARIMA with 12-month seasonality</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>Series: Y 
ARIMA(0,1,1)(0,1,1)[12] 

Coefficients:
         ma1    sma1
      -0.220  -0.621
s.e.   0.075   0.063

sigma^2 = 53.4:  log likelihood = -530
AIC=1066   AICc=1066   BIC=1075</code></pre>
</div>
</div>
<ul>
<li>Residual diagnosis</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>
    Ljung-Box test

data:  Residuals from ARIMA(0,1,1)(0,1,1)[12]
Q* = 17, df = 22, p-value = 0.7

Model df: 2.   Total lags used: 24</code></pre>
</div>
</div>
</div>
<div class="right-wide">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Chapter07_files/figure-revealjs/unnamed-chunk-41-1.png" width="576"></p>
</figure>
</div>
</div>
</div>
<p>Residuals are better now!</p>
</div>
</section>
<section id="improved-model-1" class="slide level2">
<h2>Improved model</h2>

<img data-src="Chapter07_files/figure-revealjs/unnamed-chunk-42-1.png" width="960" class="r-stretch quarto-figure-center"></section>
<section id="summary" class="slide level2">
<h2>Summary</h2>
<ul>
<li>Regression methods aim to fit a model by least squares to explain the variation in the dependent variable <span class="math inline">\(Y\)</span> by fitting explanatory <span class="math inline">\(X\)</span> variables.</li>
<li>Matrix plots and correlation coefficients provide important clues to the interrelationships.</li>
<li>For building a model, the additional variation explained is important. Summary criterion such as <span class="math inline">\(AIC\)</span> is also useful.</li>
<li>ANCOVA employs both numerical variables (covariates) and qualitative factors for modelling.</li>
<li>A time series data involve trend and seasonal variations.</li>
<li>Simple smoothing methods are intended to dampen the effect of random errors
<ul>
<li>Double and triple exponential smoothing deal trends and seasonality</li>
</ul></li>
<li>Simple AR models can be built as multiple regression models employing lags as predictors.
<ul>
<li>Building ARIMA models are more involved and will not be examined in depth.</li>
</ul></li>
<li>A model is not judged as the <strong>best</strong> purely on statistical grounds.</li>
</ul>
</section>
<section id="shiny-apps" class="slide level2">
<h2>Shiny apps</h2>
<p><a href="http://shiny.massey.ac.nz/anhsmith/demos/explore.multiple.regression/" class="uri">http://shiny.massey.ac.nz/anhsmith/demos/explore.multiple.regression/</a></p>
<p><a href="http://shiny.massey.ac.nz/anhsmith/demos/fit.multiple.regression/" class="uri">http://shiny.massey.ac.nz/anhsmith/demos/fit.multiple.regression/</a></p>
<p><a href="http://shiny.massey.ac.nz/anhsmith/demos/explore.collinearity/" class="uri">http://shiny.massey.ac.nz/anhsmith/demos/explore.collinearity/</a></p>
<p><a href="http://shiny.massey.ac.nz/anhsmith/demos/explore.Cooks.distances.and.leverages/" class="uri">http://shiny.massey.ac.nz/anhsmith/demos/explore.Cooks.distances.and.leverages/</a></p>
<p><a href="http://shiny.massey.ac.nz/anhsmith/demos/demo.RSq.and.adjusted.RSq/" class="uri">http://shiny.massey.ac.nz/anhsmith/demos/demo.RSq.and.adjusted.RSq/</a></p>
<!-- download.file("http://www.massey.ac.nz/~kgovinda/220exer/Chap5moreexamples.R", destfile="Chap5moreexamples.R") -->
<!-- download.file("https://www.massey.ac.nz/~kgovinda/220exer/chapter-5-exercises.html", destfile="chapter-5-exercises.html") -->
<!-- install.packages("remotes") -->
<!-- remotes::install_github("ricompute/ricomisc") -->
<!-- ricomisc::rstudio_viewer("chapter-4-exercises.html", file_path = NULL) -->


<img src="img/L_Color.png" class="slide-logo r-stretch"><div class="footer footer-default">
<p><a href="https://anhsmith.quarto.pub/161250-data-analysis/slides.html">161250 Data Analysis</a></p>
</div>
</section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'smaller': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'fade',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>