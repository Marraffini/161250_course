<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>161250 Data Analysis - Getting Started With R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../workshops/ws02.html" rel="next">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

<script src="../site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">161250 Data Analysis</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../slides.html" rel="" target="">
 <span class="menu-text">Slides</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../studyguide/index.html" rel="" target="">
 <span class="menu-text">Study Guide</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="../workshops/ws01.html" rel="" target="" aria-current="page">
 <span class="menu-text">Workshops</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-extra-code" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Extra Code</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-extra-code">    
        <li>
    <a class="dropdown-item" href="../exercises/Chap2more.R" rel="" target="">
 <span class="dropdown-text">Ex2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../exercises/Chap3more.R" rel="" target="">
 <span class="dropdown-text">Ex3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../exercises/Chap4more.R" rel="" target="">
 <span class="dropdown-text">Ex4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../exercises/Chap5more.R" rel="" target="">
 <span class="dropdown-text">Ex5</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../exercises/Chap6more.R" rel="" target="">
 <span class="dropdown-text">Ex6</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../exercises/Chap7more.R" rel="" target="">
 <span class="dropdown-text">Ex7</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../exercises/Chap8more.R" rel="" target="">
 <span class="dropdown-text">Ex8</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <div class="quarto-navbar-tools ms-auto">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../workshops/ws01.html">Getting Started With R</a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../workshops/ws01.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Getting Started With R</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../workshops/ws02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Chapter 2 Workshop</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../workshops/ws03.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Chapter 3 Workshop</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../workshops/ws04.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Chapter 4 Workshop</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../workshops/ws05.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Chapter 5 Workshop</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../workshops/ws06.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Chapter 6 Workshop</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../workshops/ws07.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Chapter 7 Workshop</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../workshops/ws08.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Chapter 8 Workshop</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#installing-r-and-rstudio" id="toc-installing-r-and-rstudio" class="nav-link active" data-scroll-target="#installing-r-and-rstudio">Installing <code>R</code> and RStudio</a></li>
  <li><a href="#some-r-basics" id="toc-some-r-basics" class="nav-link" data-scroll-target="#some-r-basics">Some <code>R</code> basics</a></li>
  <li><a href="#quarto" id="toc-quarto" class="nav-link" data-scroll-target="#quarto">Quarto</a></li>
  <li><a href="#r-projects-and-github" id="toc-r-projects-and-github" class="nav-link" data-scroll-target="#r-projects-and-github">R Projects and GitHub</a></li>
  <li><a href="#loadingimporting-data" id="toc-loadingimporting-data" class="nav-link" data-scroll-target="#loadingimporting-data">Loading/Importing Data</a></li>
  <li><a href="#graphing-with-ggplot2" id="toc-graphing-with-ggplot2" class="nav-link" data-scroll-target="#graphing-with-ggplot2">Graphing with <code>ggplot2</code></a>
  <ul class="collapse">
  <li><a href="#grammar-of-graphics" id="toc-grammar-of-graphics" class="nav-link" data-scroll-target="#grammar-of-graphics">Grammar of Graphics</a></li>
  <li><a href="#aesthetic-mapping-aes" id="toc-aesthetic-mapping-aes" class="nav-link" data-scroll-target="#aesthetic-mapping-aes">Aesthetic Mapping (<code>aes</code>)</a></li>
  <li><a href="#geometric-objects-geom" id="toc-geometric-objects-geom" class="nav-link" data-scroll-target="#geometric-objects-geom">Geometric Objects (<code>geom</code>)</a></li>
  <li><a href="#ggplot-builder" id="toc-ggplot-builder" class="nav-link" data-scroll-target="#ggplot-builder"><code>ggplot</code> builder</a></li>
  </ul></li>
  <li><a href="#tidyverse-and-related-packages" id="toc-tidyverse-and-related-packages" class="nav-link" data-scroll-target="#tidyverse-and-related-packages"><code>tidyverse</code> and related packages</a>
  <ul class="collapse">
  <li><a href="#dplyr" id="toc-dplyr" class="nav-link" data-scroll-target="#dplyr"><code>dplyr</code></a></li>
  <li><a href="#piping" id="toc-piping" class="nav-link" data-scroll-target="#piping">Piping</a></li>
  <li><a href="#tidyr" id="toc-tidyr" class="nav-link" data-scroll-target="#tidyr"><code>tidyr</code></a></li>
  </ul></li>
  <li><a href="#a-typical-data-analysis-session-in-rrstudio" id="toc-a-typical-data-analysis-session-in-rrstudio" class="nav-link" data-scroll-target="#a-typical-data-analysis-session-in-rrstudio">A typical data analysis session in R/RStudio</a>
  <ul class="collapse">
  <li><a href="#data-quality-checks" id="toc-data-quality-checks" class="nav-link" data-scroll-target="#data-quality-checks">Data Quality Checks</a></li>
  </ul></li>
  <li><a href="#further-help" id="toc-further-help" class="nav-link" data-scroll-target="#further-help">Further Help</a></li>
  <li><a href="#r-default-base-graphing" id="toc-r-default-base-graphing" class="nav-link" data-scroll-target="#r-default-base-graphing">R default (base) Graphing</a></li>
  <li><a href="#r-objects-model-syntax-etc." id="toc-r-objects-model-syntax-etc." class="nav-link" data-scroll-target="#r-objects-model-syntax-etc.">R Objects, Model Syntax etc.</a></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="ws01.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Getting Started With R</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="installing-r-and-rstudio" class="level1">
<h1>Installing <code>R</code> and RStudio</h1>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>You are NOT expected to become an expert in R programming or required to be one for doing this course.</p>
<p>Feel free to post your queries regarding R and RStudio on the class discussion forum on Stream.</p>
</div>
</div>
<p>R <a href="https://www.r-project.org/" class="uri">https://www.r-project.org/</a> is an open-source (i.e., free) software package. This software is available for essentially all computing platforms (e.g.&nbsp;Windows, Linux, Unix, Mac) is maintained and developed by an energetic community of users including many of the world’s foremost statisticians.</p>
<p>R is also a programming language but you may not be required to do a lot of programming for your course work. R includes functions which enables us to perform a full range of statistical analyses.</p>
<p><strong>For installing R software, please visit <a href="https://cran.stat.auckland.ac.nz/" class="uri">https://cran.stat.auckland.ac.nz/</a> and follow the instructions.</strong></p>
<p>Note that the R software will be sitting in the background in RStudio and you will not be using it directly for this course.</p>
<p>RStudio <a href="https://www.rstudio.com/products/rstudio/" class="uri">https://www.rstudio.com/products/rstudio/</a> is an integrated development environment (IDE) for R. It includes a console, syntax-highlighting editor (as well as to quickly jump to R function definitions) that supports direct R code execution. It also contains tools for plotting, history, debugging, workspace and project management. RStudio has many other features such as authoring HTML, PDF, Word Documents, and slide shows. In order to download RStudio (Desktop edition, open source), go to</p>
<p><a href="https://www.rstudio.com/products/rstudio/download/" class="uri">https://www.rstudio.com/products/rstudio/download/</a></p>
<p>Download the installation file and run it. <strong>Note that RStudio must be installed after installing R.</strong></p>
<p>R/RStudio can also be used using the cloud platform at <a href="https://rstudio.cloud/" class="uri">https://rstudio.cloud/</a> after creating a <em>free</em> account but occasionally some of the packages covered in this course may fail to work in the cloud platform.</p>
<p>If you open RStudio, you will see something similar to the screen shot shown in <a href="#fig-rstud">Figure&nbsp;1</a>:</p>
<div id="fig-rstud" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="img/Rstudio.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;1: An RStudio window</figcaption>
</figure>
</div>
<p>RStudio has many options, such as uploading files to a server, creating documents etc. You will be using only a few of the options. You will <em>not</em> be using the menus such as <em>Build</em>, <em>Debug</em>, <em>Profile</em> at all in this course.</p>
<p>You can either type or copy and paste the R codes appearing in this section on to the R Script window and run them.</p>
</section>
<section id="some-r-basics" class="level1 unnumbered">
<h1 class="unnumbered">Some <code>R</code> basics</h1>
<ul>
<li><p><code>R</code> is case sensitive, so <code>data</code> is not the same as <code>DATA</code></p></li>
<li><p><code>&lt;-</code> (read as “gets”) is the assignment operator. That is, you use <code>&lt;-</code> to assign some content to a variable. The operator <code>=</code> has a slightly different meaning but it can be used in the same way as <code>&lt;-</code>. In R Studio, press <code>ALT</code> and minus key when you are in the R script mode (File &gt;&gt; New File &gt;&gt; R Script).</p></li>
<li><p>Comments are denoted by the # symbol. Anything after a <code>#</code> symbol is ignored by <code>R</code> .</p></li>
<li><p>R coding can be hard to write from scratch. <span style="color: red;">So do not hesitate to adopt R codes written by others.</span> Search the internet for R code to do what you want to do. The usual <code>copy and paste</code> trick works!</p></li>
</ul>
<p><em>Working directory</em></p>
<p>In RStudio, set the working directory under the <em>Session</em> menu. It is a good idea to start your analysis as a new project in the File menu so that the entire work and data files can be saved and re-opened easily later on.</p>
<p><em>R/RStudio as a calculator</em></p>
<p><em>In RStudio, use the File &gt;&gt; New File &gt;&gt; R Script menu to type or copy and paste the commands and execute them</em></p>
<p>Type <code>1+1</code> to see <code>2</code> on the console (or <code>-&gt;Run</code> the code in RStudio).</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">+</span><span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2</code></pre>
</div>
</div>
<p>Type <code>a=1;b=2;a/b</code> to see <code>0.5</code>.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>a<span class="ot">=</span><span class="dv">1</span>;b<span class="ot">=</span><span class="dv">2</span>;a<span class="sc">/</span>b</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5</code></pre>
</div>
</div>
<p>Note that semicolon separates various commands. It is optional to use them as long as you type the commands one by one as follows:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>a<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>b<span class="ot">=</span><span class="dv">2</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>a<span class="sc">/</span>b</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5</code></pre>
</div>
</div>
<p>There are many built-in functions. Try the following.</p>
<p><code>27^3</code> <code>sqrt(10)</code> <code>round(sqrt(10),2)</code> <code>abs(-4)</code> <code>log(10)</code> <code>exp(10)</code> <code>rnorm(100)</code> <code>mean(rnorm(100))</code> <code>sd(rnorm(100))</code></p>
<p>You may wonder what was the base used for <code>log(10)</code>. A help on this can be obtained by placing a question mark (<code>?</code>) before log as <code>?log</code> or by</p>
<p><strong>help(log)</strong></p>
<p>There are a few exceptions. The command <code>?if</code> wont work but <code>?"if"</code> will. In other words, <code>?"log"</code> or <code>help("log")</code> are safer ways of getting help on “built-in” functions.</p>
<p><span style="color: red;">In RStudio, use the R Editor (menu <em>File &gt; New Script</em>) to type the commands and submit them (shortcut: <em>CNTRL+R</em>). </span></p>
<p><em>Default examples</em></p>
<p>The command <code>example()</code> will produce the available HELP examples, and will work for most functions. For example, try <code>example(boxplot)</code>. You will see many boxplot examples such as the following:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(count <span class="sc">~</span> spray, <span class="at">data =</span> InsectSprays, <span class="at">col =</span> <span class="st">"lightgray"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ws01_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>There are also demos available, explore using the command <code>demo()</code>. The basic R system produces somewhat old style graphs.</p>
<p><span style="color: red;">So we will be largely using the newer plotting system <strong>ggplot</strong> which is part of the <code>tidyverse</code> suite of packages; see <a href="https://www.tidyverse.org/" class="uri">https://www.tidyverse.org/</a>.</span></p>
<p>Let’s load that package now:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>A huge number of other dedicated packages are available to improve the power of R. Many R packages are hosted at a repository called CRAN (<em>C</em>omprehensive <em>R</em> <em>A</em>rchive <em>N</em>etwork). The package install option within RStudio can download and install these optional packages under the menu <code>Packages &gt;&gt; Install</code>. You can also do this using the command <code>install.packages</code>. For example</p>
<p><code>install.packages(c("tidyverse", "car"), dependencies = TRUE)</code></p>
<p>This command installs two packages <code>tidyverse</code> and <code>car</code> in one go.</p>
<p>Contributed R packages are grouped in various headings at <a href="https://cran.r-project.org/web/views/" class="uri">https://cran.r-project.org/web/views/</a>. They can be installed in bulk using the <code>ctv</code> package command <code>install.views()</code>.</p>
<p>You might have to install quite a few packages as you work through this course.</p>
</section>
<section id="quarto" class="level1 unnumbered">
<h1 class="unnumbered">Quarto</h1>
<p>I encourage you to get into the habit of using <a href="https://quarto.org/">Quarto</a> <code>*.qmd</code> files rather than raw <code>*.R</code> files. If you’ve heard of Rmarkdown, Quarto is the successor to Rmarkdown. So, if you’re just starting to use R, then you should begin with Quarto rather than Rmarkdown, because most/all new development will be going into Quarto.</p>
<p>Quarto files contain text and code, and can be ‘knitted’ to produce a nicely formatted document, usually in HTML or PDF format, containing sections, text, code, plots, and output. Quarto can also be used to make websites; in fact, the website for this course was made using Quarto.</p>
<p>Here’s some information to get you started: <a href="https://quarto.org/docs/get-started/hello/rstudio.html" class="uri">https://quarto.org/docs/get-started/hello/rstudio.html</a>.</p>
<p>And some other useful tips: <a href="https://r4ds.hadley.nz/quarto" class="uri">https://r4ds.hadley.nz/quarto</a>.</p>
</section>
<section id="r-projects-and-github" class="level1 unnumbered">
<h1 class="unnumbered">R Projects and GitHub</h1>
<p>Instead of putting your R code into an ordinary directory on your computer, I encourage you to use Rstudio Projects. A Project is a self-contained directory of code and data, pertaining to a particular project. You might create a single project for your work during this course, with a folder for workshops and another folder for assignments.</p>
<p>Here’s a primer on R projects: <a href="https://r4ds.hadley.nz/workflow-scripts#projects" class="uri">https://r4ds.hadley.nz/workflow-scripts#projects</a></p>
<p>An advantage of Projects is that they work nicely with <a href="https://github.com/">GitHub</a>, a cloud code-repository service. If you plan to do any programming during your career, you’ll probably need to learn how to use GitHub. It can be a little tricky to use at first. You don’t have to use it for this course, but feel free to have a go at it if you’re interested.</p>
<p>If you’re using R projects and GitHub, this online book is a great place to start: <a href="https://happygitwithr.com/">Happy Git and GitHub for the useR</a>.</p>
</section>
<section id="loadingimporting-data" class="level1 unnumbered">
<h1 class="unnumbered">Loading/Importing Data</h1>
<p>Most data sets we shall consider in this course are in a tabular form. This means that each variable is a column, each row is an observation, columns are separated by white space (or comma), and each column or row may have a name.</p>
<p>If the data file is stored locally, you should put the data into the same directory as your Quarto or R markdown script. That way, you can (usually) load it easily without having to type the full pathway (e.g., <code>mydata.csv</code> rather than <code>C:/Users/anhsmith/Work/Project1/data/mydata.csv</code>). Better yet, <a href="https://r4ds.hadley.nz/workflow-scripts#projects">Projects</a> make this much easier.</p>
<p>You can also load data from the web using a URL. For example,</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">read_csv</span>(<span class="st">"https://www.massey.ac.nz/~anhsmith/data/rangitikei.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 33 Columns: 10
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
dbl (10): id, loc, time, w.e, cl, wind, temp, river, people, vehicle

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 33 × 10
      id   loc  time   w.e    cl  wind  temp river people vehicle
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;
 1     1     1     2     1     1     2     2     1     37      15
 2     2     1     1     1     1     2     1     2     23       6
 3     3     1     2     1     1     2     2     3     87      31
 4     4     2     2     1     1     2     1     1     86      27
 5     5     2     1     1     1     2     2     2     19       2
 6     6     2     2     1     2     1     3     3    136      23
 7     7     1     2     2     2     2     2     3     14       8
 8     8     1     2     1     2     2     2     3     67      26
 9     9     1     1     2     1     3     1     2      4       3
10    10     2     2     1     2     2     2     3    127      45
# ℹ 23 more rows</code></pre>
</div>
</div>
<p>We’d usually want to store the data as an object though, like so:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>rangitikei <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"https://www.massey.ac.nz/~anhsmith/data/rangitikei.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 33 Columns: 10
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
dbl (10): id, loc, time, w.e, cl, wind, temp, river, people, vehicle

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
</div>
<p>Now the data are available in R as an object.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(rangitikei)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 33
Columns: 10
$ id      &lt;dbl&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18,…
$ loc     &lt;dbl&gt; 1, 1, 1, 2, 2, 2, 1, 1, 1, 2, 2, 2, 2, 1, 1, 1, 2, 2, 2, 1, 1,…
$ time    &lt;dbl&gt; 2, 1, 2, 2, 1, 2, 2, 2, 1, 2, 2, 2, 2, 2, 2, 2, 2, 1, 2, 1, 2,…
$ w.e     &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 2, 1, 2, 1, 2, 1, 1, 1, 1, 2, 2, 1, 1, 1, 2,…
$ cl      &lt;dbl&gt; 1, 1, 1, 1, 1, 2, 2, 2, 1, 2, 1, 2, 1, 1, 1, 2, 2, 2, 1, 2, 2,…
$ wind    &lt;dbl&gt; 2, 2, 2, 2, 2, 1, 2, 2, 3, 2, 2, 2, 1, 2, 2, 2, 2, 2, 2, 3, 2,…
$ temp    &lt;dbl&gt; 2, 1, 2, 1, 2, 3, 2, 2, 1, 2, 2, 3, 1, 2, 2, 2, 3, 2, 2, 2, 2,…
$ river   &lt;dbl&gt; 1, 2, 3, 1, 2, 3, 3, 3, 2, 3, 1, 3, 1, 3, 1, 1, 2, 1, 2, 2, 3,…
$ people  &lt;dbl&gt; 37, 23, 87, 86, 19, 136, 14, 67, 4, 127, 43, 190, 50, 47, 32, …
$ vehicle &lt;dbl&gt; 15, 6, 31, 27, 2, 23, 8, 26, 3, 45, 7, 53, 22, 18, 10, 3, 11, …</code></pre>
</div>
</div>
<p>If the data are stored as a <code>*.csv</code> or “comma separated values” file, then you can use the <code>read.csv()</code> or <code>read_csv()</code> function to load the file. If it’s a text file with columns separated by spaces or tabs, you can use <code>read.table()</code> or <code>read_table()</code> function. The ones with underscores ( <code>read_csv()</code> and <code>read_table()</code>) are in the <code>readr</code> package, so you’ll need to load it first (though <code>readr</code> is part of <code>tidyverse</code>, so if you load <code>tidyverse</code> you’re all set).</p>
<p>You can also load Microsoft Excel files using functions <code>read_excel()</code>, available in the <code>readxl</code> package.</p>
<p>As an exercise, try importing the Telomeres data file (in Excel format) available at</p>
<p><a href="https://rs.figshare.com/ndownloader/files/22850096" class="uri">https://rs.figshare.com/ndownloader/files/22850096</a></p>
<p>Note that Excel files usually contain blanks for missing or unreported data or allocate many rows for variable description, which can cause issues while importing them.</p>
<p>Native R data, stored as <code>*.RData</code> or <code>*.rds</code> files, can be loaded using the <code>load()</code> or <code>readRDS()</code> functions, respectively.</p>
<p>SQLite is a public-domain, light-weight database engine (https://sqlite.org/about.html). The R package <code>RSQLite</code> will import *.sqlite files. Databases are usually large in size, and hence R packages such as <code>dbplyr</code> can be used package to query a database.</p>
</section>
<section id="graphing-with-ggplot2" class="level1 unnumbered">
<h1 class="unnumbered">Graphing with <code>ggplot2</code></h1>
<p>The R library <code>ggplot2</code> is very powerful for plotting but <span style="color: red;">you may find the syntax little strange.</span> There are plenty of examples at the <a href="https://ggplot2.tidyverse.org/reference/"><code>ggplot2</code> online help website</a>. The <code>ggplot2</code> package is loaded as part of the <code>tidyverse</code> set of packages.</p>
<p>Advantages of <code>ggplot2</code> are the following:</p>
<ul>
<li>employs the “grammar of graphics” of <span class="citation" data-cites="Wilkinson">(<a href="#ref-Wilkinson" role="doc-biblioref">Wilkinson 2005</a>)</span></li>
<li>plotting involves a high level of abstraction</li>
<li>very flexible and complete graphics system</li>
<li>theme system for getting attractive plots</li>
<li>Fast growing and actively developed</li>
</ul>
<p>Some disadvantages of <code>ggplot2</code> are the following:</p>
<ul>
<li>3-dimensional graphics (opt for <code>rgl</code> package instead)</li>
<li>Graph-theory type graphs (nodes/edges layout; opt for <code>igraph</code> and other packages)</li>
<li>Interactive graphics (opt for <code>plotly</code>, <code>ggvis</code> and other packages)</li>
</ul>
<section id="grammar-of-graphics" class="level2">
<h2 class="anchored" data-anchor-id="grammar-of-graphics">Grammar of Graphics</h2>
<p>The main idea behind the grammar of graphics of <span class="citation" data-cites="Wilkinson">(<a href="#ref-Wilkinson" role="doc-biblioref">Wilkinson 2005</a>)</span> is to mimic the manual graphing approach and define building blocks and combine them to create a graphical display. The building blocks of a graph are:</p>
<ul>
<li>data</li>
<li>aesthetic mapping</li>
<li>geometric object</li>
<li>transformation or re-expression of data</li>
<li>scales</li>
<li>coordinate system</li>
<li>position adjustments</li>
<li>faceting</li>
</ul>
<p>If have not installed <code>ggplot2</code> or <code>tidyverse</code>, install it with the following commands.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"ggplot2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We can now load the <code>ggplot2</code> library with the commands:</p>
<div class="cell" data-warninng="false">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>In order to work with <code>ggplot2</code>, we must have a <code>data frame</code> or a <code>tibble</code> containing our data. We need to specify the <code>aesthetics</code> or how the columns of our data frame can be translated into positions, colours, sizes, and shapes of graphical elements.</p>
<p>The geometric objects and aesthetics of the ggplot2 system are explained below:</p>
</section>
<section id="aesthetic-mapping-aes" class="level2">
<h2 class="anchored" data-anchor-id="aesthetic-mapping-aes">Aesthetic Mapping (<code>aes</code>)</h2>
<p>In ggplot land <em>aesthetic</em> means visualisation features or aesthetics. These are</p>
<ul>
<li>position (i.e., on the x and y axes)</li>
<li>color (“outside” color)</li>
<li>fill (“inside” color)</li>
<li>shape (of points)</li>
<li>linetype</li>
<li>size</li>
</ul>
<p>Aesthetic mappings are set with the <code>aes()</code> function.</p>
</section>
<section id="geometric-objects-geom" class="level2">
<h2 class="anchored" data-anchor-id="geometric-objects-geom">Geometric Objects (<code>geom</code>)</h2>
<p>Geometric objects or <code>geoms</code> are the actual marking or inking on a plot such as:</p>
<ul>
<li>points (<code>geom_point</code>, for scatter plots, dot plots, etc)</li>
<li>lines (<code>geom_line</code>, for time series, trend lines, etc)</li>
<li>boxplot (<code>geom_boxplot</code>, for boxplots)</li>
</ul>
<p><em>A plot must have at least one <code>geom</code> but there is no upper limit.</em> In order to add a <code>geom</code> to a plot, the <code>+</code> operator is employed. A list of available geometric objects can be obtained by typing <code>geom_&lt;tab&gt;</code> in Rstudio. The following command can also be used which will open a Help window.</p>
<pre><code>help.search("geom_", package = "ggplot2")</code></pre>
<p>Consider the study guide dataset <code>rangitikei.txt</code> (Recreational Use of the Rangitikei river). The first 10 rows of this dataset are shown below:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>   id loc time w.e cl wind temp river people vehicle
1   1   1    2   1  1    2    2     1     37      15
2   2   1    1   1  1    2    1     2     23       6
3   3   1    2   1  1    2    2     3     87      31
4   4   2    2   1  1    2    1     1     86      27
5   5   2    1   1  1    2    2     2     19       2
6   6   2    2   1  2    1    3     3    136      23
7   7   1    2   2  2    2    2     3     14       8
8   8   1    2   1  2    2    2     3     67      26
9   9   1    1   2  1    3    1     2      4       3
10 10   2    2   1  2    2    2     3    127      45</code></pre>
</div>
</div>
<p>The description of the variables is given below:</p>
<p><code>loc</code> - two locations were surveyed, coded 1, 2<br>
<code>time</code> - time of day, 1 for morning, 2 for afternoon<br>
<code>w.e</code> - coded 1 for weekend, 2 for weekday<br>
<code>cl</code>- cloud cover, 1 for &gt;50%, 2 for &lt;50%<br>
<code>wind</code>- coded 1 through 4 for increasing wind speed<br>
<code>temp</code> - temperature, 1, 2 or 3 increasing temp<br>
<code>river</code>- murkiness of river in 3 increasing categories<br>
<code>people</code> - number of people at that location and time<br>
<code>vehicle</code>- number of vehicles at that location at that time<br>
</p>
<p>This dataset is downloaded from the web using the following commands.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>my.data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"https://www.massey.ac.nz/~anhsmith/data/rangitikei.csv"</span>, </span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">header=</span><span class="cn">TRUE</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> my.data,</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> vehicle, <span class="at">y =</span> people)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>       ) <span class="sc">+</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ws01_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The <code>aes</code> part defines the “aesthetics”, which is how columns of the dataframe map to graphical attributes such as x and y position, colour, size, etc. An aesthetic can be either numeric or categorical and an appropriate scale will be used. After this, we add layers of graphics. <code>geom_point</code> layer is employed to map x and y and we need not specify all the options for <code>geom_point</code>.</p>
<p>The <code>aes()</code> can be specified within the <code>ggplot</code> function or as its own separate function. I prefer this format.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(my.data) <span class="sc">+</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> vehicle, <span class="at">y =</span> people) <span class="sc">+</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ws01_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We can add a title using <em>labs()</em> or <em>ggtitle()</em> functions. Try-</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(my.data) <span class="sc">+</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> vehicle, <span class="at">y =</span> people) <span class="sc">+</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"No. of people vs No. of vehicles"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>or</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(my.data)<span class="sc">+</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> vehicle, <span class="at">y =</span> people) <span class="sc">+</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"No. of people vs No. of vehicles"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Note that <em>labs()</em> allows captions and subtitles.</p>
<p><code>geom_smooth</code> is additionally used to show trends.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(my.data) <span class="sc">+</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> vehicle, <span class="at">y =</span> people) <span class="sc">+</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using method = 'loess' and formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="ws01_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Similar to <code>geom_smooth</code>, a variety of <code>geoms</code> are available.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(my.data) <span class="sc">+</span> </span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(wind), <span class="at">y =</span> people) <span class="sc">+</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ws01_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Each <code>geom</code> accepts a particular set of mappings;for example <code>geom_text()</code> accepts a <code>labels</code> mapping. Try-</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(my.data) <span class="sc">+</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> vehicle, <span class="at">y =</span> people) <span class="sc">+</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> w.e), </span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The faceting option allows a collection of small plots with the same scales. Try-</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(my.data) <span class="sc">+</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x=</span>vehicle, <span class="at">y=</span>people) <span class="sc">+</span> </span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> river) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ws01_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Faceting is the <code>ggplot2</code> option to create separate graphs for subsets of data. <code>ggplot2</code> offers two functions for creating small multiples:</p>
<ol type="1">
<li><code>facet_wrap()</code>: define subsets as the levels of a single grouping variable</li>
<li><code>facet_grid()</code>: define subsets as the crossing of two grouping variables</li>
</ol>
<p>The following arguments are common to most scales in <code>ggplot2</code>:</p>
<ul>
<li><strong>name:</strong> the first argument gives the axis or legend title</li>
<li><strong>limits:</strong> the minimum and maximum of the scale</li>
<li><strong>breaks:</strong> the points along the scale where labels should appear</li>
<li><strong>labels:</strong> the labels that appear at each break</li>
</ul>
<p>Specific scale functions may have additional arguments. Some of the available Scales are:</p>
<table class="table">
<thead>
<tr class="header">
<th><strong>Scale</strong></th>
<th><strong>Examples</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>scale_color_</code></td>
<td><code>scale_color_discrete</code></td>
</tr>
<tr class="even">
<td><code>scale_fill_</code></td>
<td><code>scale_fill_continuous</code></td>
</tr>
<tr class="odd">
<td><code>scale_size_</code></td>
<td><code>scale_size_manual</code></td>
</tr>
<tr class="even">
<td></td>
<td><code>scale_size_discrete</code></td>
</tr>
<tr class="odd">
<td></td>
<td></td>
</tr>
<tr class="even">
<td><code>scale_shape_</code></td>
<td><code>scale_shape_discrete</code></td>
</tr>
<tr class="odd">
<td></td>
<td><code>scale_shape_manual</code></td>
</tr>
<tr class="even">
<td><code>scale_linetype_</code></td>
<td><code>scale_linetype_discrete</code></td>
</tr>
<tr class="odd">
<td></td>
<td></td>
</tr>
<tr class="even">
<td><code>scale_x_</code></td>
<td><code>scale_x_continuous</code></td>
</tr>
<tr class="odd">
<td></td>
<td><code>scale_x_log</code></td>
</tr>
<tr class="even">
<td></td>
<td><code>scale_x_date</code></td>
</tr>
<tr class="odd">
<td><code>scale_y_</code></td>
<td><code>scale_y_reverse</code></td>
</tr>
<tr class="even">
<td></td>
<td><code>scale_y_discrete</code></td>
</tr>
<tr class="odd">
<td></td>
<td><code>scale_y_datetime</code></td>
</tr>
</tbody>
</table>
<p>In RStudio, we can type <code>scale_</code> followed by TAB to get the whole list of available scales.</p>
<p>Try-</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(my.data) <span class="sc">+</span> </span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> vehicle, <span class="at">y =</span> people, <span class="at">color =</span> <span class="fu">factor</span>(temp)) <span class="sc">+</span> </span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">name =</span> <span class="st">"No. of Vehicles"</span>) <span class="sc">+</span> </span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">name =</span> <span class="st">"No. of people"</span>) <span class="sc">+</span> </span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_discrete</span>(<span class="at">name =</span> <span class="st">"Temperature"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ws01_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The other coding option is shown below:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(my.data) <span class="sc">+</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> vehicle, <span class="at">y =</span> people, <span class="at">color =</span> <span class="fu">factor</span>(temp)) <span class="sc">+</span> </span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"No. of Vehicles"</span>) <span class="sc">+</span> </span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"No. of people"</span>) <span class="sc">+</span> </span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">colour=</span><span class="st">"Temperature"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Note that a desired graph can be obtained in more than one way.</p>
<p>The <code>ggplot2</code> theme system handles plot elements (not data based) such as</p>
<ul>
<li>Axis labels</li>
<li>Plot background</li>
<li>Facet label background</li>
<li>Legend appearance</li>
</ul>
<p>Built-in themes include:</p>
<ul>
<li><code>theme_gray()</code> (default)</li>
<li><code>theme_bw()</code></li>
<li><code>theme_minimal()</code></li>
<li><code>theme_classic()</code></li>
</ul>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(my.data) <span class="sc">+</span> </span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> vehicle, <span class="at">y =</span> people, <span class="at">color =</span> <span class="fu">factor</span>(temp)) <span class="sc">+</span> </span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Note that the graph is assigned an object name <code>p1</code> and nothing will be printed unless we then print the object <code>p1</code>.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(my.data) <span class="sc">+</span> </span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> vehicle, <span class="at">y =</span> people, <span class="at">color =</span> <span class="fu">factor</span>(temp)) <span class="sc">+</span> </span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>p1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ws01_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Try-</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> <span class="fu">theme_light</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ws01_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ws01_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Specific theme elements can be overridden using <code>theme()</code>. For example:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"red"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ws01_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>All theme options can be seen with <code>?theme</code>.</p>
<p>To specify a theme for a whole document, use</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_minimal</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><em>Minimal graphing</em> can be done using the <code>qplot</code> option that will produce a few standard formatted graphs quickly.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qplot</span>(people, vehicle, <span class="at">data =</span> my.data, <span class="at">colour =</span> river)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: `qplot()` was deprecated in ggplot2 3.4.0.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="ws01_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Try-</p>
<p><code>qplot(people, data = my.data)</code></p>
<p><code>qplot(people, fill=factor(river), data=my.data)</code></p>
<p><code>qplot(people, data = my.data, geom = "dotplot")</code></p>
<p><code>qplot(factor(river), people, data = my.data, geom = "boxplot")</code></p>
<p>A cheat sheet for <code>ggplot2</code> is available at <a href="https://www.rstudio.com/resources/cheatsheets/" class="uri">https://www.rstudio.com/resources/cheatsheets/</a> (optional to download). There are many other packages which incorporate <code>ggplot2</code> based graphs or dependent on it.</p>
<p>The library <em>patchwork</em> allows complex composition arbitrary plots, which are not produced using the faceting option. Try</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">qplot</span>(people, <span class="at">data =</span> my.data, <span class="at">geom =</span> <span class="st">"dotplot"</span>)</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">qplot</span>(people, <span class="at">data =</span> my.data, <span class="at">geom =</span> <span class="st">"boxplot"</span>)</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(my.data, <span class="fu">aes</span>(<span class="at">x =</span> vehicle, <span class="at">y =</span> people)) <span class="sc">+</span> <span class="fu">geom_point</span>()</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>(p1 <span class="sc">+</span> p2) <span class="sc">/</span> p3 <span class="sc">+</span> </span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="st">"My title"</span>, <span class="at">caption =</span> <span class="st">"My caption"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Bin width defaults to 1/30 of the range of the data. Pick better value with
`binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="ws01_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="ggplot-builder" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="ggplot-builder"><code>ggplot</code> builder</h2>
<p>A nice <code>R</code> package, known as <code>esquisse</code> is available to build few simple <code>ggplot</code> graphics interactively. This may help in the early stages of learning to use <code>ggplot</code> graphing.</p>
<p>If this package is not installed, install it first &amp; then try.</p>
<pre><code>library(esquisse)
options("esquisse.display.mode" = "browser")
esquisse::esquisser(data = iris)</code></pre>
<p>You can also load the desired dataset within <code>R</code> studio and select the dataset.</p>
<p>The other option is to load a dataset from the course data web folder and then launch <code>esquisse</code>. Try-</p>
<pre><code>url1 &lt;- "https://www.massey.ac.nz/~anhsmith/data/rangitikei.RData"
download.file(url = url1, destfile = "rangitikei.RData")
load("rangitikei.RData")
esquisse::esquisser(data = rangitikei, viewer = "browser")</code></pre>
<p>You can also download the associated R codes or save the graph within the <code>esquisse</code> web app.</p>
</section>
</section>
<section id="tidyverse-and-related-packages" class="level1 unnumbered">
<h1 class="unnumbered"><code>tidyverse</code> and related packages</h1>
<p>In the recent years, <code>tidyverse</code> suite of packages, which includes <code>ggplot2</code> has become the popular tool for data handling and plotting. In this section, a brief intro to the data management packages such as <code>dplyr</code> is given.</p>
<p>For detailed coverage of the <code>tidyverse</code> system, go to <a href="https://www.tidyverse.org/" class="uri">https://www.tidyverse.org/</a>.</p>
<section id="dplyr" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="dplyr"><code>dplyr</code></h2>
<p>The following six functions of <code>dplyr</code> are very useful for data wrangling :</p>
<ul>
<li>For selecting columns, use <code>select()</code></li>
<li>For subsetting data, use <code>filter()</code></li>
<li>For re-ordering (e.g.&nbsp;ascending/descending), use <code>arrange()</code></li>
<li>For augmenting new calculated columns, use <code>mutate()</code></li>
<li>For computing summary measures, use <code>summarise()</code></li>
<li>For group-wise computations (e.g.&nbsp;summary measures), use <code>group_by()</code></li>
</ul>
<p>There are many other functions such as <code>transmute()</code> which will add newly calculated columns to the existing data frame but drop all unused columns. The <code>across()</code> function extends <code>group_by()</code> and <code>summarise()</code> functions for multiple column and function summaries. For example, you like to report rounded data in a table, which calls for an operation across both rows and columns.</p>
</section>
<section id="piping" class="level2">
<h2 class="anchored" data-anchor-id="piping">Piping</h2>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>The piping operation is a fundamental aspect of computer programming. The semantics of pipes is taking the output from the left-hand side and passing it as input to the right-hand side.</strong></p>
</div>
</div>
<p>The <code>R</code> package <code>magrittr</code> introduced the pipe operator <code>%&gt;%</code> and can be pronounced as “then”. In RStudio windows/Linux versions, press <code>Ctrl+Shift+M</code> to insert the pipe operator. On a Mac, use <code>Cmd+Shift+M</code>.</p>
<p><code>R</code> also has its own pipe, <code>|&gt;</code>, which is an alternative to <code>%&gt;%</code>. I tend to use <code>|&gt;</code>. If you want to change the pipe inserted automatically with <code>Ctrl+Shift+M</code>, find on the menu <strong>Tools &gt; Global Options</strong>, then click on <strong>Code</strong> and check the box that says “<strong>Use Native Pipe Operator</strong>”.</p>
<p>We often pipe the <code>dplyr</code> functions, and the advantage is that we show the flow of data manipulation and subsequent graphing. This approach also helps to save memory, and dataframes are not unnecessarily created, a necessity for a big data framework.</p>
<p>Try the following examples after loading the <code>rangitikei</code> dataset.</p>
<p><code>select()</code></p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>my.data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"https://www.massey.ac.nz/~anhsmith/data/rangitikei.csv"</span>, <span class="at">header=</span><span class="cn">TRUE</span>)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(my.data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "id"      "loc"     "time"    "w.e"     "cl"      "wind"    "temp"   
 [8] "river"   "people"  "vehicle"</code></pre>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>new.data <span class="ot">&lt;-</span> my.data <span class="sc">|&gt;</span> </span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(people, vehicle)</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(new.data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "people"  "vehicle"</code></pre>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>my.data <span class="sc">|&gt;</span> </span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(people, vehicle) <span class="sc">|&gt;</span> </span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x=</span>people, <span class="at">y=</span>vehicle) <span class="sc">+</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ws01_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We select two columns and create a scatter plot with the above commands.</p>
<p><code>filter()</code></p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>my.data <span class="sc">|&gt;</span> </span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(wind<span class="sc">==</span><span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(people, vehicle) <span class="sc">|&gt;</span> </span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x=</span>people, <span class="at">y=</span>vehicle) <span class="sc">+</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ws01_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The above commands filter the data for the low wind days and plots vehicle against people.</p>
<p><code>arrange()</code></p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>my.data <span class="sc">|&gt;</span> </span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(wind<span class="sc">==</span><span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(w.e) <span class="sc">|&gt;</span> </span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(w.e, people, vehicle)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  w.e people vehicle
1   1    136      23
2   1     50      22
3   1    100      31
4   1    470     122
5   2     22      11</code></pre>
</div>
</div>
<p><code>mutate()</code></p>
<p>Assume that a $10 levy is collected for each vehicle. We can create this new <code>levy</code> column as follows.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>my.data <span class="sc">|&gt;</span> </span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">levy =</span> vehicle<span class="sc">*</span><span class="dv">10</span>) <span class="sc">|&gt;</span> </span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(people, levy) <span class="sc">|&gt;</span> </span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> people, <span class="at">y=</span>levy) <span class="sc">+</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ws01_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Note that the pipe operation was used to create a scatter plot using the newly created column.</p>
<p><code>summarise()</code></p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>my.data <span class="sc">|&gt;</span> </span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total =</span> <span class="fu">n</span>(), </span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">avg =</span> <span class="fu">mean</span>(people)</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>            )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  total      avg
1    33 71.72727</code></pre>
</div>
</div>
<p>We obtain the selected summary measures namely the total and the mean number of people. Try-</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>my.data <span class="sc">|&gt;</span> </span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(wind <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total =</span> <span class="fu">n</span>(), </span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">avg =</span> <span class="fu">mean</span>(people)</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>            )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  total   avg
1     5 155.6</code></pre>
</div>
</div>
<p><code>group_by()</code></p>
<p>We obtain the wind group-wise summaries below:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>my.data <span class="sc">|&gt;</span> </span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(wind) <span class="sc">|&gt;</span> </span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total=</span><span class="fu">n</span>(), </span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">avg=</span><span class="fu">mean</span>(people))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
   wind total   avg
  &lt;int&gt; &lt;int&gt; &lt;dbl&gt;
1     1     5 156. 
2     2    26  59.7
3     3     2  19  </code></pre>
</div>
</div>
<p>There are many more commands such as the <code>transmute</code> function which conserves the only the needed columns. Try</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>my.data <span class="sc">|&gt;</span> </span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(wind, w.e) <span class="sc">|&gt;</span> </span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(<span class="at">total=</span><span class="fu">n</span>(), </span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">avg=</span><span class="fu">mean</span>(people))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 33 × 4
# Groups:   wind, w.e [6]
    wind   w.e total   avg
   &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt;
 1     2     1    18  72.1
 2     2     1    18  72.1
 3     2     1    18  72.1
 4     2     1    18  72.1
 5     2     1    18  72.1
 6     1     1     4 189  
 7     2     2     8  31.8
 8     2     1    18  72.1
 9     3     2     1   4  
10     2     1    18  72.1
# ℹ 23 more rows</code></pre>
</div>
</div>
<p>A simple frequency table is found using <code>count()</code>. Try-</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>my.data <span class="sc">|&gt;</span> </span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(wind, w.e) <span class="sc">|&gt;</span> </span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(temp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 4
# Groups:   wind, w.e [6]
    wind   w.e  temp     n
   &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;
 1     1     1     1     1
 2     1     1     3     3
 3     1     2     3     1
 4     2     1     1     4
 5     2     1     2    12
 6     2     1     3     2
 7     2     2     2     6
 8     2     2     3     2
 9     3     1     2     1
10     3     2     1     1</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>my.data <span class="sc">|&gt;</span> </span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(wind, w.e) <span class="sc">|&gt;</span> </span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(temp, river)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 16 × 5
# Groups:   wind, w.e [6]
    wind   w.e  temp river     n
   &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;
 1     1     1     1     1     1
 2     1     1     3     3     3
 3     1     2     3     3     1
 4     2     1     1     1     1
 5     2     1     1     2     1
 6     2     1     1     3     2
 7     2     1     2     1     3
 8     2     1     2     2     2
 9     2     1     2     3     7
10     2     1     3     3     2
11     2     2     2     1     2
12     2     2     2     3     4
13     2     2     3     2     1
14     2     2     3     3     1
15     3     1     2     2     1
16     3     2     1     2     1</code></pre>
</div>
</div>
<p>The <code>count()</code> is useful to check the balanced nature of the data when many subgroups are involved.</p>
</section>
<section id="tidyr" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="tidyr"><code>tidyr</code></h2>
<p>By the phrase <code>tidy data</code>, it is meant the preferred way of arranging data that is easy to analyse. The principles of tidy data are:</p>
<ul>
<li>Each variable forms a column.</li>
<li>Each observation forms a row.</li>
<li>Each type of observational unit forms a table.</li>
</ul>
<p>The hospital admissions dataset is untidy because it does allocate many columns for a variable.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>my.data <span class="ot">&lt;-</span> <span class="fu">read.table</span>(</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"https://www.massey.ac.nz/~anhsmith/data/hospital.txt"</span>,</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">header=</span><span class="cn">TRUE</span>, <span class="at">sep=</span><span class="st">","</span>)</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(my.data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  YEAR PERI NORTH1 NORTH2 NORTH3 SOUTH1 SOUTH2 SOUTH3
1 1980    1      0      4     27      4     16     27
2 1980    2      6     11     31      8     18     21
3 1980    3      6      4     25     20     16     24
4 1980    4      1     10     31     22     17     20
5 1980    5      4     16     22     21     30     31
6 1980    6      3      8     28     31     20     30</code></pre>
</div>
</div>
<p>The main response variable namely the number of admissions is allocated different columns depending on the North and South locations. This format is also called <code>wide format</code> which can be made into a tidy <code>long format</code>. Try-</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>my.data <span class="sc">|&gt;</span> </span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(NORTH1, NORTH2, NORTH3, </span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>         SOUTH1, SOUTH2, SOUTH3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The command <code>spread()</code> does the opposite to <code>gather()</code>. The <code>tidyr</code> package many other functions such as <code>unite()</code>, <code>separate()</code> etc to deal with columns. A better approach would be to use the <code>dplyr</code> function <code>pivot_longer()</code>. Try-</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>my.data <span class="sc">|&gt;</span> </span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> NORTH1<span class="sc">:</span>SOUTH3, </span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"location"</span>, </span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"Admissions"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The command <code>pivot_wider()</code> does the opposite to <code>pivot_longer()</code></p>
<p>The <code>dplyr</code> package also has functions to deal with two-tables which can be joined either conditionally or unconditionally using commands such as <code>full_join()</code>. For a detailed notes and examples, you may visit <a href="https://dplyr.tidyverse.org/articles/two-table.html" class="uri">https://dplyr.tidyverse.org/articles/two-table.html</a> but we will be using such functions very occasionally in this course.</p>
<p>The <code>reshape2</code> and <code>data.table</code> packages also have functions to do the same task.</p>
</section>
</section>
<section id="a-typical-data-analysis-session-in-rrstudio" class="level1 unnumbered">
<h1 class="unnumbered">A typical data analysis session in R/RStudio</h1>
<p>A data analysis session in R/RStudio involves loading the data, graphing, and modelling. You finally save your outputs or produce a Report.</p>
<p>When you begin your analysis in RStudio, start it as a new project in the File menu. You can save all your work in one go when you quit the RStudio software. You can always load your project later on to continue the analysis.</p>
<p>For the sack of simplicity, let us use an R default dataset called <code>stackloss</code> giving the operational data of a plant for the oxidation of ammonia to nitric acid.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"stackloss"</span>)</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(stackloss, <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  Air.Flow Water.Temp Acid.Conc. stack.loss
1       80         27         89         42
2       80         27         88         37
3       75         25         90         37
4       62         24         87         28
5       62         22         87         18</code></pre>
</div>
</div>
<p>The distribution of the response variable <code>stack.loss</code> is explored using a histogram below:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>stackloss <span class="sc">|&gt;</span> </span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(stack.loss) <span class="sc">+</span></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ws01_files/figure-html/unnamed-chunk-47-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Histograms are not good displays for small datasets. In order to see the size or length of <code>stack.loss</code> data, we select the stack.loss variable and then summarise the size using the <em>n()</em> option.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>stackloss <span class="sc">|&gt;</span> </span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(stack.loss) <span class="sc">|&gt;</span> </span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">n</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  n()
1  21</code></pre>
</div>
</div>
<p>The following commands will also work.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(stackloss<span class="sc">$</span>stack.loss)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 21</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>stackloss <span class="sc">|&gt;</span> <span class="fu">pull</span>(stack.loss) <span class="sc">|&gt;</span> <span class="fu">length</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 21</code></pre>
</div>
</div>
<p>We may also explore how well <code>stack.loss</code> is related <code>Air.Flow</code> to using a scatter plot. For this, we type the command <code>plot</code></p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>stackloss <span class="sc">|&gt;</span> </span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">y=</span>stack.loss, <span class="at">x=</span>Air.Flow) <span class="sc">+</span></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ws01_files/figure-html/unnamed-chunk-50-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The relationship is roughly linear. So we may fit a straight line model using the <code>lm</code> command.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>st.line.model <span class="ot">&lt;-</span> <span class="fu">lm</span>(stack.loss<span class="sc">~</span>Air.Flow, <span class="at">data=</span>stackloss)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We can query this model asking for its summary using the <code>summary()</code> function.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(st.line.model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = stack.loss ~ Air.Flow, data = stackloss)

Residuals:
     Min       1Q   Median       3Q      Max 
-12.2896  -1.1272  -0.0459   1.1166   8.8728 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -44.13202    6.10586  -7.228 7.31e-07 ***
Air.Flow      1.02031    0.09995  10.208 3.77e-09 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 4.098 on 19 degrees of freedom
Multiple R-squared:  0.8458,    Adjusted R-squared:  0.8377 
F-statistic: 104.2 on 1 and 19 DF,  p-value: 3.774e-09</code></pre>
</div>
</div>
<p><code>R</code> default model summary is bit too long. We may just glance the overall quality measures of the fitted model as follows:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'kableExtra'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dplyr':

    group_rows</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>out1 <span class="ot">&lt;-</span> st.line.model <span class="sc">|&gt;</span> </span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glance</span>() <span class="sc">|&gt;</span> </span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), </span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>                <span class="sc">~</span><span class="fu">round</span>(., <span class="dv">2</span>))</span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>         )</span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a>out1 <span class="sc">|&gt;</span> <span class="fu">t</span>() <span class="sc">|&gt;</span> <span class="fu">kable</span>() <span class="sc">|&gt;</span> </span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> F) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-classic table table-sm table-striped small" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td style="text-align: left;">r.squared</td>
<td style="text-align: right;">0.85</td>
</tr>
<tr class="even">
<td style="text-align: left;">adj.r.squared</td>
<td style="text-align: right;">0.84</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sigma</td>
<td style="text-align: right;">4.10</td>
</tr>
<tr class="even">
<td style="text-align: left;">statistic</td>
<td style="text-align: right;">104.20</td>
</tr>
<tr class="odd">
<td style="text-align: left;">p.value</td>
<td style="text-align: right;">0.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">df</td>
<td style="text-align: right;">1.00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">logLik</td>
<td style="text-align: right;">-58.37</td>
</tr>
<tr class="even">
<td style="text-align: left;">AIC</td>
<td style="text-align: right;">122.74</td>
</tr>
<tr class="odd">
<td style="text-align: left;">BIC</td>
<td style="text-align: right;">125.87</td>
</tr>
<tr class="even">
<td style="text-align: left;">deviance</td>
<td style="text-align: right;">319.12</td>
</tr>
<tr class="odd">
<td style="text-align: left;">df.residual</td>
<td style="text-align: right;">19.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">nobs</td>
<td style="text-align: right;">21.00</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>For processing using Rmarkdown, we may use the codes which will give a tidy tabular output in the word-processed output.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>out1 <span class="ot">&lt;-</span> st.line.model <span class="sc">|&gt;</span> </span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">|&gt;</span> </span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span><span class="fu">round</span>(., <span class="dv">2</span>)))</span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(out1) <span class="sc">|&gt;</span>  </span>
<span id="cb86-10"><a href="#cb86-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> F) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-classic table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">term</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">std.error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-44.13</td>
<td style="text-align: right;">6.11</td>
<td style="text-align: right;">-7.23</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Air.Flow</td>
<td style="text-align: right;">1.02</td>
<td style="text-align: right;">0.10</td>
<td style="text-align: right;">10.21</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>The fitted model is shown below:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(stackloss) <span class="sc">+</span> </span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">y=</span>stack.loss, <span class="at">x=</span>Air.Flow) <span class="sc">+</span></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm, <span class="at">se =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="ws01_files/figure-html/unnamed-chunk-55-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The fitted model can also be displayed on the scatter plot using the old style <code>plot</code> and <code>abline</code> commands.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(stack.loss <span class="sc">~</span> Air.Flow, <span class="at">data=</span>stackloss)</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>st.line.model <span class="ot">&lt;-</span> <span class="fu">lm</span>(stack.loss<span class="sc">~</span>Air.Flow, <span class="at">data=</span>stackloss)</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(st.line.model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="data-quality-checks" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="data-quality-checks">Data Quality Checks</h2>
<p>It is a good idea to check the quality of secondary data sourced from elsewhere. For example, there could be missing values in the dataset. Consider the Telomeres data downloaded from <a href="http://www.massey.ac.nz/~anhsmith/data/rsos192136_si_001.xlsx" class="uri">http://www.massey.ac.nz/~anhsmith/data/rsos192136_si_001.xlsx</a></p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>url <span class="ot">&lt;-</span> <span class="st">"http://www.massey.ac.nz/~anhsmith/data/rsos192136_si_001.xlsx"</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>destfile <span class="ot">&lt;-</span> <span class="st">"rsos192136_si_001.xlsx"</span></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a><span class="fu">download.file</span>(url, destfile)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>rsos192136_si_001 <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"rsos192136_si_001.xlsx"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The missingness of data can be quickly explored using many R packages. The downloaded Telomeres dataset contain many missing values.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(VIM)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: colorspace</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: grid</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>VIM is ready to use.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Suggestions and bug-reports can be submitted at: https://github.com/statistikat/VIM/issues</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'VIM'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:datasets':

    sleep</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> rsos192136_si_001 <span class="sc">|&gt;</span> </span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aggr</span>(<span class="at">sortVar=</span><span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>() <span class="sc">|&gt;</span> </span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pluck</span>(<span class="st">"combinations"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ws01_files/figure-html/unnamed-chunk-59-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>or</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(naniar)</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a><span class="fu">gg_miss_var</span>(rsos192136_si_001) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The term <em>Missing completely at random</em> (MCAR) is often used to mean there is there is no pattern to the missing data themselves or alternatively the missingness is not related to any other variable or data in the dataset. In other words, the probability of missingness is the same for all units. So no bias is caused by the missing data, and we can discard cases with missing data when we fit models.</p>
<p>In practice, we often find missing data do have a relationship with other variables in the dataset but the actual missing values are random. This situation of data conditionally missing at random is called <em>Missing at random (MAR)</em> data. For a particular survey question, the response rate may differ depending on the respondent’s gender. In this situation, the actual missingness may be random but still related to the gender variable.</p>
<p><em>Missing not at random (MNAR)</em> is the pattern when missingness is related to other variables in the dataset, as well as the values of the missing data are not random. In other words, there is a predictable pattern in the missingness. So we cannot avoid the bias when missing cases are omitted.</p>
<p>There are also situations such as censoring where we just record a single value without actually measuring the variable of interest.</p>
<p>Imputation of data can be made except for the case of MCAR type. A number of R packages are available for data imputation; see <a href="https://cran.r-project.org/web/views/MissingData.html" class="uri">https://cran.r-project.org/web/views/MissingData.html</a> or <a href="https://stefvanbuuren.name/fimd/" class="uri">https://stefvanbuuren.name/fimd/</a>. We may occasionally cover data imputation issue in an assignment question.</p>
<p>There are also R packages to perform automatic investigation for data cleaning. Try-</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dataMaid)</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a><span class="fu">makeDataReport</span>(rsos192136_si_001, <span class="at">output=</span><span class="st">"html"</span>, <span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a><span class="co"># or</span></span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DataExplorer)</span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-8"><a href="#cb101-8" aria-hidden="true" tabindex="-1"></a><span class="fu">create_report</span>(rsos192136_si_001)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Rule based validation is enabled in the R package <em>validate</em>. The R package <em>janitor</em> has a function get_dupes() to find duplicate entries in the dataset. <em>Cleaner</em> package will allow to clean the variables so that the columns are consistent in terms of the factor, date, numerical variable types. You will be largely using data that are already cleaned for your assignments but be aware that you have to perform data cleaning and perform necessary quality checks before analysis.</p>
</section>
</section>
<section id="further-help" class="level1 unnumbered">
<h1 class="unnumbered">Further Help</h1>
<p>There are a number of online sources (tutorials, discussion groups etc) for getting help with R. These links are available at your class Stream. You may also use the advanced search facility of Goggle at <a href="https://www.google.com/advanced_search" class="uri">https://www.google.com/advanced_search</a>; more specifically at <a href="https://stackoverflow.com" class="uri">https://stackoverflow.com</a>.</p>
<ul>
<li><p>For further online tutorials</p>
<ul>
<li><a href="https://r4ds.had.co.nz/" class="uri">https://r4ds.had.co.nz/</a></li>
<li><a href="https://www.datacamp.org" class="uri">https://www.datacamp.org</a></li>
</ul></li>
<li><p>For further graphing example</p>
<ul>
<li><a href="https://www.r-graph-gallery.com/all-graphs" class="uri">https://www.r-graph-gallery.com/all-graphs</a></li>
</ul></li>
<li><p>Getting help:</p>
<ul>
<li>RStudio cheat sheets: <a href="https://www.rstudio.com/resources/cheatsheets" class="uri">https://www.rstudio.com/resources/cheatsheets</a></li>
<li>RStudio resources <a href="https://resources.rstudio.com" class="uri">https://resources.rstudio.com</a></li>
<li>Recommended R packages by topic: <a href="https://cran.r-project.org/web/views/" class="uri">https://cran.r-project.org/web/views/</a></li>
<li>StackOverflow: <a href="https://stackoverflow.com/questions/tagged/r" class="uri">https://stackoverflow.com/questions/tagged/r</a></li>
</ul></li>
</ul>
</section>
<section id="r-default-base-graphing" class="level1 unnumbered">
<h1 class="unnumbered">R default (base) Graphing</h1>
<p>For a simple bar chart, try</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>freq <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>)</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"A"</span>,<span class="st">"B"</span>,<span class="st">"C"</span>,<span class="st">"D"</span>,<span class="st">"E"</span>)</span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(freq, <span class="at">names.arg=</span>names)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Let us generate random data from the normal distribution <em>N(10,1)</em> distribution and form a batch of data for illustrating graphing in R. Try the following commands one by one.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>x  <span class="ot">&lt;-</span>  <span class="fu">rnorm</span>(<span class="dv">40</span>, <span class="dv">10</span>,<span class="dv">1</span>)</span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ws01_files/figure-html/unnamed-chunk-63-1.png" class="img-fluid" width="672"></p>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ws01_files/figure-html/unnamed-chunk-63-2.png" class="img-fluid" width="672"></p>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ws01_files/figure-html/unnamed-chunk-63-3.png" class="img-fluid" width="672"></p>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(x), <span class="at">xlab=</span><span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ws01_files/figure-html/unnamed-chunk-63-4.png" class="img-fluid" width="672"></p>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">stripchart</span>(<span class="fu">round</span>(x,<span class="dv">1</span>), <span class="at">method =</span> <span class="st">"stack"</span>, <span class="at">pch=</span><span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ws01_files/figure-html/unnamed-chunk-63-5.png" class="img-fluid" width="672"></p>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">ecdf</span>(x), <span class="at">verticals=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ws01_files/figure-html/unnamed-chunk-63-6.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We can form a matrix of order 3X2 or (or 2X3) and display all the above six graphs in a panel. This is done using the option <code>par()</code>, which controls the graphics <em>par</em>ameters.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>x  <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">40</span>, <span class="dv">10</span>,<span class="dv">1</span>)</span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>))</span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x) </span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-7"><a href="#cb109-7" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(x)</span>
<span id="cb109-8"><a href="#cb109-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-9"><a href="#cb109-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x)</span>
<span id="cb109-10"><a href="#cb109-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-11"><a href="#cb109-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(x), <span class="at">xlab=</span><span class="st">''</span>)</span>
<span id="cb109-12"><a href="#cb109-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-13"><a href="#cb109-13" aria-hidden="true" tabindex="-1"></a><span class="fu">stripchart</span>(<span class="fu">round</span>(x,<span class="dv">1</span>), <span class="at">method =</span> <span class="st">"stack"</span>, <span class="at">pch=</span><span class="dv">20</span>)</span>
<span id="cb109-14"><a href="#cb109-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-15"><a href="#cb109-15" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">ecdf</span>(x), <span class="at">verticals=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ws01_files/figure-html/unnamed-chunk-64-1.png" class="img-fluid" width="576"></p>
</div>
</div>
<p>Although we shall not cover them here, many plotting options can be set using <code>par()</code> function; including size of margins, font types, the colour of axis labels etc. See <code>help("par")</code>. The option <code>par(new=T)</code> will be useful for an overlaid graph (instead of splitting a graph). Try the following:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>x  <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">40</span>, <span class="dv">10</span>,<span class="dv">1</span>)</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, <span class="at">type =</span> <span class="st">"o"</span>, <span class="at">pch =</span> <span class="dv">1</span>, <span class="at">ylab =</span> <span class="st">""</span>, </span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="fl">6.5</span>, <span class="fl">13.5</span>), <span class="at">lty =</span> <span class="dv">1</span>)</span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new=</span>T)</span>
<span id="cb110-7"><a href="#cb110-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-8"><a href="#cb110-8" aria-hidden="true" tabindex="-1"></a>y  <span class="ot">&lt;-</span>  <span class="fu">rnorm</span>(<span class="dv">40</span>, <span class="dv">10</span>,<span class="dv">1</span>)</span>
<span id="cb110-9"><a href="#cb110-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-10"><a href="#cb110-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(y, <span class="at">type =</span> <span class="st">"o"</span>, <span class="at">pch =</span> <span class="dv">2</span>,</span>
<span id="cb110-11"><a href="#cb110-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Two Batches of Random Normal Data"</span>,</span>
<span id="cb110-12"><a href="#cb110-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="fl">6.5</span>, <span class="fl">13.5</span>), <span class="at">lty =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Note that <code>pch</code> specifies for the plotting character and <code>lty</code> specifies the line type. You can add a legend by the following command line:</p>
<p><code>legend("topright", c("Batch I", "Batch II"), pch=1:2, lty=1:2)</code></p>
<p>For scatter and other related plots, the command is <code>plot()</code>. Try</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>x  <span class="ot">&lt;-</span>  <span class="fu">rnorm</span>(<span class="dv">40</span>, <span class="dv">10</span>,<span class="dv">1</span>)</span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>y  <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">40</span>, <span class="dv">10</span>,<span class="dv">1</span>)</span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(y<span class="sc">~</span>x)  <span class="co"># or plot(x,y) </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Add a title by the command</p>
<p><code>title("This is my title")</code></p>
<p>Add a reference line for the mean at the x-axis by the command</p>
<p><code>abline(v=10)</code></p>
<p>and again with <code>abline(h=10)</code> for the y-axis. A 45 degree (Y=X) line can be added by the command</p>
<p><code>abline(0,1) #slope, b=1, y-intercept a=1</code></p>
<p>You may also specify two points on the graph, and ask them to be connected using the command</p>
<p><code>lines(c(8, 12), c(8, 12), lty=2, col=4, lwd=2)</code></p>
<p>Note that the <code>line()</code> has extra arguments to control the line type, line width, and colour.</p>
<p>The command <code>rug(x)</code> draws will draw small vertical lines on the x-axis (the command actually suits better for one dimensional graphs such as a boxplot). Try</p>
<p><code>rug(x)</code></p>
<p><code>rug(y, side=2)  #side =2 specifies y-axis</code></p>
<p>Graphs can be saved in various file formats, such as PDF (.pdf), JPEG (.jpeg or .jpg), or postscript (.ps), by enclosing the plotting function in the appropriate commands. For example, to save a simple figure as a PDF file, we use the <code>pdf()</code> function.</p>
<p><code>x  &lt;-  1:10</code></p>
<p><code>y  &lt;-  x^2</code></p>
<p><code>pdf(file = "Fig.pdf")</code></p>
<p><code>plot(x, y)</code></p>
<p><code>dev.off()</code></p>
<p>The <code>command dev.off()</code> closes the file. You may use the copy and paste facility for processing graphs or use the RStudio option to save graphs.</p>
<p>The<code>lattice</code> package contains extra graphing facilities but such graphs can be produced using <code>ggplot2</code> package. Try-</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>my.data <span class="ot">&lt;-</span><span class="fu">read.csv</span>(</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"https://www.massey.ac.nz/~anhsmith/data/tv.csv"</span>, </span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">header=</span><span class="cn">TRUE</span>)</span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lattice)</span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-7"><a href="#cb112-7" aria-hidden="true" tabindex="-1"></a><span class="fu">bwplot</span>(TELETIME <span class="sc">~</span> <span class="fu">factor</span>(SCHOOL), </span>
<span id="cb112-8"><a href="#cb112-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">data =</span> my.data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ws01_files/figure-html/unnamed-chunk-67-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>It requires a bit of coding to combine base, lattice and ggplot graphs. Try the following codes which combines three density plots of the same data produced in different styles.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"grid"</span>)</span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"ggplotify"</span>)</span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a>x<span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">30</span>)</span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">as.grob</span>(<span class="sc">~</span><span class="fu">plot</span>(<span class="fu">density</span>(x)))</span>
<span id="cb113-7"><a href="#cb113-7" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">as.ggplot</span>(p1)</span>
<span id="cb113-8"><a href="#cb113-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-9"><a href="#cb113-9" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">as.grob</span>(<span class="fu">densityplot</span>(x))</span>
<span id="cb113-10"><a href="#cb113-10" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">as.ggplot</span>(p2)</span>
<span id="cb113-11"><a href="#cb113-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-12"><a href="#cb113-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb113-13"><a href="#cb113-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-14"><a href="#cb113-14" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x=</span>x) <span class="sc">|&gt;</span> </span>
<span id="cb113-15"><a href="#cb113-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb113-16"><a href="#cb113-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(x) <span class="sc">+</span></span>
<span id="cb113-17"><a href="#cb113-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>()</span>
<span id="cb113-18"><a href="#cb113-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-19"><a href="#cb113-19" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb113-20"><a href="#cb113-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-21"><a href="#cb113-21" aria-hidden="true" tabindex="-1"></a>p1<span class="sc">/</span>(p2<span class="sc">+</span>p3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>It is optional to work through the activities that follow to gain an appreciation of how R works. Do not try to remember how to do everything right now. For your assignment work, we will be given the R codes to load data, graphing and modelling. These codes will give you a head-start. Note that we often often learn R by doing and sometime making mistakes.</p>
</div>
</div>
</section>
<section id="r-objects-model-syntax-etc." class="level1 unnumbered">
<h1 class="unnumbered">R Objects, Model Syntax etc.</h1>
<p>In R, we work with objects. There are different classes of objects including: <code>character</code>, <code>integer</code>, <code>numeric</code>, <code>vector</code>, <code>matrix</code>, <code>array</code>, <code>data.frame</code>, <code>list</code>, <code>lm</code> (linear model). An object may belong to several classes at once.</p>
<p>Suppose that your data consists of 4 numbers say 1 to 4. We can combine these numbers using the <code>c()</code> function namely <code>c(1,2,3,4)</code> and then assign it to <code>x</code>, an object.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Alternatively, we can use the <code>scan()</code> function to enter the data manually one by one. In practice we load/import data and these details are explained in the next section.</p>
<p>Evidently <code>x</code> is a vector and also belongs to other classes of objects. This can be queried as follows:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">is</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The main class it belongs to is queried as</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Our data are actually integers and arranged in a pattern. So we can define <code>x</code> as follows:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The colon (<code>:</code>) operator created the desired pattern. Alternative expressions include</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">4</span>, <span class="at">by=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Try <code>is(x)</code> and <code>class(x)</code> and check whether our data are recognised as integer class.</p>
<p>We can do many mathematical manipulations on <code>x</code>. Try</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(x)</span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(x)</span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a><span class="fu">max</span>(x)</span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(x)</span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(x)</span>
<span id="cb119-6"><a href="#cb119-6" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(x)</span>
<span id="cb119-7"><a href="#cb119-7" aria-hidden="true" tabindex="-1"></a><span class="fu">sort</span>(x, T)</span>
<span id="cb119-8"><a href="#cb119-8" aria-hidden="true" tabindex="-1"></a><span class="fu">trunc</span>(x<span class="sc">/</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Vector elements are accessed by square brackets, <code>[]</code>. Try</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>x[<span class="dv">2</span>]<span class="sc">+</span>x[<span class="dv">4</span>]</span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>x[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a>x[<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>)]</span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a>x[<span class="sc">-</span><span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Assume that our data are actually categorical codes. Then the correct way of defining the character data is to use single quotes as</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'a'</span>, <span class="st">'b'</span>, <span class="st">'c'</span>, <span class="st">'d'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Now try Try <code>is(x)</code> and <code>class(x)</code>. For large patterned categorical data, placing quotes is laborious. So we can change the class as follows:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Assume that you have two batches of data. The first one is</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>and the second one is</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'a'</span>, <span class="st">'b'</span>, <span class="st">'c'</span>, <span class="st">'d'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>These two batches can be combined into a matrix as follows:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">cbind</span>(x,y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Here the matrix <code>m</code> is formed by binding the columns (vectors). The other option is to bind as rows</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">rbind</span>(x,y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Evidently vectors must be of the same length for these commands to work. We can also form a matrix by splitting a vector. Try</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">matrix</span>(x, <span class="at">byrow =</span> <span class="cn">TRUE</span>, <span class="at">ncol =</span> <span class="dv">3</span>)</span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">matrix</span>(x, <span class="at">byrow =</span> <span class="cn">TRUE</span>, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>and just type <code>m</code> to see the generated matrix on the R console.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>m</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>To access the first of row of the matrix <code>m</code>, we use <code>m[1,]</code>; to access the first column of <code>m</code>, we use <code>m[,1]</code>.</p>
<p>A <code>data frame</code> is an R object that contains vectors; the vectors are stored vertically in a matrix like structure, and can be referred to by the name of the column. The main advantage of a data frame is that the variables in a data frame do not all need to be the same type; e.g.&nbsp;some variables can be of class numeric, and some variables can be of class character. We can create a data frame object using the <code>data.frame()</code> function. This data frame contains two small vectors, the first of which is named <code>ID</code>, and the second <code>NAME</code>. Try</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span></span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'a'</span>, <span class="st">'b'</span>, <span class="st">'c'</span>, <span class="st">'d'</span>)</span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a>my.data <span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">ID=</span>x, <span class="at">NAME=</span>y)</span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a>my.data </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We can access the original vector of interest in the following way:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>my.data<span class="sc">$</span>NAME</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>or with <code>tidyverse</code></p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>my.data <span class="sc">|&gt;</span> <span class="fu">pull</span>(NAME)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>There are times when it is useful to convert a data frame into a matrix; we can do this with the <code>as.matrix()</code> function.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(my.data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Type <code>class(m)</code> and see the changes.</p>
<p>Two data frames can also be merged into a single data frame using the <code>merge</code> command.</p>
<p>The internal structure of an R object can be viewed using the diagnostic function <code>str()</code>.</p>
<p><em>Simple Manipulations</em></p>
<p>There is always more than one-way of manipulating the data, producing summaries and tables from raw data.</p>
<p>One of the simplest manipulations on a batch of data we may do is to change the data type say numeric to character. For example, the television viewing time data in the text file <code>tv.csv</code> is read into a dataframe by the command line</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a>my.data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(</span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"https://www.massey.ac.nz/~anhsmith/data/tv.csv"</span>, </span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">header =</span><span class="cn">TRUE</span></span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We can improve the <code>read.csv</code> command to recognise the data type while reading the table as follows, using the <code>read_csv</code> command from the <code>readr</code> package:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a>my.data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(</span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"https://www.massey.ac.nz/~anhsmith/data/tv.csv"</span>, </span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">col_types =</span> <span class="st">"nfcc"</span></span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The argument <code>col_types = "nfcc"</code> stands for {<code>numeric</code>, <code>factor</code>, <code>character</code>, <code>character</code>}, to match the order of the columns.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>my.data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 46 × 4
   TELETIME SEX   SCHOOL STANDARD
      &lt;dbl&gt; &lt;fct&gt; &lt;chr&gt;  &lt;chr&gt;   
 1     1482 1     1      4       
 2     2018 1     1      4       
 3     1849 1     1      4       
 4      857 1     1      4       
 5     2027 2     1      4       
 6     2368 2     1      4       
 7     1783 2     1      4       
 8     1769 2     1      4       
 9     2534 1     1      3       
10     2366 1     1      3       
# ℹ 36 more rows</code></pre>
</div>
</div>
<p>We often do a summary of a numerical variable for a given categorical variable. For example, we like to see obtain the summary statistics of TV viewing times for various schools. The commands</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(my.data)</span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a><span class="fu">by</span>(TELETIME, SCHOOL, summary)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We employed the <code>by()</code> command above and instead, we may also use <code>tapply()</code> <code>aggregate()</code> functions:</p>
<p><code>tapply(TELETIME, SCHOOL, summary)</code></p>
<p><code>aggregate(TELETIME, list(SCHOOL), summary)</code></p>
<p>A tabulated summary of categorical data is obtained using the <code>table()</code> command.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>my.data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(</span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"https://www.massey.ac.nz/~anhsmith/data/rangitikei.csv"</span>,</span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">header=</span><span class="cn">TRUE</span></span>
<span id="cb138-4"><a href="#cb138-4" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb138-5"><a href="#cb138-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-6"><a href="#cb138-6" aria-hidden="true" tabindex="-1"></a>wind <span class="ot">&lt;-</span> my.data <span class="sc">|&gt;</span> <span class="fu">pull</span>(wind)</span>
<span id="cb138-7"><a href="#cb138-7" aria-hidden="true" tabindex="-1"></a>river <span class="ot">&lt;-</span> my.data <span class="sc">|&gt;</span> <span class="fu">pull</span>(river)</span>
<span id="cb138-8"><a href="#cb138-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-9"><a href="#cb138-9" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(wind, river)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>It is sometimes convenient to work with matrices for some R functions such as <code>apply()</code>. For example, the number of admissions data in <code>hospital.txt</code> data can be formed as a matrix. Note that this is possible because we have the same number of observations for each hospital location.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.table</span>(</span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"https://www.massey.ac.nz/~anhsmith/data/hospital.txt"</span>,</span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">header=</span><span class="cn">TRUE</span>, </span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">sep=</span><span class="st">","</span>)</span>
<span id="cb139-5"><a href="#cb139-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-6"><a href="#cb139-6" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> </span>
<span id="cb139-7"><a href="#cb139-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(NORTH1, NORTH2, NORTH3, </span>
<span id="cb139-8"><a href="#cb139-8" aria-hidden="true" tabindex="-1"></a>         SOUTH1, SOUTH2, SOUTH3) <span class="sc">|&gt;</span> </span>
<span id="cb139-9"><a href="#cb139-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sqrt</span>()</span>
<span id="cb139-10"><a href="#cb139-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-11"><a href="#cb139-11" aria-hidden="true" tabindex="-1"></a>means <span class="ot">&lt;-</span> <span class="fu">apply</span>(M, <span class="dv">1</span>, mean)</span>
<span id="cb139-12"><a href="#cb139-12" aria-hidden="true" tabindex="-1"></a>sds <span class="ot">&lt;-</span> <span class="fu">apply</span>(M, <span class="dv">1</span>, sd)</span>
<span id="cb139-13"><a href="#cb139-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-14"><a href="#cb139-14" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(means, sds)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><em>R default options for Hypothesis tests and modelling</em></p>
<p>The <code>stats</code> default package in R has a number of functions for performing hypothesis tests. However you will only use the following for this course:</p>
<p><code>ks.test</code> - Kolmogorov-Smirnov Tests</p>
<p><code>shapiro.test</code> - Shapiro-Wilk Normality Test</p>
<p><code>t.test</code> - Student’s t-Test (one &amp; two samples, paired t-test etc)</p>
<p><code>pairwise.t.test</code> - Pairwise t tests (for multiple comparison)</p>
<p><code>oneway.test</code> - Test for Equal Means in a One-Way Layout</p>
<p><code>TukeyHSD</code> - To Compute Tukey’s Honest Significant Differences</p>
<p><code>var.test</code> - F Test to Compare Two Variances</p>
<p><code>bartlett.test</code> - Bartlett Test of Homogeneity of Variances</p>
<p><code>fisher.test</code> - Fisher’s Exact Test for Count Data</p>
<p><code>chisq.test</code> - Pearson’s Chi-squared Test for Count Data</p>
<p><code>cor.test</code> - Test for Association/Correlation Between Paired Samples</p>
<p>The <code>car</code> package is needed for the following:</p>
<p><code>durbinWatsonTest</code> Durbin-Watson Test for autocorrelated Errors</p>
<p><code>leveneTest</code> Levene’s Test</p>
<p>We will largely use the R function <code>lm</code> in this course. The syntax for specifying a model under <code>lm</code> command (and various other model related commands) is explained below:</p>
<p>The structure of the model is that the response variable is modelled as a function of the response variables. The symbol <code>~</code> (tilde) is used to say “a function of”. The simple regression of <code>y</code> on <code>x</code> is therefore specified as</p>
<p><code>lm(y ~ x)</code></p>
<p>The same applies to a one-way ANOVA in which <code>x</code> is a categorical factor. For example, consider <code>tv.txt</code> dataset and the one-way ANOVA model of <code>TELETIME</code> for <code>SCHOOL</code> is specified as follows:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>mydata <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(</span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"https://www.massey.ac.nz/~anhsmith/data/tv.csv"</span>, </span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">header=</span><span class="cn">TRUE</span></span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb140-5"><a href="#cb140-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-6"><a href="#cb140-6" aria-hidden="true" tabindex="-1"></a>mymodel <span class="ot">&lt;-</span> <span class="fu">lm</span>(TELETIME <span class="sc">~</span> <span class="fu">factor</span>(SCHOOL), </span>
<span id="cb140-7"><a href="#cb140-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> mydata) <span class="co"># replace lm by aov and try</span></span>
<span id="cb140-8"><a href="#cb140-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-9"><a href="#cb140-9" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mymodel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The function <code>summary()</code> gives the summary of the model (F statistics, residual SD etc). The model summary output can be stored into a text file using the function <code>sink()</code> or copy and paste in the windows version. Graphs associated with a model can be obtained using the command</p>
<p><code>plot(mymodel)</code></p>
<p>In the above context, we may also use the specific test command which will give the same result but this test can also be performed without assuming equal variances.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="fu">oneway.test</span>(TELETIME <span class="sc">~</span> SCHOOL, </span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">var.equal =</span> <span class="cn">TRUE</span>, </span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> mydata) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>For the <code>lm</code> command, note the following:</p>
<p><code>+</code> indicates inclusion (not addition) of an explanatory variable in the model</p>
<p><code>-</code> indicates deletion (not subtraction) of an explanatory variable from the model</p>
<p><code>*</code> indicates the inclusion of the explanatory variables and their interaction (not multiplication) between explanatory variables</p>
<p><code>:</code> (colon) means only interaction between explanatory variables</p>
<p><code>/</code> indicates the nesting (not division) of explanatory variables</p>
<p><code>|</code> indicates the conditioning (for example <code>y ~ x|z</code> means that y is a function of x for given z).</p>
<p>For our course, you will not use the last two types. Some model examples are given below:</p>
<p><code>lm(y ~ x + z)</code> #regression of y on x and z (flat surface fit)</p>
<p><code>lm(y ~ x*z)</code> #includes the interaction term ie <code>lm(y ~ x + z + x:z)</code></p>
<p><code>lm(y ~ x + I(x^2)</code> # fits a quadratic model or use <code>poly(x,2)</code></p>
<p><code>lm(log(y) ~ sqrt(x) + log(z))</code> #all variables are transformed</p>
<p>As a further example, consider a study guide dataset. The following commands fit a simple regression model and then plot the fitted line on a scatter plot. Note that commands can be shortened but deliberately shown this way.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a>mydata <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(</span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"https://www.massey.ac.nz/~anhsmith/data/horsehearts.csv"</span>, </span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">header=</span><span class="cn">TRUE</span></span>
<span id="cb142-4"><a href="#cb142-4" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb142-5"><a href="#cb142-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-6"><a href="#cb142-6" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> mydata<span class="sc">$</span>EXTDIA</span>
<span id="cb142-7"><a href="#cb142-7" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> mydata<span class="sc">$</span>WEIGHT</span>
<span id="cb142-8"><a href="#cb142-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-9"><a href="#cb142-9" aria-hidden="true" tabindex="-1"></a>simplereg <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Note that our model object <code>simplereg</code> can be queried in many ways. The command <code>summary()</code> gives the following output.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(simplereg)</span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a><span class="co"># or</span></span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a><span class="co"># library(broom)</span></span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a><span class="co"># tidy(simplereg)</span></span>
<span id="cb143-5"><a href="#cb143-5" aria-hidden="true" tabindex="-1"></a><span class="co"># glance(simplereg)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The command <code>names(simplereg)</code> will gives the names of many individual components of the object <code>simplereg</code> we created. For example, a plot of the residuals against the fitted values can be obtained as</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">residuals</span>(simplereg) <span class="sc">~</span> <span class="fu">fitted.values</span>(simplereg))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>


<!-- -->


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-Wilkinson" class="csl-entry" role="listitem">
Wilkinson, L. 2005. <em>The Grammar of Graphics</em>. Berlin, Heidelberg: Springer-Verlag.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
  </div>
  <div class="nav-page nav-page-next">
      <a href="../workshops/ws02.html" class="pagination-link">
        <span class="nav-page-text">Chapter 2 Workshop</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb145" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Getting Started With R"</span></span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-5"><a href="#cb145-5" aria-hidden="true" tabindex="-1"></a><span class="fu"># Installing `R` and RStudio</span></span>
<span id="cb145-6"><a href="#cb145-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-7"><a href="#cb145-7" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE, message=FALSE, warning=FALSE}</span></span>
<span id="cb145-8"><a href="#cb145-8" aria-hidden="true" tabindex="-1"></a>colorize <span class="ot">&lt;-</span> <span class="cf">function</span>(x, color) {</span>
<span id="cb145-9"><a href="#cb145-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (knitr<span class="sc">::</span><span class="fu">is_latex_output</span>()) {</span>
<span id="cb145-10"><a href="#cb145-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sprintf</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">textcolor{%s}{%s}"</span>, color, x)</span>
<span id="cb145-11"><a href="#cb145-11" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (knitr<span class="sc">::</span><span class="fu">is_html_output</span>()) {</span>
<span id="cb145-12"><a href="#cb145-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sprintf</span>(<span class="st">"&lt;span style='color: %s;'&gt;%s&lt;/span&gt;"</span>, color, </span>
<span id="cb145-13"><a href="#cb145-13" aria-hidden="true" tabindex="-1"></a>      x)</span>
<span id="cb145-14"><a href="#cb145-14" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> x</span>
<span id="cb145-15"><a href="#cb145-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb145-16"><a href="#cb145-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-17"><a href="#cb145-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-18"><a href="#cb145-18" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb145-19"><a href="#cb145-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-20"><a href="#cb145-20" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip}</span>
<span id="cb145-21"><a href="#cb145-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-22"><a href="#cb145-22" aria-hidden="true" tabindex="-1"></a>You are NOT expected to become an expert in R programming or required to be one for doing this course.</span>
<span id="cb145-23"><a href="#cb145-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-24"><a href="#cb145-24" aria-hidden="true" tabindex="-1"></a>Feel free to post your queries regarding R and RStudio on the class discussion forum on Stream.</span>
<span id="cb145-25"><a href="#cb145-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-26"><a href="#cb145-26" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb145-27"><a href="#cb145-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-28"><a href="#cb145-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-29"><a href="#cb145-29" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;https://www.r-project.org/&gt;</span> is an open-source (i.e., free) software</span>
<span id="cb145-30"><a href="#cb145-30" aria-hidden="true" tabindex="-1"></a>package. This software is available for essentially all computing</span>
<span id="cb145-31"><a href="#cb145-31" aria-hidden="true" tabindex="-1"></a>platforms (e.g. Windows, Linux, Unix, Mac) is maintained and developed</span>
<span id="cb145-32"><a href="#cb145-32" aria-hidden="true" tabindex="-1"></a>by an energetic community of users including many of the world's</span>
<span id="cb145-33"><a href="#cb145-33" aria-hidden="true" tabindex="-1"></a>foremost statisticians.</span>
<span id="cb145-34"><a href="#cb145-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-35"><a href="#cb145-35" aria-hidden="true" tabindex="-1"></a>R is also a programming language but you may not be required to do a lot</span>
<span id="cb145-36"><a href="#cb145-36" aria-hidden="true" tabindex="-1"></a>of programming for your course work. R includes functions which enables</span>
<span id="cb145-37"><a href="#cb145-37" aria-hidden="true" tabindex="-1"></a>us to perform a full range of statistical analyses.</span>
<span id="cb145-38"><a href="#cb145-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-39"><a href="#cb145-39" aria-hidden="true" tabindex="-1"></a>**For installing R software, please visit</span>
<span id="cb145-40"><a href="#cb145-40" aria-hidden="true" tabindex="-1"></a><span class="ot">&lt;https://cran.stat.auckland.ac.nz/&gt;</span> and follow the instructions.**</span>
<span id="cb145-41"><a href="#cb145-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-42"><a href="#cb145-42" aria-hidden="true" tabindex="-1"></a>Note that the R software will be sitting in the background in RStudio</span>
<span id="cb145-43"><a href="#cb145-43" aria-hidden="true" tabindex="-1"></a>and you will not be using it directly for this course.</span>
<span id="cb145-44"><a href="#cb145-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-45"><a href="#cb145-45" aria-hidden="true" tabindex="-1"></a>RStudio <span class="ot">&lt;https://www.rstudio.com/products/rstudio/&gt;</span> is an integrated</span>
<span id="cb145-46"><a href="#cb145-46" aria-hidden="true" tabindex="-1"></a>development environment (IDE) for R. It includes a console,</span>
<span id="cb145-47"><a href="#cb145-47" aria-hidden="true" tabindex="-1"></a>syntax-highlighting editor (as well as to quickly jump to R function</span>
<span id="cb145-48"><a href="#cb145-48" aria-hidden="true" tabindex="-1"></a>definitions) that supports direct R code execution. It also contains</span>
<span id="cb145-49"><a href="#cb145-49" aria-hidden="true" tabindex="-1"></a>tools for plotting, history, debugging, workspace and project</span>
<span id="cb145-50"><a href="#cb145-50" aria-hidden="true" tabindex="-1"></a>management. RStudio has many other features such as authoring HTML, PDF,</span>
<span id="cb145-51"><a href="#cb145-51" aria-hidden="true" tabindex="-1"></a>Word Documents, and slide shows. In order to download RStudio (Desktop</span>
<span id="cb145-52"><a href="#cb145-52" aria-hidden="true" tabindex="-1"></a>edition, open source), go to</span>
<span id="cb145-53"><a href="#cb145-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-54"><a href="#cb145-54" aria-hidden="true" tabindex="-1"></a><span class="ot">&lt;https://www.rstudio.com/products/rstudio/download/&gt;</span></span>
<span id="cb145-55"><a href="#cb145-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-56"><a href="#cb145-56" aria-hidden="true" tabindex="-1"></a>Download the installation file and run it. **Note that RStudio must be</span>
<span id="cb145-57"><a href="#cb145-57" aria-hidden="true" tabindex="-1"></a>installed after installing R.**</span>
<span id="cb145-58"><a href="#cb145-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-59"><a href="#cb145-59" aria-hidden="true" tabindex="-1"></a>R/RStudio can also be used using the cloud platform at</span>
<span id="cb145-60"><a href="#cb145-60" aria-hidden="true" tabindex="-1"></a><span class="ot">&lt;https://rstudio.cloud/&gt;</span> after creating a *free* account but</span>
<span id="cb145-61"><a href="#cb145-61" aria-hidden="true" tabindex="-1"></a>occasionally some of the packages covered in this course may fail to</span>
<span id="cb145-62"><a href="#cb145-62" aria-hidden="true" tabindex="-1"></a>work in the cloud platform.</span>
<span id="cb145-63"><a href="#cb145-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-64"><a href="#cb145-64" aria-hidden="true" tabindex="-1"></a>If you open RStudio, you will see something similar to the screen shot</span>
<span id="cb145-65"><a href="#cb145-65" aria-hidden="true" tabindex="-1"></a>shown in @fig-rstud:</span>
<span id="cb145-66"><a href="#cb145-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-67"><a href="#cb145-67" aria-hidden="true" tabindex="-1"></a><span class="al">![An RStudio window](img/Rstudio.png)</span>{#fig-rstud}</span>
<span id="cb145-68"><a href="#cb145-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-69"><a href="#cb145-69" aria-hidden="true" tabindex="-1"></a>RStudio has many options, such as uploading files to a server, creating</span>
<span id="cb145-70"><a href="#cb145-70" aria-hidden="true" tabindex="-1"></a>documents etc. You will be using only a few of the options. You will</span>
<span id="cb145-71"><a href="#cb145-71" aria-hidden="true" tabindex="-1"></a>*not* be using the menus such as *Build*, *Debug*, *Profile* at all in</span>
<span id="cb145-72"><a href="#cb145-72" aria-hidden="true" tabindex="-1"></a>this course.</span>
<span id="cb145-73"><a href="#cb145-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-74"><a href="#cb145-74" aria-hidden="true" tabindex="-1"></a>You can either type or copy and paste the R codes appearing in this</span>
<span id="cb145-75"><a href="#cb145-75" aria-hidden="true" tabindex="-1"></a>section on to the R Script window and run them.</span>
<span id="cb145-76"><a href="#cb145-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-77"><a href="#cb145-77" aria-hidden="true" tabindex="-1"></a><span class="fu"># Some `R` basics {.unnumbered}</span></span>
<span id="cb145-78"><a href="#cb145-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-79"><a href="#cb145-79" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`R`</span> is case sensitive, so <span class="in">`data`</span> is not the same as <span class="in">`DATA`</span></span>
<span id="cb145-80"><a href="#cb145-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-81"><a href="#cb145-81" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`&lt;-`</span> (read as "gets") is the assignment operator. That is, you use</span>
<span id="cb145-82"><a href="#cb145-82" aria-hidden="true" tabindex="-1"></a>    <span class="in">`&lt;-`</span> to assign some content to a variable. The operator <span class="in">`=`</span> has a</span>
<span id="cb145-83"><a href="#cb145-83" aria-hidden="true" tabindex="-1"></a>    slightly different meaning but it can be used in the same way as <span class="in">`&lt;-`</span>. In R Studio, press <span class="in">`ALT`</span> and minus key when you are in the R script mode</span>
<span id="cb145-84"><a href="#cb145-84" aria-hidden="true" tabindex="-1"></a>    (File <span class="sc">\&gt;\&gt;</span> New File <span class="sc">\&gt;\&gt;</span> R Script).</span>
<span id="cb145-85"><a href="#cb145-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-86"><a href="#cb145-86" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Comments are denoted by the <span class="sc">\#</span> symbol. Anything after a <span class="in">`#`</span> symbol</span>
<span id="cb145-87"><a href="#cb145-87" aria-hidden="true" tabindex="-1"></a>    is ignored by <span class="in">`R`</span> .</span>
<span id="cb145-88"><a href="#cb145-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-89"><a href="#cb145-89" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>R coding can be hard to write from scratch. </span>
<span id="cb145-90"><a href="#cb145-90" aria-hidden="true" tabindex="-1"></a>    <span class="in">`r colorize("So do not hesitate to adopt R codes written by others.", "red")`</span></span>
<span id="cb145-91"><a href="#cb145-91" aria-hidden="true" tabindex="-1"></a>    Search the internet for R code to do what you want to do. The usual <span class="in">`copy and paste`</span> trick works!</span>
<span id="cb145-92"><a href="#cb145-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-93"><a href="#cb145-93" aria-hidden="true" tabindex="-1"></a>*Working directory*</span>
<span id="cb145-94"><a href="#cb145-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-95"><a href="#cb145-95" aria-hidden="true" tabindex="-1"></a>In RStudio, set the working directory under the *Session* menu. It is a</span>
<span id="cb145-96"><a href="#cb145-96" aria-hidden="true" tabindex="-1"></a>good idea to start your analysis as a new project in the File menu so</span>
<span id="cb145-97"><a href="#cb145-97" aria-hidden="true" tabindex="-1"></a>that the entire work and data files can be saved and re-opened easily</span>
<span id="cb145-98"><a href="#cb145-98" aria-hidden="true" tabindex="-1"></a>later on.</span>
<span id="cb145-99"><a href="#cb145-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-100"><a href="#cb145-100" aria-hidden="true" tabindex="-1"></a>*R/RStudio as a calculator*</span>
<span id="cb145-101"><a href="#cb145-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-102"><a href="#cb145-102" aria-hidden="true" tabindex="-1"></a>*In RStudio, use the File <span class="sc">\&gt;\&gt;</span> New File <span class="sc">\&gt;\&gt;</span> R Script menu to type or</span>
<span id="cb145-103"><a href="#cb145-103" aria-hidden="true" tabindex="-1"></a>copy and paste the commands and execute them*</span>
<span id="cb145-104"><a href="#cb145-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-105"><a href="#cb145-105" aria-hidden="true" tabindex="-1"></a>Type <span class="in">`1+1`</span> to see <span class="in">`2`</span> on the console (or <span class="in">`-&gt;Run`</span> the code in RStudio).</span>
<span id="cb145-106"><a href="#cb145-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-109"><a href="#cb145-109" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb145-110"><a href="#cb145-110" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">+</span><span class="dv">1</span></span>
<span id="cb145-111"><a href="#cb145-111" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb145-112"><a href="#cb145-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-113"><a href="#cb145-113" aria-hidden="true" tabindex="-1"></a>Type <span class="in">`a=1;b=2;a/b`</span> to see <span class="in">`0.5`</span>.</span>
<span id="cb145-114"><a href="#cb145-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-117"><a href="#cb145-117" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb145-118"><a href="#cb145-118" aria-hidden="true" tabindex="-1"></a>a<span class="ot">=</span><span class="dv">1</span>;b<span class="ot">=</span><span class="dv">2</span>;a<span class="sc">/</span>b</span>
<span id="cb145-119"><a href="#cb145-119" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb145-120"><a href="#cb145-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-121"><a href="#cb145-121" aria-hidden="true" tabindex="-1"></a>Note that semicolon separates various commands. It is optional to use</span>
<span id="cb145-122"><a href="#cb145-122" aria-hidden="true" tabindex="-1"></a>them as long as you type the commands one by one as follows:</span>
<span id="cb145-123"><a href="#cb145-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-126"><a href="#cb145-126" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb145-127"><a href="#cb145-127" aria-hidden="true" tabindex="-1"></a>a<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb145-128"><a href="#cb145-128" aria-hidden="true" tabindex="-1"></a>b<span class="ot">=</span><span class="dv">2</span></span>
<span id="cb145-129"><a href="#cb145-129" aria-hidden="true" tabindex="-1"></a>a<span class="sc">/</span>b</span>
<span id="cb145-130"><a href="#cb145-130" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb145-131"><a href="#cb145-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-132"><a href="#cb145-132" aria-hidden="true" tabindex="-1"></a>There are many built-in functions. Try the following.</span>
<span id="cb145-133"><a href="#cb145-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-134"><a href="#cb145-134" aria-hidden="true" tabindex="-1"></a><span class="in">`27^3`</span> <span class="in">`sqrt(10)`</span> <span class="in">`round(sqrt(10),2)`</span> <span class="in">`abs(-4)`</span> <span class="in">`log(10)`</span> <span class="in">`exp(10)`</span></span>
<span id="cb145-135"><a href="#cb145-135" aria-hidden="true" tabindex="-1"></a><span class="in">`rnorm(100)`</span> <span class="in">`mean(rnorm(100))`</span> <span class="in">`sd(rnorm(100))`</span></span>
<span id="cb145-136"><a href="#cb145-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-137"><a href="#cb145-137" aria-hidden="true" tabindex="-1"></a>You may wonder what was the base used for <span class="in">`log(10)`</span>. A help on this can</span>
<span id="cb145-138"><a href="#cb145-138" aria-hidden="true" tabindex="-1"></a>be obtained by placing a question mark (<span class="in">`?`</span>) before log as <span class="in">`?log`</span> or by</span>
<span id="cb145-139"><a href="#cb145-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-140"><a href="#cb145-140" aria-hidden="true" tabindex="-1"></a>**help(log)**</span>
<span id="cb145-141"><a href="#cb145-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-142"><a href="#cb145-142" aria-hidden="true" tabindex="-1"></a>There are a few exceptions. The command <span class="in">`?if`</span> wont work but <span class="in">`?"if"`</span></span>
<span id="cb145-143"><a href="#cb145-143" aria-hidden="true" tabindex="-1"></a>will. In other words, <span class="in">`?"log"`</span> or <span class="in">`help("log")`</span> are safer ways of</span>
<span id="cb145-144"><a href="#cb145-144" aria-hidden="true" tabindex="-1"></a>getting help on "built-in" functions.</span>
<span id="cb145-145"><a href="#cb145-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-146"><a href="#cb145-146" aria-hidden="true" tabindex="-1"></a><span class="in">`r colorize("In RStudio, use the R Editor (menu *File &gt; New Script*) to type the commands and submit them (shortcut: *CNTRL+R*). ", "red")`</span></span>
<span id="cb145-147"><a href="#cb145-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-148"><a href="#cb145-148" aria-hidden="true" tabindex="-1"></a>*Default examples*</span>
<span id="cb145-149"><a href="#cb145-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-150"><a href="#cb145-150" aria-hidden="true" tabindex="-1"></a>The command <span class="in">`example()`</span> will produce the available HELP examples, and</span>
<span id="cb145-151"><a href="#cb145-151" aria-hidden="true" tabindex="-1"></a>will work for most functions. For example, try <span class="in">`example(boxplot)`</span>. You</span>
<span id="cb145-152"><a href="#cb145-152" aria-hidden="true" tabindex="-1"></a>will see many boxplot examples such as the following:</span>
<span id="cb145-153"><a href="#cb145-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-156"><a href="#cb145-156" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb145-157"><a href="#cb145-157" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(count <span class="sc">~</span> spray, <span class="at">data =</span> InsectSprays, <span class="at">col =</span> <span class="st">"lightgray"</span>)</span>
<span id="cb145-158"><a href="#cb145-158" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb145-159"><a href="#cb145-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-160"><a href="#cb145-160" aria-hidden="true" tabindex="-1"></a>There are also demos available, explore using the command <span class="in">`demo()`</span>. The</span>
<span id="cb145-161"><a href="#cb145-161" aria-hidden="true" tabindex="-1"></a>basic R system produces somewhat old style graphs.</span>
<span id="cb145-162"><a href="#cb145-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-163"><a href="#cb145-163" aria-hidden="true" tabindex="-1"></a>[So we will be largely using the newer plotting system **ggplot** which</span>
<span id="cb145-164"><a href="#cb145-164" aria-hidden="true" tabindex="-1"></a>is part of the <span class="in">`tidyverse`</span> suite of packages; see</span>
<span id="cb145-165"><a href="#cb145-165" aria-hidden="true" tabindex="-1"></a><span class="ot">&lt;https://www.tidyverse.org/&gt;</span>.]{style="color: red;"} </span>
<span id="cb145-166"><a href="#cb145-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-167"><a href="#cb145-167" aria-hidden="true" tabindex="-1"></a>Let's load that package now:</span>
<span id="cb145-168"><a href="#cb145-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-171"><a href="#cb145-171" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb145-172"><a href="#cb145-172" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb145-173"><a href="#cb145-173" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb145-174"><a href="#cb145-174" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb145-175"><a href="#cb145-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-176"><a href="#cb145-176" aria-hidden="true" tabindex="-1"></a>A huge number of other dedicated packages are available to improve the</span>
<span id="cb145-177"><a href="#cb145-177" aria-hidden="true" tabindex="-1"></a>power of R. Many R packages are hosted at a repository called CRAN</span>
<span id="cb145-178"><a href="#cb145-178" aria-hidden="true" tabindex="-1"></a>(*C*omprehensive *R* *A*rchive *N*etwork). The package install option</span>
<span id="cb145-179"><a href="#cb145-179" aria-hidden="true" tabindex="-1"></a>within RStudio can download and install these optional packages under</span>
<span id="cb145-180"><a href="#cb145-180" aria-hidden="true" tabindex="-1"></a>the menu <span class="in">`Packages &gt;&gt; Install`</span>. You can also do this using the command</span>
<span id="cb145-181"><a href="#cb145-181" aria-hidden="true" tabindex="-1"></a><span class="in">`install.packages`</span>. For example</span>
<span id="cb145-182"><a href="#cb145-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-183"><a href="#cb145-183" aria-hidden="true" tabindex="-1"></a><span class="in">`install.packages(c("tidyverse", "car"), dependencies = TRUE)`</span></span>
<span id="cb145-184"><a href="#cb145-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-185"><a href="#cb145-185" aria-hidden="true" tabindex="-1"></a>This command installs two packages <span class="in">`tidyverse`</span> and <span class="in">`car`</span> in one go.</span>
<span id="cb145-186"><a href="#cb145-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-187"><a href="#cb145-187" aria-hidden="true" tabindex="-1"></a>Contributed R packages are grouped in various headings at</span>
<span id="cb145-188"><a href="#cb145-188" aria-hidden="true" tabindex="-1"></a><span class="ot">&lt;https://cran.r-project.org/web/views/&gt;</span>. They can be installed in bulk</span>
<span id="cb145-189"><a href="#cb145-189" aria-hidden="true" tabindex="-1"></a>using the <span class="in">`ctv`</span> package command <span class="in">`install.views()`</span>.</span>
<span id="cb145-190"><a href="#cb145-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-191"><a href="#cb145-191" aria-hidden="true" tabindex="-1"></a>You might have to install quite a few packages as you work through this course.</span>
<span id="cb145-192"><a href="#cb145-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-193"><a href="#cb145-193" aria-hidden="true" tabindex="-1"></a><span class="fu"># Quarto {.unnumbered}</span></span>
<span id="cb145-194"><a href="#cb145-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-195"><a href="#cb145-195" aria-hidden="true" tabindex="-1"></a>I encourage you to get into the habit of using <span class="co">[</span><span class="ot">Quarto</span><span class="co">](https://quarto.org/)</span> <span class="in">`*.qmd`</span> files rather than raw <span class="in">`*.R`</span> files. If you've heard of Rmarkdown, Quarto is the successor to Rmarkdown. So, if you're just starting to use R, then you should begin with Quarto rather than Rmarkdown, because most/all new development will be going into Quarto.</span>
<span id="cb145-196"><a href="#cb145-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-197"><a href="#cb145-197" aria-hidden="true" tabindex="-1"></a>Quarto files contain text and code, and can be 'knitted' to produce a nicely formatted document, usually in HTML or PDF format, containing sections, text, code, plots, and output. Quarto can also be used to make websites; in fact, the website for this course was made using Quarto.</span>
<span id="cb145-198"><a href="#cb145-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-199"><a href="#cb145-199" aria-hidden="true" tabindex="-1"></a>Here's some information to get you started: <span class="ot">&lt;https://quarto.org/docs/get-started/hello/rstudio.html&gt;</span>.</span>
<span id="cb145-200"><a href="#cb145-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-201"><a href="#cb145-201" aria-hidden="true" tabindex="-1"></a>And some other useful tips: <span class="ot">&lt;https://r4ds.hadley.nz/quarto&gt;</span>.</span>
<span id="cb145-202"><a href="#cb145-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-203"><a href="#cb145-203" aria-hidden="true" tabindex="-1"></a><span class="fu"># R Projects and GitHub {.unnumbered}</span></span>
<span id="cb145-204"><a href="#cb145-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-205"><a href="#cb145-205" aria-hidden="true" tabindex="-1"></a>Instead of putting your R code into an ordinary directory on your computer, I encourage you to use Rstudio Projects. A Project is a self-contained directory of code and data, pertaining to a particular project. You might create a single project for your work during this course, with a folder for workshops and another folder for assignments. </span>
<span id="cb145-206"><a href="#cb145-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-207"><a href="#cb145-207" aria-hidden="true" tabindex="-1"></a>Here's a primer on R projects: <span class="ot">&lt;https://r4ds.hadley.nz/workflow-scripts#projects&gt;</span></span>
<span id="cb145-208"><a href="#cb145-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-209"><a href="#cb145-209" aria-hidden="true" tabindex="-1"></a>An advantage of Projects is that they work nicely with <span class="co">[</span><span class="ot">GitHub</span><span class="co">](https://github.com/)</span>, a cloud code-repository service. If you plan to do any programming during your career, you'll probably need to learn how to use GitHub. It can be a little tricky to use at first. You don't have to use it for this course, but feel free to have a go at it if you're interested.</span>
<span id="cb145-210"><a href="#cb145-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-211"><a href="#cb145-211" aria-hidden="true" tabindex="-1"></a>If you're using R projects and GitHub, this online book is a great place to start: <span class="co">[</span><span class="ot">Happy Git and GitHub for the useR</span><span class="co">](https://happygitwithr.com/)</span>.</span>
<span id="cb145-212"><a href="#cb145-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-213"><a href="#cb145-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-214"><a href="#cb145-214" aria-hidden="true" tabindex="-1"></a><span class="fu"># Loading/Importing Data {.unnumbered}</span></span>
<span id="cb145-215"><a href="#cb145-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-216"><a href="#cb145-216" aria-hidden="true" tabindex="-1"></a>Most data sets we shall consider in this course are in a tabular form.</span>
<span id="cb145-217"><a href="#cb145-217" aria-hidden="true" tabindex="-1"></a>This means that each variable is a column, each row is an observation,</span>
<span id="cb145-218"><a href="#cb145-218" aria-hidden="true" tabindex="-1"></a>columns are separated by white space (or comma), and each column or row</span>
<span id="cb145-219"><a href="#cb145-219" aria-hidden="true" tabindex="-1"></a>may have a name. </span>
<span id="cb145-220"><a href="#cb145-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-221"><a href="#cb145-221" aria-hidden="true" tabindex="-1"></a>If the data file is stored locally, you should put the data into the same directory as your Quarto or R markdown script. That way, you can (usually) load it easily without having to type the full pathway (e.g., <span class="in">`mydata.csv`</span> rather than <span class="in">`C:/Users/anhsmith/Work/Project1/data/mydata.csv`</span>). Better yet, <span class="co">[</span><span class="ot">Projects</span><span class="co">](https://r4ds.hadley.nz/workflow-scripts#projects)</span> make this much easier.</span>
<span id="cb145-222"><a href="#cb145-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-223"><a href="#cb145-223" aria-hidden="true" tabindex="-1"></a>You can also load data from the web using a URL. For example,</span>
<span id="cb145-224"><a href="#cb145-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-227"><a href="#cb145-227" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb145-228"><a href="#cb145-228" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: show</span></span>
<span id="cb145-229"><a href="#cb145-229" aria-hidden="true" tabindex="-1"></a><span class="fu">read_csv</span>(<span class="st">"https://www.massey.ac.nz/~anhsmith/data/rangitikei.csv"</span>)</span>
<span id="cb145-230"><a href="#cb145-230" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb145-231"><a href="#cb145-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-232"><a href="#cb145-232" aria-hidden="true" tabindex="-1"></a>We'd usually want to store the data as an object though, like so:</span>
<span id="cb145-233"><a href="#cb145-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-236"><a href="#cb145-236" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb145-237"><a href="#cb145-237" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: show</span></span>
<span id="cb145-238"><a href="#cb145-238" aria-hidden="true" tabindex="-1"></a>rangitikei <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"https://www.massey.ac.nz/~anhsmith/data/rangitikei.csv"</span>)</span>
<span id="cb145-239"><a href="#cb145-239" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb145-240"><a href="#cb145-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-241"><a href="#cb145-241" aria-hidden="true" tabindex="-1"></a>Now the data are available in R as an object.</span>
<span id="cb145-242"><a href="#cb145-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-245"><a href="#cb145-245" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb145-246"><a href="#cb145-246" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: show</span></span>
<span id="cb145-247"><a href="#cb145-247" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(rangitikei)</span>
<span id="cb145-248"><a href="#cb145-248" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb145-249"><a href="#cb145-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-250"><a href="#cb145-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-251"><a href="#cb145-251" aria-hidden="true" tabindex="-1"></a>If the data are stored as a <span class="in">`*.csv`</span> or "comma separated values" file, then you can use the <span class="in">`read.csv()`</span> or <span class="in">`read_csv()`</span> function to load the file. If it's a text file with columns separated by spaces or tabs, you can use  <span class="in">`read.table()`</span> or <span class="in">`read_table()`</span> function. The ones with underscores ( <span class="in">`read_csv()`</span> and <span class="in">`read_table()`</span>) are in the <span class="in">`readr`</span> package, so you'll need to load it first (though <span class="in">`readr`</span> is part of <span class="in">`tidyverse`</span>, so if you load <span class="in">`tidyverse`</span> you're all set). </span>
<span id="cb145-252"><a href="#cb145-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-253"><a href="#cb145-253" aria-hidden="true" tabindex="-1"></a>You can also load Microsoft Excel files using functions <span class="in">`read_excel()`</span>, available in the <span class="in">`readxl`</span> package.</span>
<span id="cb145-254"><a href="#cb145-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-255"><a href="#cb145-255" aria-hidden="true" tabindex="-1"></a>As an exercise, try importing the Telomeres data file (in Excel format)</span>
<span id="cb145-256"><a href="#cb145-256" aria-hidden="true" tabindex="-1"></a>available at</span>
<span id="cb145-257"><a href="#cb145-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-258"><a href="#cb145-258" aria-hidden="true" tabindex="-1"></a><span class="ot">&lt;https://rs.figshare.com/ndownloader/files/22850096&gt;</span></span>
<span id="cb145-259"><a href="#cb145-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-260"><a href="#cb145-260" aria-hidden="true" tabindex="-1"></a>Note that Excel files usually contain blanks for missing or unreported</span>
<span id="cb145-261"><a href="#cb145-261" aria-hidden="true" tabindex="-1"></a>data or allocate many rows for variable description, which can cause</span>
<span id="cb145-262"><a href="#cb145-262" aria-hidden="true" tabindex="-1"></a>issues while importing them.</span>
<span id="cb145-263"><a href="#cb145-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-264"><a href="#cb145-264" aria-hidden="true" tabindex="-1"></a>Native R data, stored as <span class="in">`*.RData`</span> or <span class="in">`*.rds`</span> files, can be loaded using the <span class="in">`load()`</span> or <span class="in">`readRDS()`</span> functions, respectively.</span>
<span id="cb145-265"><a href="#cb145-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-266"><a href="#cb145-266" aria-hidden="true" tabindex="-1"></a>SQLite is a public-domain, light-weight database engine (https://sqlite.org/about.html). The R package <span class="in">`RSQLite`</span> will import *.sqlite files. Databases are usually large in size, and hence R packages such as <span class="in">`dbplyr`</span> can be used package to query a database.</span>
<span id="cb145-267"><a href="#cb145-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-268"><a href="#cb145-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-269"><a href="#cb145-269" aria-hidden="true" tabindex="-1"></a><span class="fu"># Graphing with `ggplot2` {.unnumbered}</span></span>
<span id="cb145-270"><a href="#cb145-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-271"><a href="#cb145-271" aria-hidden="true" tabindex="-1"></a>The R library <span class="in">`ggplot2`</span> is very powerful for plotting but</span>
<span id="cb145-272"><a href="#cb145-272" aria-hidden="true" tabindex="-1"></a><span class="in">`r colorize("you may find the syntax little strange.", "red")`</span> There are</span>
<span id="cb145-273"><a href="#cb145-273" aria-hidden="true" tabindex="-1"></a>plenty of examples at the [<span class="in">`ggplot2`</span> online help</span>
<span id="cb145-274"><a href="#cb145-274" aria-hidden="true" tabindex="-1"></a>website](https://ggplot2.tidyverse.org/reference/). The <span class="in">`ggplot2`</span> package is loaded as part of the <span class="in">`tidyverse`</span> set of packages.</span>
<span id="cb145-275"><a href="#cb145-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-276"><a href="#cb145-276" aria-hidden="true" tabindex="-1"></a>Advantages of <span class="in">`ggplot2`</span> are the following:</span>
<span id="cb145-277"><a href="#cb145-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-278"><a href="#cb145-278" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>employs the "grammar of graphics" of <span class="co">[</span><span class="ot">@Wilkinson</span><span class="co">]</span></span>
<span id="cb145-279"><a href="#cb145-279" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>plotting involves a high level of abstraction</span>
<span id="cb145-280"><a href="#cb145-280" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>very flexible and complete graphics system</span>
<span id="cb145-281"><a href="#cb145-281" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>theme system for getting attractive plots</span>
<span id="cb145-282"><a href="#cb145-282" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Fast growing and actively developed</span>
<span id="cb145-283"><a href="#cb145-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-284"><a href="#cb145-284" aria-hidden="true" tabindex="-1"></a>Some disadvantages of <span class="in">`ggplot2`</span> are the following:</span>
<span id="cb145-285"><a href="#cb145-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-286"><a href="#cb145-286" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>3-dimensional graphics (opt for <span class="in">`rgl`</span> package instead)</span>
<span id="cb145-287"><a href="#cb145-287" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Graph-theory type graphs (nodes/edges layout; opt for <span class="in">`igraph`</span> and</span>
<span id="cb145-288"><a href="#cb145-288" aria-hidden="true" tabindex="-1"></a>    other packages)</span>
<span id="cb145-289"><a href="#cb145-289" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Interactive graphics (opt for <span class="in">`plotly`</span>, <span class="in">`ggvis`</span> and other packages)</span>
<span id="cb145-290"><a href="#cb145-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-291"><a href="#cb145-291" aria-hidden="true" tabindex="-1"></a><span class="fu">## Grammar of Graphics</span></span>
<span id="cb145-292"><a href="#cb145-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-293"><a href="#cb145-293" aria-hidden="true" tabindex="-1"></a>The main idea behind the grammar of graphics of <span class="co">[</span><span class="ot">@Wilkinson</span><span class="co">]</span> is to mimic</span>
<span id="cb145-294"><a href="#cb145-294" aria-hidden="true" tabindex="-1"></a>the manual graphing approach and define building blocks and combine them</span>
<span id="cb145-295"><a href="#cb145-295" aria-hidden="true" tabindex="-1"></a>to create a graphical display. The building blocks of a graph are:</span>
<span id="cb145-296"><a href="#cb145-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-297"><a href="#cb145-297" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>data</span>
<span id="cb145-298"><a href="#cb145-298" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>aesthetic mapping</span>
<span id="cb145-299"><a href="#cb145-299" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>geometric object</span>
<span id="cb145-300"><a href="#cb145-300" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>transformation or re-expression of data</span>
<span id="cb145-301"><a href="#cb145-301" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>scales</span>
<span id="cb145-302"><a href="#cb145-302" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>coordinate system</span>
<span id="cb145-303"><a href="#cb145-303" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>position adjustments</span>
<span id="cb145-304"><a href="#cb145-304" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>faceting</span>
<span id="cb145-305"><a href="#cb145-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-306"><a href="#cb145-306" aria-hidden="true" tabindex="-1"></a>If have not installed <span class="in">`ggplot2`</span> or <span class="in">`tidyverse`</span>, install it with the</span>
<span id="cb145-307"><a href="#cb145-307" aria-hidden="true" tabindex="-1"></a>following commands.</span>
<span id="cb145-308"><a href="#cb145-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-309"><a href="#cb145-309" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval=FALSE}</span></span>
<span id="cb145-310"><a href="#cb145-310" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"ggplot2"</span>)</span>
<span id="cb145-311"><a href="#cb145-311" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb145-312"><a href="#cb145-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-313"><a href="#cb145-313" aria-hidden="true" tabindex="-1"></a>We can now load the <span class="in">`ggplot2`</span> library with the commands:</span>
<span id="cb145-314"><a href="#cb145-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-315"><a href="#cb145-315" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warninng=FALSE}</span></span>
<span id="cb145-316"><a href="#cb145-316" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb145-317"><a href="#cb145-317" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb145-318"><a href="#cb145-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-319"><a href="#cb145-319" aria-hidden="true" tabindex="-1"></a>In order to work with <span class="in">`ggplot2`</span>, we must have a <span class="in">`data frame`</span> or a <span class="in">`tibble`</span></span>
<span id="cb145-320"><a href="#cb145-320" aria-hidden="true" tabindex="-1"></a>containing our data. We need to specify the <span class="in">`aesthetics`</span> or how the</span>
<span id="cb145-321"><a href="#cb145-321" aria-hidden="true" tabindex="-1"></a>columns of our data frame can be translated into positions, colours,</span>
<span id="cb145-322"><a href="#cb145-322" aria-hidden="true" tabindex="-1"></a>sizes, and shapes of graphical elements.</span>
<span id="cb145-323"><a href="#cb145-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-324"><a href="#cb145-324" aria-hidden="true" tabindex="-1"></a>The geometric objects and aesthetics of the ggplot2 system are explained</span>
<span id="cb145-325"><a href="#cb145-325" aria-hidden="true" tabindex="-1"></a>below:</span>
<span id="cb145-326"><a href="#cb145-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-327"><a href="#cb145-327" aria-hidden="true" tabindex="-1"></a><span class="fu">## Aesthetic Mapping (`aes`)</span></span>
<span id="cb145-328"><a href="#cb145-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-329"><a href="#cb145-329" aria-hidden="true" tabindex="-1"></a>In ggplot land *aesthetic* means visualisation features or aesthetics.</span>
<span id="cb145-330"><a href="#cb145-330" aria-hidden="true" tabindex="-1"></a>These are</span>
<span id="cb145-331"><a href="#cb145-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-332"><a href="#cb145-332" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>position (i.e., on the x and y axes)</span>
<span id="cb145-333"><a href="#cb145-333" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>color ("outside" color)</span>
<span id="cb145-334"><a href="#cb145-334" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>fill ("inside" color)</span>
<span id="cb145-335"><a href="#cb145-335" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>shape (of points)</span>
<span id="cb145-336"><a href="#cb145-336" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>linetype</span>
<span id="cb145-337"><a href="#cb145-337" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>size</span>
<span id="cb145-338"><a href="#cb145-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-339"><a href="#cb145-339" aria-hidden="true" tabindex="-1"></a>Aesthetic mappings are set with the <span class="in">`aes()`</span> function.</span>
<span id="cb145-340"><a href="#cb145-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-341"><a href="#cb145-341" aria-hidden="true" tabindex="-1"></a><span class="fu">## Geometric Objects (`geom`)</span></span>
<span id="cb145-342"><a href="#cb145-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-343"><a href="#cb145-343" aria-hidden="true" tabindex="-1"></a>Geometric objects or <span class="in">`geoms`</span> are the actual marking or inking on a plot</span>
<span id="cb145-344"><a href="#cb145-344" aria-hidden="true" tabindex="-1"></a>such as:</span>
<span id="cb145-345"><a href="#cb145-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-346"><a href="#cb145-346" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>points (<span class="in">`geom_point`</span>, for scatter plots, dot plots, etc)</span>
<span id="cb145-347"><a href="#cb145-347" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>lines (<span class="in">`geom_line`</span>, for time series, trend lines, etc)</span>
<span id="cb145-348"><a href="#cb145-348" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>boxplot (<span class="in">`geom_boxplot`</span>, for boxplots)</span>
<span id="cb145-349"><a href="#cb145-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-350"><a href="#cb145-350" aria-hidden="true" tabindex="-1"></a>*A plot must have at least one `geom` but there is no upper limit.* In</span>
<span id="cb145-351"><a href="#cb145-351" aria-hidden="true" tabindex="-1"></a>order to add a <span class="in">`geom`</span> to a plot, the <span class="in">`+`</span> operator is employed. A list of</span>
<span id="cb145-352"><a href="#cb145-352" aria-hidden="true" tabindex="-1"></a>available geometric objects can be obtained by typing <span class="in">`geom_&lt;tab&gt;`</span> in</span>
<span id="cb145-353"><a href="#cb145-353" aria-hidden="true" tabindex="-1"></a>Rstudio. The following command can also be used which will open a Help</span>
<span id="cb145-354"><a href="#cb145-354" aria-hidden="true" tabindex="-1"></a>window.</span>
<span id="cb145-355"><a href="#cb145-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-356"><a href="#cb145-356" aria-hidden="true" tabindex="-1"></a><span class="in">    help.search("geom_", package = "ggplot2")</span></span>
<span id="cb145-357"><a href="#cb145-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-358"><a href="#cb145-358" aria-hidden="true" tabindex="-1"></a>Consider the study guide dataset <span class="in">`rangitikei.txt`</span> (Recreational Use of</span>
<span id="cb145-359"><a href="#cb145-359" aria-hidden="true" tabindex="-1"></a>the Rangitikei river). The first 10 rows of this dataset are shown</span>
<span id="cb145-360"><a href="#cb145-360" aria-hidden="true" tabindex="-1"></a>below:</span>
<span id="cb145-361"><a href="#cb145-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-362"><a href="#cb145-362" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE}</span></span>
<span id="cb145-363"><a href="#cb145-363" aria-hidden="true" tabindex="-1"></a>my.data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(</span>
<span id="cb145-364"><a href="#cb145-364" aria-hidden="true" tabindex="-1"></a>  <span class="st">"https://www.massey.ac.nz/~anhsmith/data/rangitikei.csv"</span>, </span>
<span id="cb145-365"><a href="#cb145-365" aria-hidden="true" tabindex="-1"></a>  <span class="at">header=</span><span class="cn">TRUE</span></span>
<span id="cb145-366"><a href="#cb145-366" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb145-367"><a href="#cb145-367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-368"><a href="#cb145-368" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(my.data, <span class="dv">10</span>)</span>
<span id="cb145-369"><a href="#cb145-369" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb145-370"><a href="#cb145-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-371"><a href="#cb145-371" aria-hidden="true" tabindex="-1"></a>The description of the variables is given below:</span>
<span id="cb145-372"><a href="#cb145-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-373"><a href="#cb145-373" aria-hidden="true" tabindex="-1"></a><span class="in">`loc`</span> - two locations were surveyed, coded 1, 2\</span>
<span id="cb145-374"><a href="#cb145-374" aria-hidden="true" tabindex="-1"></a><span class="in">`time`</span> - time of day, 1 for morning, 2 for afternoon\</span>
<span id="cb145-375"><a href="#cb145-375" aria-hidden="true" tabindex="-1"></a><span class="in">`w.e`</span> - coded 1 for weekend, 2 for weekday\</span>
<span id="cb145-376"><a href="#cb145-376" aria-hidden="true" tabindex="-1"></a><span class="in">`cl`</span>- cloud cover, 1 for <span class="sc">\&gt;</span>50%, 2 for <span class="sc">\&lt;</span>50%\</span>
<span id="cb145-377"><a href="#cb145-377" aria-hidden="true" tabindex="-1"></a><span class="in">`wind`</span>- coded 1 through 4 for increasing wind speed\</span>
<span id="cb145-378"><a href="#cb145-378" aria-hidden="true" tabindex="-1"></a><span class="in">`temp`</span> - temperature, 1, 2 or 3 increasing temp\</span>
<span id="cb145-379"><a href="#cb145-379" aria-hidden="true" tabindex="-1"></a><span class="in">`river`</span>- murkiness of river in 3 increasing categories\</span>
<span id="cb145-380"><a href="#cb145-380" aria-hidden="true" tabindex="-1"></a><span class="in">`people`</span> - number of people at that location and time\</span>
<span id="cb145-381"><a href="#cb145-381" aria-hidden="true" tabindex="-1"></a><span class="in">`vehicle`</span>- number of vehicles at that location at that time\</span>
<span id="cb145-382"><a href="#cb145-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-383"><a href="#cb145-383" aria-hidden="true" tabindex="-1"></a>This dataset is downloaded from the web using the following commands.</span>
<span id="cb145-384"><a href="#cb145-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-387"><a href="#cb145-387" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb145-388"><a href="#cb145-388" aria-hidden="true" tabindex="-1"></a>my.data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(</span>
<span id="cb145-389"><a href="#cb145-389" aria-hidden="true" tabindex="-1"></a>  <span class="st">"https://www.massey.ac.nz/~anhsmith/data/rangitikei.csv"</span>, </span>
<span id="cb145-390"><a href="#cb145-390" aria-hidden="true" tabindex="-1"></a>  <span class="at">header=</span><span class="cn">TRUE</span></span>
<span id="cb145-391"><a href="#cb145-391" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb145-392"><a href="#cb145-392" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb145-393"><a href="#cb145-393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-396"><a href="#cb145-396" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb145-397"><a href="#cb145-397" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> my.data,</span>
<span id="cb145-398"><a href="#cb145-398" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> vehicle, <span class="at">y =</span> people)</span>
<span id="cb145-399"><a href="#cb145-399" aria-hidden="true" tabindex="-1"></a>       ) <span class="sc">+</span></span>
<span id="cb145-400"><a href="#cb145-400" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb145-401"><a href="#cb145-401" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb145-402"><a href="#cb145-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-403"><a href="#cb145-403" aria-hidden="true" tabindex="-1"></a>The <span class="in">`aes`</span> part defines the "aesthetics", which is how columns of the dataframe map to graphical attributes such as x and y position, colour, size, etc. An aesthetic can be either numeric or categorical and an appropriate scale will be used. After this, we add layers of graphics. <span class="in">`geom_point`</span> layer is employed to map x and y and we need not specify all the options for <span class="in">`geom_point`</span>.</span>
<span id="cb145-404"><a href="#cb145-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-405"><a href="#cb145-405" aria-hidden="true" tabindex="-1"></a>The <span class="in">`aes()`</span> can be specified within the <span class="in">`ggplot`</span> function or as its own separate function. I prefer this format. </span>
<span id="cb145-406"><a href="#cb145-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-409"><a href="#cb145-409" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb145-410"><a href="#cb145-410" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(my.data) <span class="sc">+</span></span>
<span id="cb145-411"><a href="#cb145-411" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> vehicle, <span class="at">y =</span> people) <span class="sc">+</span></span>
<span id="cb145-412"><a href="#cb145-412" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb145-413"><a href="#cb145-413" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb145-414"><a href="#cb145-414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-415"><a href="#cb145-415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-416"><a href="#cb145-416" aria-hidden="true" tabindex="-1"></a>We can add a title using *labs()* or *ggtitle()* functions. Try-</span>
<span id="cb145-417"><a href="#cb145-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-418"><a href="#cb145-418" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.show="hide"}</span></span>
<span id="cb145-419"><a href="#cb145-419" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(my.data) <span class="sc">+</span></span>
<span id="cb145-420"><a href="#cb145-420" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> vehicle, <span class="at">y =</span> people) <span class="sc">+</span></span>
<span id="cb145-421"><a href="#cb145-421" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb145-422"><a href="#cb145-422" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"No. of people vs No. of vehicles"</span>)</span>
<span id="cb145-423"><a href="#cb145-423" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb145-424"><a href="#cb145-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-425"><a href="#cb145-425" aria-hidden="true" tabindex="-1"></a>or</span>
<span id="cb145-426"><a href="#cb145-426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-427"><a href="#cb145-427" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.show="hide"}</span></span>
<span id="cb145-428"><a href="#cb145-428" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(my.data)<span class="sc">+</span></span>
<span id="cb145-429"><a href="#cb145-429" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> vehicle, <span class="at">y =</span> people) <span class="sc">+</span></span>
<span id="cb145-430"><a href="#cb145-430" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb145-431"><a href="#cb145-431" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"No. of people vs No. of vehicles"</span>)</span>
<span id="cb145-432"><a href="#cb145-432" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb145-433"><a href="#cb145-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-434"><a href="#cb145-434" aria-hidden="true" tabindex="-1"></a>Note that *labs()* allows captions and subtitles.</span>
<span id="cb145-435"><a href="#cb145-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-436"><a href="#cb145-436" aria-hidden="true" tabindex="-1"></a><span class="in">`geom_smooth`</span> is additionally used to show trends.</span>
<span id="cb145-437"><a href="#cb145-437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-440"><a href="#cb145-440" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb145-441"><a href="#cb145-441" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(my.data) <span class="sc">+</span></span>
<span id="cb145-442"><a href="#cb145-442" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> vehicle, <span class="at">y =</span> people) <span class="sc">+</span></span>
<span id="cb145-443"><a href="#cb145-443" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb145-444"><a href="#cb145-444" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>()</span>
<span id="cb145-445"><a href="#cb145-445" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb145-446"><a href="#cb145-446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-447"><a href="#cb145-447" aria-hidden="true" tabindex="-1"></a>Similar to <span class="in">`geom_smooth`</span>, a variety of <span class="in">`geoms`</span> are available.</span>
<span id="cb145-448"><a href="#cb145-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-451"><a href="#cb145-451" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb145-452"><a href="#cb145-452" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(my.data) <span class="sc">+</span> </span>
<span id="cb145-453"><a href="#cb145-453" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(wind), <span class="at">y =</span> people) <span class="sc">+</span></span>
<span id="cb145-454"><a href="#cb145-454" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span>
<span id="cb145-455"><a href="#cb145-455" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb145-456"><a href="#cb145-456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-457"><a href="#cb145-457" aria-hidden="true" tabindex="-1"></a>Each <span class="in">`geom`</span> accepts a particular set of mappings;for example</span>
<span id="cb145-458"><a href="#cb145-458" aria-hidden="true" tabindex="-1"></a><span class="in">`geom_text()`</span> accepts a <span class="in">`labels`</span> mapping. Try-</span>
<span id="cb145-459"><a href="#cb145-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-460"><a href="#cb145-460" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.show="hide"}</span></span>
<span id="cb145-461"><a href="#cb145-461" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(my.data) <span class="sc">+</span></span>
<span id="cb145-462"><a href="#cb145-462" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> vehicle, <span class="at">y =</span> people) <span class="sc">+</span></span>
<span id="cb145-463"><a href="#cb145-463" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb145-464"><a href="#cb145-464" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> w.e), </span>
<span id="cb145-465"><a href="#cb145-465" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">5</span>)</span>
<span id="cb145-466"><a href="#cb145-466" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb145-467"><a href="#cb145-467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-468"><a href="#cb145-468" aria-hidden="true" tabindex="-1"></a>The faceting option allows a collection of small plots with the same</span>
<span id="cb145-469"><a href="#cb145-469" aria-hidden="true" tabindex="-1"></a>scales. Try-</span>
<span id="cb145-470"><a href="#cb145-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-473"><a href="#cb145-473" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb145-474"><a href="#cb145-474" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(my.data) <span class="sc">+</span></span>
<span id="cb145-475"><a href="#cb145-475" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x=</span>vehicle, <span class="at">y=</span>people) <span class="sc">+</span> </span>
<span id="cb145-476"><a href="#cb145-476" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb145-477"><a href="#cb145-477" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> river) </span>
<span id="cb145-478"><a href="#cb145-478" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb145-479"><a href="#cb145-479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-480"><a href="#cb145-480" aria-hidden="true" tabindex="-1"></a>Faceting is the <span class="in">`ggplot2`</span> option to create separate graphs for subsets</span>
<span id="cb145-481"><a href="#cb145-481" aria-hidden="true" tabindex="-1"></a>of data. <span class="in">`ggplot2`</span> offers two functions for creating small multiples:</span>
<span id="cb145-482"><a href="#cb145-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-483"><a href="#cb145-483" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span><span class="in">`facet_wrap()`</span>: define subsets as the levels of a single grouping variable</span>
<span id="cb145-484"><a href="#cb145-484" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span><span class="in">`facet_grid()`</span>: define subsets as the crossing of two grouping variables</span>
<span id="cb145-485"><a href="#cb145-485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-486"><a href="#cb145-486" aria-hidden="true" tabindex="-1"></a>The following arguments are common to most scales in <span class="in">`ggplot2`</span>:</span>
<span id="cb145-487"><a href="#cb145-487" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-488"><a href="#cb145-488" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**name:** the first argument gives the axis or legend title</span>
<span id="cb145-489"><a href="#cb145-489" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**limits:** the minimum and maximum of the scale</span>
<span id="cb145-490"><a href="#cb145-490" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**breaks:** the points along the scale where labels should appear</span>
<span id="cb145-491"><a href="#cb145-491" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**labels:** the labels that appear at each break</span>
<span id="cb145-492"><a href="#cb145-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-493"><a href="#cb145-493" aria-hidden="true" tabindex="-1"></a>Specific scale functions may have additional arguments. Some of the</span>
<span id="cb145-494"><a href="#cb145-494" aria-hidden="true" tabindex="-1"></a>available Scales are:</span>
<span id="cb145-495"><a href="#cb145-495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-496"><a href="#cb145-496" aria-hidden="true" tabindex="-1"></a>| **Scale**         | **Examples**              |</span>
<span id="cb145-497"><a href="#cb145-497" aria-hidden="true" tabindex="-1"></a>|-------------------|---------------------------|</span>
<span id="cb145-498"><a href="#cb145-498" aria-hidden="true" tabindex="-1"></a>| <span class="in">`scale_color_`</span>    | <span class="in">`scale_color_discrete`</span>    |</span>
<span id="cb145-499"><a href="#cb145-499" aria-hidden="true" tabindex="-1"></a>| <span class="in">`scale_fill_`</span>     | <span class="in">`scale_fill_continuous`</span>   |</span>
<span id="cb145-500"><a href="#cb145-500" aria-hidden="true" tabindex="-1"></a>| <span class="in">`scale_size_`</span>     | <span class="in">`scale_size_manual`</span>       |</span>
<span id="cb145-501"><a href="#cb145-501" aria-hidden="true" tabindex="-1"></a>|                   | <span class="in">`scale_size_discrete`</span>     |</span>
<span id="cb145-502"><a href="#cb145-502" aria-hidden="true" tabindex="-1"></a>|                   |                           |</span>
<span id="cb145-503"><a href="#cb145-503" aria-hidden="true" tabindex="-1"></a>| <span class="in">`scale_shape_`</span>    | <span class="in">`scale_shape_discrete`</span>    |</span>
<span id="cb145-504"><a href="#cb145-504" aria-hidden="true" tabindex="-1"></a>|                   | <span class="in">`scale_shape_manual`</span>      |</span>
<span id="cb145-505"><a href="#cb145-505" aria-hidden="true" tabindex="-1"></a>| <span class="in">`scale_linetype_`</span> | <span class="in">`scale_linetype_discrete`</span> |</span>
<span id="cb145-506"><a href="#cb145-506" aria-hidden="true" tabindex="-1"></a>|                   |                           |</span>
<span id="cb145-507"><a href="#cb145-507" aria-hidden="true" tabindex="-1"></a>| <span class="in">`scale_x_`</span>        | <span class="in">`scale_x_continuous`</span>      |</span>
<span id="cb145-508"><a href="#cb145-508" aria-hidden="true" tabindex="-1"></a>|                   | <span class="in">`scale_x_log`</span>             |</span>
<span id="cb145-509"><a href="#cb145-509" aria-hidden="true" tabindex="-1"></a>|                   | <span class="in">`scale_x_date`</span>            |</span>
<span id="cb145-510"><a href="#cb145-510" aria-hidden="true" tabindex="-1"></a>| <span class="in">`scale_y_`</span>        | <span class="in">`scale_y_reverse`</span>         |</span>
<span id="cb145-511"><a href="#cb145-511" aria-hidden="true" tabindex="-1"></a>|                   | <span class="in">`scale_y_discrete`</span>        |</span>
<span id="cb145-512"><a href="#cb145-512" aria-hidden="true" tabindex="-1"></a>|                   | <span class="in">`scale_y_datetime`</span>        |</span>
<span id="cb145-513"><a href="#cb145-513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-514"><a href="#cb145-514" aria-hidden="true" tabindex="-1"></a>In RStudio, we can type <span class="in">`scale_`</span> followed by TAB to get the whole list</span>
<span id="cb145-515"><a href="#cb145-515" aria-hidden="true" tabindex="-1"></a>of available scales.</span>
<span id="cb145-516"><a href="#cb145-516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-517"><a href="#cb145-517" aria-hidden="true" tabindex="-1"></a>Try-</span>
<span id="cb145-518"><a href="#cb145-518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-521"><a href="#cb145-521" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb145-522"><a href="#cb145-522" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(my.data) <span class="sc">+</span> </span>
<span id="cb145-523"><a href="#cb145-523" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> vehicle, <span class="at">y =</span> people, <span class="at">color =</span> <span class="fu">factor</span>(temp)) <span class="sc">+</span> </span>
<span id="cb145-524"><a href="#cb145-524" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb145-525"><a href="#cb145-525" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">name =</span> <span class="st">"No. of Vehicles"</span>) <span class="sc">+</span> </span>
<span id="cb145-526"><a href="#cb145-526" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">name =</span> <span class="st">"No. of people"</span>) <span class="sc">+</span> </span>
<span id="cb145-527"><a href="#cb145-527" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_discrete</span>(<span class="at">name =</span> <span class="st">"Temperature"</span>)</span>
<span id="cb145-528"><a href="#cb145-528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-529"><a href="#cb145-529" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb145-530"><a href="#cb145-530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-531"><a href="#cb145-531" aria-hidden="true" tabindex="-1"></a>The other coding option is shown below:</span>
<span id="cb145-532"><a href="#cb145-532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-533"><a href="#cb145-533" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.show = 'hide'}</span></span>
<span id="cb145-534"><a href="#cb145-534" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(my.data) <span class="sc">+</span></span>
<span id="cb145-535"><a href="#cb145-535" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> vehicle, <span class="at">y =</span> people, <span class="at">color =</span> <span class="fu">factor</span>(temp)) <span class="sc">+</span> </span>
<span id="cb145-536"><a href="#cb145-536" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb145-537"><a href="#cb145-537" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"No. of Vehicles"</span>) <span class="sc">+</span> </span>
<span id="cb145-538"><a href="#cb145-538" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"No. of people"</span>) <span class="sc">+</span> </span>
<span id="cb145-539"><a href="#cb145-539" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">colour=</span><span class="st">"Temperature"</span>) </span>
<span id="cb145-540"><a href="#cb145-540" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb145-541"><a href="#cb145-541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-542"><a href="#cb145-542" aria-hidden="true" tabindex="-1"></a>Note that a desired graph can be obtained in more than one way.</span>
<span id="cb145-543"><a href="#cb145-543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-544"><a href="#cb145-544" aria-hidden="true" tabindex="-1"></a>The <span class="in">`ggplot2`</span> theme system handles plot elements (not data based) such</span>
<span id="cb145-545"><a href="#cb145-545" aria-hidden="true" tabindex="-1"></a>as</span>
<span id="cb145-546"><a href="#cb145-546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-547"><a href="#cb145-547" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Axis labels</span>
<span id="cb145-548"><a href="#cb145-548" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Plot background</span>
<span id="cb145-549"><a href="#cb145-549" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Facet label background</span>
<span id="cb145-550"><a href="#cb145-550" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Legend appearance</span>
<span id="cb145-551"><a href="#cb145-551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-552"><a href="#cb145-552" aria-hidden="true" tabindex="-1"></a>Built-in themes include:</span>
<span id="cb145-553"><a href="#cb145-553" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-554"><a href="#cb145-554" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`theme_gray()`</span> (default)</span>
<span id="cb145-555"><a href="#cb145-555" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`theme_bw()`</span></span>
<span id="cb145-556"><a href="#cb145-556" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`theme_minimal()`</span></span>
<span id="cb145-557"><a href="#cb145-557" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`theme_classic()`</span></span>
<span id="cb145-558"><a href="#cb145-558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-561"><a href="#cb145-561" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb145-562"><a href="#cb145-562" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(my.data) <span class="sc">+</span> </span>
<span id="cb145-563"><a href="#cb145-563" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> vehicle, <span class="at">y =</span> people, <span class="at">color =</span> <span class="fu">factor</span>(temp)) <span class="sc">+</span> </span>
<span id="cb145-564"><a href="#cb145-564" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb145-565"><a href="#cb145-565" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb145-566"><a href="#cb145-566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-567"><a href="#cb145-567" aria-hidden="true" tabindex="-1"></a>Note that the graph is assigned an object name <span class="in">`p1`</span> and nothing will be</span>
<span id="cb145-568"><a href="#cb145-568" aria-hidden="true" tabindex="-1"></a>printed unless we then print the object <span class="in">`p1`</span>.</span>
<span id="cb145-569"><a href="#cb145-569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-572"><a href="#cb145-572" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb145-573"><a href="#cb145-573" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(my.data) <span class="sc">+</span> </span>
<span id="cb145-574"><a href="#cb145-574" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> vehicle, <span class="at">y =</span> people, <span class="at">color =</span> <span class="fu">factor</span>(temp)) <span class="sc">+</span> </span>
<span id="cb145-575"><a href="#cb145-575" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb145-576"><a href="#cb145-576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-577"><a href="#cb145-577" aria-hidden="true" tabindex="-1"></a>p1</span>
<span id="cb145-578"><a href="#cb145-578" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb145-579"><a href="#cb145-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-580"><a href="#cb145-580" aria-hidden="true" tabindex="-1"></a>Try-</span>
<span id="cb145-581"><a href="#cb145-581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-584"><a href="#cb145-584" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb145-585"><a href="#cb145-585" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> <span class="fu">theme_light</span>()</span>
<span id="cb145-586"><a href="#cb145-586" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb145-587"><a href="#cb145-587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-590"><a href="#cb145-590" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb145-591"><a href="#cb145-591" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> <span class="fu">theme_bw</span>()</span>
<span id="cb145-592"><a href="#cb145-592" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb145-593"><a href="#cb145-593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-594"><a href="#cb145-594" aria-hidden="true" tabindex="-1"></a>Specific theme elements can be overridden using <span class="in">`theme()`</span>. For example:</span>
<span id="cb145-595"><a href="#cb145-595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-598"><a href="#cb145-598" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb145-599"><a href="#cb145-599" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb145-600"><a href="#cb145-600" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"red"</span>))</span>
<span id="cb145-601"><a href="#cb145-601" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb145-602"><a href="#cb145-602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-603"><a href="#cb145-603" aria-hidden="true" tabindex="-1"></a>All theme options can be seen with <span class="in">`?theme`</span>.</span>
<span id="cb145-604"><a href="#cb145-604" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-605"><a href="#cb145-605" aria-hidden="true" tabindex="-1"></a>To specify a theme for a whole document, use</span>
<span id="cb145-606"><a href="#cb145-606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-609"><a href="#cb145-609" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb145-610"><a href="#cb145-610" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_minimal</span>())</span>
<span id="cb145-611"><a href="#cb145-611" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb145-612"><a href="#cb145-612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-613"><a href="#cb145-613" aria-hidden="true" tabindex="-1"></a>*Minimal graphing* can be done using the <span class="in">`qplot`</span> option that will</span>
<span id="cb145-614"><a href="#cb145-614" aria-hidden="true" tabindex="-1"></a>produce a few standard formatted graphs quickly.</span>
<span id="cb145-615"><a href="#cb145-615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-618"><a href="#cb145-618" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb145-619"><a href="#cb145-619" aria-hidden="true" tabindex="-1"></a><span class="fu">qplot</span>(people, vehicle, <span class="at">data =</span> my.data, <span class="at">colour =</span> river)</span>
<span id="cb145-620"><a href="#cb145-620" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb145-621"><a href="#cb145-621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-622"><a href="#cb145-622" aria-hidden="true" tabindex="-1"></a>Try-</span>
<span id="cb145-623"><a href="#cb145-623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-624"><a href="#cb145-624" aria-hidden="true" tabindex="-1"></a><span class="in">`qplot(people, data = my.data)`</span></span>
<span id="cb145-625"><a href="#cb145-625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-626"><a href="#cb145-626" aria-hidden="true" tabindex="-1"></a><span class="in">`qplot(people, fill=factor(river), data=my.data)`</span></span>
<span id="cb145-627"><a href="#cb145-627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-628"><a href="#cb145-628" aria-hidden="true" tabindex="-1"></a><span class="in">`qplot(people, data = my.data, geom = "dotplot")`</span></span>
<span id="cb145-629"><a href="#cb145-629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-630"><a href="#cb145-630" aria-hidden="true" tabindex="-1"></a><span class="in">`qplot(factor(river), people, data = my.data, geom = "boxplot")`</span></span>
<span id="cb145-631"><a href="#cb145-631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-632"><a href="#cb145-632" aria-hidden="true" tabindex="-1"></a>A cheat sheet for <span class="in">`ggplot2`</span> is available at</span>
<span id="cb145-633"><a href="#cb145-633" aria-hidden="true" tabindex="-1"></a><span class="ot">&lt;https://www.rstudio.com/resources/cheatsheets/&gt;</span> (optional to download).</span>
<span id="cb145-634"><a href="#cb145-634" aria-hidden="true" tabindex="-1"></a>There are many other packages which incorporate <span class="in">`ggplot2`</span> based graphs or</span>
<span id="cb145-635"><a href="#cb145-635" aria-hidden="true" tabindex="-1"></a>dependent on it.</span>
<span id="cb145-636"><a href="#cb145-636" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-637"><a href="#cb145-637" aria-hidden="true" tabindex="-1"></a>The library *patchwork* allows complex composition arbitrary plots,</span>
<span id="cb145-638"><a href="#cb145-638" aria-hidden="true" tabindex="-1"></a>which are not produced using the faceting option. Try</span>
<span id="cb145-639"><a href="#cb145-639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-642"><a href="#cb145-642" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb145-643"><a href="#cb145-643" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb145-644"><a href="#cb145-644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-645"><a href="#cb145-645" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">qplot</span>(people, <span class="at">data =</span> my.data, <span class="at">geom =</span> <span class="st">"dotplot"</span>)</span>
<span id="cb145-646"><a href="#cb145-646" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">qplot</span>(people, <span class="at">data =</span> my.data, <span class="at">geom =</span> <span class="st">"boxplot"</span>)</span>
<span id="cb145-647"><a href="#cb145-647" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(my.data, <span class="fu">aes</span>(<span class="at">x =</span> vehicle, <span class="at">y =</span> people)) <span class="sc">+</span> <span class="fu">geom_point</span>()</span>
<span id="cb145-648"><a href="#cb145-648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-649"><a href="#cb145-649" aria-hidden="true" tabindex="-1"></a>(p1 <span class="sc">+</span> p2) <span class="sc">/</span> p3 <span class="sc">+</span> </span>
<span id="cb145-650"><a href="#cb145-650" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="st">"My title"</span>, <span class="at">caption =</span> <span class="st">"My caption"</span>)</span>
<span id="cb145-651"><a href="#cb145-651" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb145-652"><a href="#cb145-652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-653"><a href="#cb145-653" aria-hidden="true" tabindex="-1"></a><span class="fu">## `ggplot` builder {.unnumbered}</span></span>
<span id="cb145-654"><a href="#cb145-654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-655"><a href="#cb145-655" aria-hidden="true" tabindex="-1"></a>A nice <span class="in">`R`</span> package, known as <span class="in">`esquisse`</span> is available to build few simple <span class="in">`ggplot`</span> graphics interactively. This may help in the early stages of learning to use <span class="in">`ggplot`</span> graphing.</span>
<span id="cb145-656"><a href="#cb145-656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-657"><a href="#cb145-657" aria-hidden="true" tabindex="-1"></a>If this package is not installed, install it first &amp; then try.</span>
<span id="cb145-658"><a href="#cb145-658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-659"><a href="#cb145-659" aria-hidden="true" tabindex="-1"></a><span class="in">    library(esquisse)</span></span>
<span id="cb145-660"><a href="#cb145-660" aria-hidden="true" tabindex="-1"></a><span class="in">    options("esquisse.display.mode" = "browser")</span></span>
<span id="cb145-661"><a href="#cb145-661" aria-hidden="true" tabindex="-1"></a><span class="in">    esquisse::esquisser(data = iris)</span></span>
<span id="cb145-662"><a href="#cb145-662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-663"><a href="#cb145-663" aria-hidden="true" tabindex="-1"></a>You can also load the desired dataset within <span class="in">`R`</span> studio and select the dataset.</span>
<span id="cb145-664"><a href="#cb145-664" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-665"><a href="#cb145-665" aria-hidden="true" tabindex="-1"></a>The other option is to load a dataset from the course data web folder and then launch <span class="in">`esquisse`</span>. Try-</span>
<span id="cb145-666"><a href="#cb145-666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-667"><a href="#cb145-667" aria-hidden="true" tabindex="-1"></a><span class="in">    url1 &lt;- "https://www.massey.ac.nz/~anhsmith/data/rangitikei.RData"</span></span>
<span id="cb145-668"><a href="#cb145-668" aria-hidden="true" tabindex="-1"></a><span class="in">    download.file(url = url1, destfile = "rangitikei.RData")</span></span>
<span id="cb145-669"><a href="#cb145-669" aria-hidden="true" tabindex="-1"></a><span class="in">    load("rangitikei.RData")</span></span>
<span id="cb145-670"><a href="#cb145-670" aria-hidden="true" tabindex="-1"></a><span class="in">    esquisse::esquisser(data = rangitikei, viewer = "browser")</span></span>
<span id="cb145-671"><a href="#cb145-671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-672"><a href="#cb145-672" aria-hidden="true" tabindex="-1"></a>You can also download the associated R codes or save the graph within the <span class="in">`esquisse`</span> web app.</span>
<span id="cb145-673"><a href="#cb145-673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-674"><a href="#cb145-674" aria-hidden="true" tabindex="-1"></a><span class="fu"># `tidyverse` and related packages {.unnumbered}</span></span>
<span id="cb145-675"><a href="#cb145-675" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-676"><a href="#cb145-676" aria-hidden="true" tabindex="-1"></a>In the recent years, <span class="in">`tidyverse`</span> suite of packages, which includes</span>
<span id="cb145-677"><a href="#cb145-677" aria-hidden="true" tabindex="-1"></a><span class="in">`ggplot2`</span> has become the popular tool for data handling and plotting. In this section, a brief intro to the data management packages such as <span class="in">`dplyr`</span> is given.</span>
<span id="cb145-678"><a href="#cb145-678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-679"><a href="#cb145-679" aria-hidden="true" tabindex="-1"></a>For detailed coverage of the <span class="in">`tidyverse`</span> system, go to</span>
<span id="cb145-680"><a href="#cb145-680" aria-hidden="true" tabindex="-1"></a><span class="ot">&lt;https://www.tidyverse.org/&gt;</span>.</span>
<span id="cb145-681"><a href="#cb145-681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-682"><a href="#cb145-682" aria-hidden="true" tabindex="-1"></a><span class="fu">## `dplyr` {.unnumbered}</span></span>
<span id="cb145-683"><a href="#cb145-683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-684"><a href="#cb145-684" aria-hidden="true" tabindex="-1"></a>The following six functions of <span class="in">`dplyr`</span> are very useful for data</span>
<span id="cb145-685"><a href="#cb145-685" aria-hidden="true" tabindex="-1"></a>wrangling :</span>
<span id="cb145-686"><a href="#cb145-686" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-687"><a href="#cb145-687" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>For selecting columns, use <span class="in">`select()`</span></span>
<span id="cb145-688"><a href="#cb145-688" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>For subsetting data, use <span class="in">`filter()`</span></span>
<span id="cb145-689"><a href="#cb145-689" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>For re-ordering (e.g. ascending/descending), use <span class="in">`arrange()`</span></span>
<span id="cb145-690"><a href="#cb145-690" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>For augmenting new calculated columns, use <span class="in">`mutate()`</span></span>
<span id="cb145-691"><a href="#cb145-691" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>For computing summary measures, use <span class="in">`summarise()`</span></span>
<span id="cb145-692"><a href="#cb145-692" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>For group-wise computations (e.g. summary measures), use</span>
<span id="cb145-693"><a href="#cb145-693" aria-hidden="true" tabindex="-1"></a>    <span class="in">`group_by()`</span></span>
<span id="cb145-694"><a href="#cb145-694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-695"><a href="#cb145-695" aria-hidden="true" tabindex="-1"></a>There are many other functions such as <span class="in">`transmute()`</span> which will add newly calculated columns to the existing data frame but drop all unused columns. The <span class="in">`across()`</span> function  extends <span class="in">`group_by()`</span> and <span class="in">`summarise()`</span> functions for multiple column and function summaries.  For example, you like to report rounded data in a table, which calls for an operation across both rows and columns.</span>
<span id="cb145-696"><a href="#cb145-696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-697"><a href="#cb145-697" aria-hidden="true" tabindex="-1"></a><span class="fu">## Piping</span></span>
<span id="cb145-698"><a href="#cb145-698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-699"><a href="#cb145-699" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip}</span>
<span id="cb145-700"><a href="#cb145-700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-701"><a href="#cb145-701" aria-hidden="true" tabindex="-1"></a>**The piping operation is a fundamental aspect of computer programming. The semantics of pipes is taking the output from the left-hand side and passing it as input to the right-hand side.**</span>
<span id="cb145-702"><a href="#cb145-702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-703"><a href="#cb145-703" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb145-704"><a href="#cb145-704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-705"><a href="#cb145-705" aria-hidden="true" tabindex="-1"></a>The <span class="in">`R`</span> package <span class="in">`magrittr`</span> introduced the pipe operator <span class="in">`%&gt;%`</span> and can be pronounced as "then". In RStudio windows/Linux versions, press <span class="in">`Ctrl+Shift+M`</span> to insert the pipe operator. On a Mac, use <span class="in">`Cmd+Shift+M`</span>. </span>
<span id="cb145-706"><a href="#cb145-706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-707"><a href="#cb145-707" aria-hidden="true" tabindex="-1"></a><span class="in">`R`</span> also has its own pipe, <span class="in">`|&gt;`</span>, which is an alternative to <span class="in">`%&gt;%`</span>. I tend to use <span class="in">`|&gt;`</span>. If you want to change the pipe inserted automatically with <span class="in">`Ctrl+Shift+M`</span>, find on the menu **Tools &gt; Global Options**, then click on **Code** and check the box that says "**Use Native Pipe Operator**". </span>
<span id="cb145-708"><a href="#cb145-708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-709"><a href="#cb145-709" aria-hidden="true" tabindex="-1"></a>We often pipe the <span class="in">`dplyr`</span> functions, and the advantage is that we show the flow of data manipulation and subsequent graphing. This approach also helps to save memory, and dataframes are not unnecessarily created, a necessity for a big data framework.</span>
<span id="cb145-710"><a href="#cb145-710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-711"><a href="#cb145-711" aria-hidden="true" tabindex="-1"></a>Try the following examples after loading the <span class="in">`rangitikei`</span> dataset.</span>
<span id="cb145-712"><a href="#cb145-712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-713"><a href="#cb145-713" aria-hidden="true" tabindex="-1"></a><span class="in">`select()`</span></span>
<span id="cb145-714"><a href="#cb145-714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-717"><a href="#cb145-717" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb145-718"><a href="#cb145-718" aria-hidden="true" tabindex="-1"></a>my.data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"https://www.massey.ac.nz/~anhsmith/data/rangitikei.csv"</span>, <span class="at">header=</span><span class="cn">TRUE</span>)</span>
<span id="cb145-719"><a href="#cb145-719" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-720"><a href="#cb145-720" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(my.data)</span>
<span id="cb145-721"><a href="#cb145-721" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb145-722"><a href="#cb145-722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-725"><a href="#cb145-725" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb145-726"><a href="#cb145-726" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb145-727"><a href="#cb145-727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-728"><a href="#cb145-728" aria-hidden="true" tabindex="-1"></a>new.data <span class="ot">&lt;-</span> my.data <span class="sc">|&gt;</span> </span>
<span id="cb145-729"><a href="#cb145-729" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(people, vehicle)</span>
<span id="cb145-730"><a href="#cb145-730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-731"><a href="#cb145-731" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(new.data)</span>
<span id="cb145-732"><a href="#cb145-732" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb145-733"><a href="#cb145-733" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-736"><a href="#cb145-736" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb145-737"><a href="#cb145-737" aria-hidden="true" tabindex="-1"></a>my.data <span class="sc">|&gt;</span> </span>
<span id="cb145-738"><a href="#cb145-738" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(people, vehicle) <span class="sc">|&gt;</span> </span>
<span id="cb145-739"><a href="#cb145-739" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb145-740"><a href="#cb145-740" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x=</span>people, <span class="at">y=</span>vehicle) <span class="sc">+</span></span>
<span id="cb145-741"><a href="#cb145-741" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb145-742"><a href="#cb145-742" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb145-743"><a href="#cb145-743" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-744"><a href="#cb145-744" aria-hidden="true" tabindex="-1"></a>We select two columns and create a scatter plot with the above commands.</span>
<span id="cb145-745"><a href="#cb145-745" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-746"><a href="#cb145-746" aria-hidden="true" tabindex="-1"></a><span class="in">`filter()`</span></span>
<span id="cb145-747"><a href="#cb145-747" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-750"><a href="#cb145-750" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb145-751"><a href="#cb145-751" aria-hidden="true" tabindex="-1"></a>my.data <span class="sc">|&gt;</span> </span>
<span id="cb145-752"><a href="#cb145-752" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(wind<span class="sc">==</span><span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb145-753"><a href="#cb145-753" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(people, vehicle) <span class="sc">|&gt;</span> </span>
<span id="cb145-754"><a href="#cb145-754" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb145-755"><a href="#cb145-755" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x=</span>people, <span class="at">y=</span>vehicle) <span class="sc">+</span></span>
<span id="cb145-756"><a href="#cb145-756" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb145-757"><a href="#cb145-757" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb145-758"><a href="#cb145-758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-759"><a href="#cb145-759" aria-hidden="true" tabindex="-1"></a>The above commands filter the data for the low wind days and plots</span>
<span id="cb145-760"><a href="#cb145-760" aria-hidden="true" tabindex="-1"></a>vehicle against people.</span>
<span id="cb145-761"><a href="#cb145-761" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-762"><a href="#cb145-762" aria-hidden="true" tabindex="-1"></a><span class="in">`arrange()`</span></span>
<span id="cb145-763"><a href="#cb145-763" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-766"><a href="#cb145-766" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb145-767"><a href="#cb145-767" aria-hidden="true" tabindex="-1"></a>my.data <span class="sc">|&gt;</span> </span>
<span id="cb145-768"><a href="#cb145-768" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(wind<span class="sc">==</span><span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb145-769"><a href="#cb145-769" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(w.e) <span class="sc">|&gt;</span> </span>
<span id="cb145-770"><a href="#cb145-770" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(w.e, people, vehicle)</span>
<span id="cb145-771"><a href="#cb145-771" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb145-772"><a href="#cb145-772" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-773"><a href="#cb145-773" aria-hidden="true" tabindex="-1"></a><span class="in">`mutate()`</span></span>
<span id="cb145-774"><a href="#cb145-774" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-775"><a href="#cb145-775" aria-hidden="true" tabindex="-1"></a>Assume that a \$10 levy is collected for each vehicle. We can create</span>
<span id="cb145-776"><a href="#cb145-776" aria-hidden="true" tabindex="-1"></a>this new <span class="in">`levy`</span> column as follows.</span>
<span id="cb145-777"><a href="#cb145-777" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-780"><a href="#cb145-780" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb145-781"><a href="#cb145-781" aria-hidden="true" tabindex="-1"></a>my.data <span class="sc">|&gt;</span> </span>
<span id="cb145-782"><a href="#cb145-782" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">levy =</span> vehicle<span class="sc">*</span><span class="dv">10</span>) <span class="sc">|&gt;</span> </span>
<span id="cb145-783"><a href="#cb145-783" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(people, levy) <span class="sc">|&gt;</span> </span>
<span id="cb145-784"><a href="#cb145-784" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb145-785"><a href="#cb145-785" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> people, <span class="at">y=</span>levy) <span class="sc">+</span></span>
<span id="cb145-786"><a href="#cb145-786" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb145-787"><a href="#cb145-787" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb145-788"><a href="#cb145-788" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-789"><a href="#cb145-789" aria-hidden="true" tabindex="-1"></a>Note that the pipe operation was used to create a scatter plot using the</span>
<span id="cb145-790"><a href="#cb145-790" aria-hidden="true" tabindex="-1"></a>newly created column.</span>
<span id="cb145-791"><a href="#cb145-791" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-792"><a href="#cb145-792" aria-hidden="true" tabindex="-1"></a><span class="in">`summarise()`</span></span>
<span id="cb145-793"><a href="#cb145-793" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-796"><a href="#cb145-796" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb145-797"><a href="#cb145-797" aria-hidden="true" tabindex="-1"></a>my.data <span class="sc">|&gt;</span> </span>
<span id="cb145-798"><a href="#cb145-798" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total =</span> <span class="fu">n</span>(), </span>
<span id="cb145-799"><a href="#cb145-799" aria-hidden="true" tabindex="-1"></a>            <span class="at">avg =</span> <span class="fu">mean</span>(people)</span>
<span id="cb145-800"><a href="#cb145-800" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb145-801"><a href="#cb145-801" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb145-802"><a href="#cb145-802" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-803"><a href="#cb145-803" aria-hidden="true" tabindex="-1"></a>We obtain the selected summary measures namely the total and the mean</span>
<span id="cb145-804"><a href="#cb145-804" aria-hidden="true" tabindex="-1"></a>number of people. Try-</span>
<span id="cb145-805"><a href="#cb145-805" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-808"><a href="#cb145-808" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb145-809"><a href="#cb145-809" aria-hidden="true" tabindex="-1"></a>my.data <span class="sc">|&gt;</span> </span>
<span id="cb145-810"><a href="#cb145-810" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(wind <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb145-811"><a href="#cb145-811" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total =</span> <span class="fu">n</span>(), </span>
<span id="cb145-812"><a href="#cb145-812" aria-hidden="true" tabindex="-1"></a>            <span class="at">avg =</span> <span class="fu">mean</span>(people)</span>
<span id="cb145-813"><a href="#cb145-813" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb145-814"><a href="#cb145-814" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb145-815"><a href="#cb145-815" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-816"><a href="#cb145-816" aria-hidden="true" tabindex="-1"></a><span class="in">`group_by()`</span></span>
<span id="cb145-817"><a href="#cb145-817" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-818"><a href="#cb145-818" aria-hidden="true" tabindex="-1"></a>We obtain the wind group-wise summaries below:</span>
<span id="cb145-819"><a href="#cb145-819" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-822"><a href="#cb145-822" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb145-823"><a href="#cb145-823" aria-hidden="true" tabindex="-1"></a>my.data <span class="sc">|&gt;</span> </span>
<span id="cb145-824"><a href="#cb145-824" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(wind) <span class="sc">|&gt;</span> </span>
<span id="cb145-825"><a href="#cb145-825" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total=</span><span class="fu">n</span>(), </span>
<span id="cb145-826"><a href="#cb145-826" aria-hidden="true" tabindex="-1"></a>            <span class="at">avg=</span><span class="fu">mean</span>(people))</span>
<span id="cb145-827"><a href="#cb145-827" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb145-828"><a href="#cb145-828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-829"><a href="#cb145-829" aria-hidden="true" tabindex="-1"></a>There are many more commands such as the <span class="in">`transmute`</span> function which</span>
<span id="cb145-830"><a href="#cb145-830" aria-hidden="true" tabindex="-1"></a>conserves the only the needed columns. Try</span>
<span id="cb145-831"><a href="#cb145-831" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-834"><a href="#cb145-834" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb145-835"><a href="#cb145-835" aria-hidden="true" tabindex="-1"></a>my.data <span class="sc">|&gt;</span> </span>
<span id="cb145-836"><a href="#cb145-836" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(wind, w.e) <span class="sc">|&gt;</span> </span>
<span id="cb145-837"><a href="#cb145-837" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(<span class="at">total=</span><span class="fu">n</span>(), </span>
<span id="cb145-838"><a href="#cb145-838" aria-hidden="true" tabindex="-1"></a>            <span class="at">avg=</span><span class="fu">mean</span>(people))</span>
<span id="cb145-839"><a href="#cb145-839" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb145-840"><a href="#cb145-840" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-841"><a href="#cb145-841" aria-hidden="true" tabindex="-1"></a>A simple frequency table is found using <span class="in">`count()`</span>. Try-</span>
<span id="cb145-842"><a href="#cb145-842" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-845"><a href="#cb145-845" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb145-846"><a href="#cb145-846" aria-hidden="true" tabindex="-1"></a>my.data <span class="sc">|&gt;</span> </span>
<span id="cb145-847"><a href="#cb145-847" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(wind, w.e) <span class="sc">|&gt;</span> </span>
<span id="cb145-848"><a href="#cb145-848" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(temp)</span>
<span id="cb145-849"><a href="#cb145-849" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-850"><a href="#cb145-850" aria-hidden="true" tabindex="-1"></a>my.data <span class="sc">|&gt;</span> </span>
<span id="cb145-851"><a href="#cb145-851" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(wind, w.e) <span class="sc">|&gt;</span> </span>
<span id="cb145-852"><a href="#cb145-852" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(temp, river)</span>
<span id="cb145-853"><a href="#cb145-853" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb145-854"><a href="#cb145-854" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-855"><a href="#cb145-855" aria-hidden="true" tabindex="-1"></a>The <span class="in">`count()`</span> is useful to check the balanced nature of the data when</span>
<span id="cb145-856"><a href="#cb145-856" aria-hidden="true" tabindex="-1"></a>many subgroups are involved.</span>
<span id="cb145-857"><a href="#cb145-857" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-858"><a href="#cb145-858" aria-hidden="true" tabindex="-1"></a><span class="fu">## `tidyr` {.unnumbered}</span></span>
<span id="cb145-859"><a href="#cb145-859" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-860"><a href="#cb145-860" aria-hidden="true" tabindex="-1"></a>By the phrase <span class="in">`tidy data`</span>, it is meant the preferred way of arranging</span>
<span id="cb145-861"><a href="#cb145-861" aria-hidden="true" tabindex="-1"></a>data that is easy to analyse. The principles of tidy data are:</span>
<span id="cb145-862"><a href="#cb145-862" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-863"><a href="#cb145-863" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Each variable forms a column.</span>
<span id="cb145-864"><a href="#cb145-864" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Each observation forms a row.</span>
<span id="cb145-865"><a href="#cb145-865" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Each type of observational unit forms a table.</span>
<span id="cb145-866"><a href="#cb145-866" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-867"><a href="#cb145-867" aria-hidden="true" tabindex="-1"></a>The hospital admissions dataset is untidy because it does allocate many</span>
<span id="cb145-868"><a href="#cb145-868" aria-hidden="true" tabindex="-1"></a>columns for a variable.</span>
<span id="cb145-869"><a href="#cb145-869" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-872"><a href="#cb145-872" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb145-873"><a href="#cb145-873" aria-hidden="true" tabindex="-1"></a>my.data <span class="ot">&lt;-</span> <span class="fu">read.table</span>(</span>
<span id="cb145-874"><a href="#cb145-874" aria-hidden="true" tabindex="-1"></a>  <span class="st">"https://www.massey.ac.nz/~anhsmith/data/hospital.txt"</span>,</span>
<span id="cb145-875"><a href="#cb145-875" aria-hidden="true" tabindex="-1"></a>  <span class="at">header=</span><span class="cn">TRUE</span>, <span class="at">sep=</span><span class="st">","</span>)</span>
<span id="cb145-876"><a href="#cb145-876" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb145-877"><a href="#cb145-877" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(my.data)</span>
<span id="cb145-878"><a href="#cb145-878" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb145-879"><a href="#cb145-879" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-880"><a href="#cb145-880" aria-hidden="true" tabindex="-1"></a>The main response variable namely the number of admissions is allocated different columns depending on the North and South locations. This format is also called <span class="in">`wide format`</span> which can be made into a tidy <span class="in">`long format`</span>. Try-</span>
<span id="cb145-881"><a href="#cb145-881" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-884"><a href="#cb145-884" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb145-885"><a href="#cb145-885" aria-hidden="true" tabindex="-1"></a><span class="co">#| results: hide</span></span>
<span id="cb145-886"><a href="#cb145-886" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb145-887"><a href="#cb145-887" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-888"><a href="#cb145-888" aria-hidden="true" tabindex="-1"></a>my.data <span class="sc">|&gt;</span> </span>
<span id="cb145-889"><a href="#cb145-889" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(NORTH1, NORTH2, NORTH3, </span>
<span id="cb145-890"><a href="#cb145-890" aria-hidden="true" tabindex="-1"></a>         SOUTH1, SOUTH2, SOUTH3)</span>
<span id="cb145-891"><a href="#cb145-891" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb145-892"><a href="#cb145-892" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-893"><a href="#cb145-893" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb145-894"><a href="#cb145-894" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-895"><a href="#cb145-895" aria-hidden="true" tabindex="-1"></a>The command <span class="in">`spread()`</span> does the opposite to <span class="in">`gather()`</span>. The <span class="in">`tidyr`</span></span>
<span id="cb145-896"><a href="#cb145-896" aria-hidden="true" tabindex="-1"></a>package many other functions such as <span class="in">`unite()`</span>, <span class="in">`separate()`</span> etc to deal with columns. A better approach would be to use the <span class="in">`dplyr`</span> function <span class="in">`pivot_longer()`</span>. Try-</span>
<span id="cb145-897"><a href="#cb145-897" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-900"><a href="#cb145-900" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb145-901"><a href="#cb145-901" aria-hidden="true" tabindex="-1"></a><span class="co">#| results: hide</span></span>
<span id="cb145-902"><a href="#cb145-902" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-903"><a href="#cb145-903" aria-hidden="true" tabindex="-1"></a>my.data <span class="sc">|&gt;</span> </span>
<span id="cb145-904"><a href="#cb145-904" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> NORTH1<span class="sc">:</span>SOUTH3, </span>
<span id="cb145-905"><a href="#cb145-905" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"location"</span>, </span>
<span id="cb145-906"><a href="#cb145-906" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"Admissions"</span>)</span>
<span id="cb145-907"><a href="#cb145-907" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb145-908"><a href="#cb145-908" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-909"><a href="#cb145-909" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-910"><a href="#cb145-910" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-911"><a href="#cb145-911" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-912"><a href="#cb145-912" aria-hidden="true" tabindex="-1"></a>The command <span class="in">`pivot_wider()`</span> does the opposite to <span class="in">`pivot_longer()`</span></span>
<span id="cb145-913"><a href="#cb145-913" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-914"><a href="#cb145-914" aria-hidden="true" tabindex="-1"></a>The <span class="in">`dplyr`</span> package also has functions to deal with two-tables which can be joined either conditionally or unconditionally using commands such as <span class="in">`full_join()`</span>. For a detailed notes and examples, you may visit <span class="ot">&lt;https://dplyr.tidyverse.org/articles/two-table.html&gt;</span> but we will be using such functions very occasionally in this course.</span>
<span id="cb145-915"><a href="#cb145-915" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-916"><a href="#cb145-916" aria-hidden="true" tabindex="-1"></a>The <span class="in">`reshape2`</span> and <span class="in">`data.table`</span> packages also have functions to do the same task.</span>
<span id="cb145-917"><a href="#cb145-917" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-918"><a href="#cb145-918" aria-hidden="true" tabindex="-1"></a><span class="fu"># A typical data analysis session in R/RStudio {.unnumbered}</span></span>
<span id="cb145-919"><a href="#cb145-919" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-920"><a href="#cb145-920" aria-hidden="true" tabindex="-1"></a>A data analysis session in R/RStudio involves loading the data,</span>
<span id="cb145-921"><a href="#cb145-921" aria-hidden="true" tabindex="-1"></a>graphing, and modelling. You finally save your outputs or produce a</span>
<span id="cb145-922"><a href="#cb145-922" aria-hidden="true" tabindex="-1"></a>Report.</span>
<span id="cb145-923"><a href="#cb145-923" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-924"><a href="#cb145-924" aria-hidden="true" tabindex="-1"></a>When you begin your analysis in RStudio, start it as a new project in the File menu. You can save all your work in one go when you quit the RStudio software. You can always load your project later on to continue the analysis.</span>
<span id="cb145-925"><a href="#cb145-925" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-926"><a href="#cb145-926" aria-hidden="true" tabindex="-1"></a>For the sack of simplicity, let us use an R default dataset called</span>
<span id="cb145-927"><a href="#cb145-927" aria-hidden="true" tabindex="-1"></a><span class="in">`stackloss`</span> giving the operational data of a plant for the oxidation of ammonia to nitric acid.</span>
<span id="cb145-928"><a href="#cb145-928" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-931"><a href="#cb145-931" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb145-932"><a href="#cb145-932" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"stackloss"</span>)</span>
<span id="cb145-933"><a href="#cb145-933" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(stackloss, <span class="dv">5</span>)</span>
<span id="cb145-934"><a href="#cb145-934" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb145-935"><a href="#cb145-935" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-936"><a href="#cb145-936" aria-hidden="true" tabindex="-1"></a>The distribution of the response variable <span class="in">`stack.loss`</span> is explored using</span>
<span id="cb145-937"><a href="#cb145-937" aria-hidden="true" tabindex="-1"></a>a histogram below:</span>
<span id="cb145-938"><a href="#cb145-938" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-941"><a href="#cb145-941" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb145-942"><a href="#cb145-942" aria-hidden="true" tabindex="-1"></a>stackloss <span class="sc">|&gt;</span> </span>
<span id="cb145-943"><a href="#cb145-943" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb145-944"><a href="#cb145-944" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(stack.loss) <span class="sc">+</span></span>
<span id="cb145-945"><a href="#cb145-945" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">5</span>)</span>
<span id="cb145-946"><a href="#cb145-946" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb145-947"><a href="#cb145-947" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-948"><a href="#cb145-948" aria-hidden="true" tabindex="-1"></a>Histograms are not good displays for small datasets. In order to see the</span>
<span id="cb145-949"><a href="#cb145-949" aria-hidden="true" tabindex="-1"></a>size or length of <span class="in">`stack.loss`</span> data, we select the stack.loss variable</span>
<span id="cb145-950"><a href="#cb145-950" aria-hidden="true" tabindex="-1"></a>and then summarise the size using the *n()* option.</span>
<span id="cb145-951"><a href="#cb145-951" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-954"><a href="#cb145-954" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb145-955"><a href="#cb145-955" aria-hidden="true" tabindex="-1"></a>stackloss <span class="sc">|&gt;</span> </span>
<span id="cb145-956"><a href="#cb145-956" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(stack.loss) <span class="sc">|&gt;</span> </span>
<span id="cb145-957"><a href="#cb145-957" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">n</span>())</span>
<span id="cb145-958"><a href="#cb145-958" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb145-959"><a href="#cb145-959" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-960"><a href="#cb145-960" aria-hidden="true" tabindex="-1"></a>The following commands will also work.</span>
<span id="cb145-961"><a href="#cb145-961" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-964"><a href="#cb145-964" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb145-965"><a href="#cb145-965" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(stackloss<span class="sc">$</span>stack.loss)</span>
<span id="cb145-966"><a href="#cb145-966" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-967"><a href="#cb145-967" aria-hidden="true" tabindex="-1"></a>stackloss <span class="sc">|&gt;</span> <span class="fu">pull</span>(stack.loss) <span class="sc">|&gt;</span> <span class="fu">length</span>()</span>
<span id="cb145-968"><a href="#cb145-968" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb145-969"><a href="#cb145-969" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-970"><a href="#cb145-970" aria-hidden="true" tabindex="-1"></a>We may also explore how well <span class="in">`stack.loss`</span> is related <span class="in">`Air.Flow`</span> to using</span>
<span id="cb145-971"><a href="#cb145-971" aria-hidden="true" tabindex="-1"></a>a scatter plot. For this, we type the command <span class="in">`plot`</span></span>
<span id="cb145-972"><a href="#cb145-972" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-975"><a href="#cb145-975" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb145-976"><a href="#cb145-976" aria-hidden="true" tabindex="-1"></a>stackloss <span class="sc">|&gt;</span> </span>
<span id="cb145-977"><a href="#cb145-977" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb145-978"><a href="#cb145-978" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">y=</span>stack.loss, <span class="at">x=</span>Air.Flow) <span class="sc">+</span></span>
<span id="cb145-979"><a href="#cb145-979" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb145-980"><a href="#cb145-980" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb145-981"><a href="#cb145-981" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-982"><a href="#cb145-982" aria-hidden="true" tabindex="-1"></a>The relationship is roughly linear. So we may fit a straight line model</span>
<span id="cb145-983"><a href="#cb145-983" aria-hidden="true" tabindex="-1"></a>using the <span class="in">`lm`</span> command.</span>
<span id="cb145-984"><a href="#cb145-984" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-987"><a href="#cb145-987" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb145-988"><a href="#cb145-988" aria-hidden="true" tabindex="-1"></a>st.line.model <span class="ot">&lt;-</span> <span class="fu">lm</span>(stack.loss<span class="sc">~</span>Air.Flow, <span class="at">data=</span>stackloss)</span>
<span id="cb145-989"><a href="#cb145-989" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb145-990"><a href="#cb145-990" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-991"><a href="#cb145-991" aria-hidden="true" tabindex="-1"></a>We can query this model asking for its summary using the <span class="in">`summary()`</span></span>
<span id="cb145-992"><a href="#cb145-992" aria-hidden="true" tabindex="-1"></a>function.</span>
<span id="cb145-993"><a href="#cb145-993" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-996"><a href="#cb145-996" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb145-997"><a href="#cb145-997" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(st.line.model)</span>
<span id="cb145-998"><a href="#cb145-998" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb145-999"><a href="#cb145-999" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1000"><a href="#cb145-1000" aria-hidden="true" tabindex="-1"></a><span class="in">`R`</span> default model summary is bit too long.  We may just glance the overall quality measures of the fitted model as follows:</span>
<span id="cb145-1001"><a href="#cb145-1001" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1004"><a href="#cb145-1004" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb145-1005"><a href="#cb145-1005" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb145-1006"><a href="#cb145-1006" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb145-1007"><a href="#cb145-1007" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb145-1008"><a href="#cb145-1008" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1009"><a href="#cb145-1009" aria-hidden="true" tabindex="-1"></a>out1 <span class="ot">&lt;-</span> st.line.model <span class="sc">|&gt;</span> </span>
<span id="cb145-1010"><a href="#cb145-1010" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glance</span>() <span class="sc">|&gt;</span> </span>
<span id="cb145-1011"><a href="#cb145-1011" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), </span>
<span id="cb145-1012"><a href="#cb145-1012" aria-hidden="true" tabindex="-1"></a>                <span class="sc">~</span><span class="fu">round</span>(., <span class="dv">2</span>))</span>
<span id="cb145-1013"><a href="#cb145-1013" aria-hidden="true" tabindex="-1"></a>         )</span>
<span id="cb145-1014"><a href="#cb145-1014" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1015"><a href="#cb145-1015" aria-hidden="true" tabindex="-1"></a>out1 <span class="sc">|&gt;</span> <span class="fu">t</span>() <span class="sc">|&gt;</span> <span class="fu">kable</span>() <span class="sc">|&gt;</span> </span>
<span id="cb145-1016"><a href="#cb145-1016" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> F) </span>
<span id="cb145-1017"><a href="#cb145-1017" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb145-1018"><a href="#cb145-1018" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1019"><a href="#cb145-1019" aria-hidden="true" tabindex="-1"></a>For processing using Rmarkdown, we may use the codes which will give a tidy tabular output in the word-processed output.</span>
<span id="cb145-1020"><a href="#cb145-1020" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1021"><a href="#cb145-1021" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1024"><a href="#cb145-1024" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb145-1025"><a href="#cb145-1025" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb145-1026"><a href="#cb145-1026" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb145-1027"><a href="#cb145-1027" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb145-1028"><a href="#cb145-1028" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1029"><a href="#cb145-1029" aria-hidden="true" tabindex="-1"></a>out1 <span class="ot">&lt;-</span> st.line.model <span class="sc">|&gt;</span> </span>
<span id="cb145-1030"><a href="#cb145-1030" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">|&gt;</span> </span>
<span id="cb145-1031"><a href="#cb145-1031" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span><span class="fu">round</span>(., <span class="dv">2</span>)))</span>
<span id="cb145-1032"><a href="#cb145-1032" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1033"><a href="#cb145-1033" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(out1) <span class="sc">|&gt;</span>  </span>
<span id="cb145-1034"><a href="#cb145-1034" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> F) </span>
<span id="cb145-1035"><a href="#cb145-1035" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb145-1036"><a href="#cb145-1036" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1037"><a href="#cb145-1037" aria-hidden="true" tabindex="-1"></a>The fitted model is shown below:</span>
<span id="cb145-1038"><a href="#cb145-1038" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1041"><a href="#cb145-1041" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb145-1042"><a href="#cb145-1042" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(stackloss) <span class="sc">+</span> </span>
<span id="cb145-1043"><a href="#cb145-1043" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">y=</span>stack.loss, <span class="at">x=</span>Air.Flow) <span class="sc">+</span></span>
<span id="cb145-1044"><a href="#cb145-1044" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb145-1045"><a href="#cb145-1045" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm, <span class="at">se =</span> <span class="cn">FALSE</span>)</span>
<span id="cb145-1046"><a href="#cb145-1046" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb145-1047"><a href="#cb145-1047" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1048"><a href="#cb145-1048" aria-hidden="true" tabindex="-1"></a>The fitted model can also be displayed on the scatter plot using the old style <span class="in">`plot`</span> and <span class="in">`abline`</span> commands.</span>
<span id="cb145-1049"><a href="#cb145-1049" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1050"><a href="#cb145-1050" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=TRUE, fig.show="hide"}</span></span>
<span id="cb145-1051"><a href="#cb145-1051" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(stack.loss <span class="sc">~</span> Air.Flow, <span class="at">data=</span>stackloss)</span>
<span id="cb145-1052"><a href="#cb145-1052" aria-hidden="true" tabindex="-1"></a>st.line.model <span class="ot">&lt;-</span> <span class="fu">lm</span>(stack.loss<span class="sc">~</span>Air.Flow, <span class="at">data=</span>stackloss)</span>
<span id="cb145-1053"><a href="#cb145-1053" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(st.line.model)</span>
<span id="cb145-1054"><a href="#cb145-1054" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb145-1055"><a href="#cb145-1055" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1056"><a href="#cb145-1056" aria-hidden="true" tabindex="-1"></a><span class="fu">## Data Quality Checks {.unnumbered}</span></span>
<span id="cb145-1057"><a href="#cb145-1057" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1058"><a href="#cb145-1058" aria-hidden="true" tabindex="-1"></a>It is a good idea to check the quality of secondary data sourced from</span>
<span id="cb145-1059"><a href="#cb145-1059" aria-hidden="true" tabindex="-1"></a>elsewhere. For example, there could be missing values in the dataset.</span>
<span id="cb145-1060"><a href="#cb145-1060" aria-hidden="true" tabindex="-1"></a>Consider the Telomeres data downloaded from</span>
<span id="cb145-1061"><a href="#cb145-1061" aria-hidden="true" tabindex="-1"></a><span class="ot">&lt;http://www.massey.ac.nz/~anhsmith/data/rsos192136_si_001.xlsx&gt;</span></span>
<span id="cb145-1062"><a href="#cb145-1062" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1065"><a href="#cb145-1065" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb145-1066"><a href="#cb145-1066" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb145-1067"><a href="#cb145-1067" aria-hidden="true" tabindex="-1"></a>url <span class="ot">&lt;-</span> <span class="st">"http://www.massey.ac.nz/~anhsmith/data/rsos192136_si_001.xlsx"</span></span>
<span id="cb145-1068"><a href="#cb145-1068" aria-hidden="true" tabindex="-1"></a>destfile <span class="ot">&lt;-</span> <span class="st">"rsos192136_si_001.xlsx"</span></span>
<span id="cb145-1069"><a href="#cb145-1069" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1070"><a href="#cb145-1070" aria-hidden="true" tabindex="-1"></a><span class="fu">download.file</span>(url, destfile)</span>
<span id="cb145-1071"><a href="#cb145-1071" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb145-1072"><a href="#cb145-1072" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1075"><a href="#cb145-1075" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb145-1076"><a href="#cb145-1076" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb145-1077"><a href="#cb145-1077" aria-hidden="true" tabindex="-1"></a>rsos192136_si_001 <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"rsos192136_si_001.xlsx"</span>)</span>
<span id="cb145-1078"><a href="#cb145-1078" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb145-1079"><a href="#cb145-1079" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1080"><a href="#cb145-1080" aria-hidden="true" tabindex="-1"></a>The missingness of data can be quickly explored using many R packages.</span>
<span id="cb145-1081"><a href="#cb145-1081" aria-hidden="true" tabindex="-1"></a>The downloaded Telomeres dataset contain many missing values.</span>
<span id="cb145-1082"><a href="#cb145-1082" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1083"><a href="#cb145-1083" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, results='hide'}</span></span>
<span id="cb145-1084"><a href="#cb145-1084" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(VIM)</span>
<span id="cb145-1085"><a href="#cb145-1085" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1086"><a href="#cb145-1086" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> rsos192136_si_001 <span class="sc">|&gt;</span> </span>
<span id="cb145-1087"><a href="#cb145-1087" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aggr</span>(<span class="at">sortVar=</span><span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb145-1088"><a href="#cb145-1088" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>() <span class="sc">|&gt;</span> </span>
<span id="cb145-1089"><a href="#cb145-1089" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pluck</span>(<span class="st">"combinations"</span>)</span>
<span id="cb145-1090"><a href="#cb145-1090" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb145-1091"><a href="#cb145-1091" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1092"><a href="#cb145-1092" aria-hidden="true" tabindex="-1"></a>or</span>
<span id="cb145-1093"><a href="#cb145-1093" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1094"><a href="#cb145-1094" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.show='hide', results='hide'}</span></span>
<span id="cb145-1095"><a href="#cb145-1095" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(naniar)</span>
<span id="cb145-1096"><a href="#cb145-1096" aria-hidden="true" tabindex="-1"></a><span class="fu">gg_miss_var</span>(rsos192136_si_001) </span>
<span id="cb145-1097"><a href="#cb145-1097" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb145-1098"><a href="#cb145-1098" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1099"><a href="#cb145-1099" aria-hidden="true" tabindex="-1"></a>The term *Missing completely at random* (MCAR) is often used to mean</span>
<span id="cb145-1100"><a href="#cb145-1100" aria-hidden="true" tabindex="-1"></a>there is there is no pattern to the missing data themselves or</span>
<span id="cb145-1101"><a href="#cb145-1101" aria-hidden="true" tabindex="-1"></a>alternatively the missingness is not related to any other variable or</span>
<span id="cb145-1102"><a href="#cb145-1102" aria-hidden="true" tabindex="-1"></a>data in the dataset. In other words, the probability of missingness is</span>
<span id="cb145-1103"><a href="#cb145-1103" aria-hidden="true" tabindex="-1"></a>the same for all units. So no bias is caused by the missing data, and we</span>
<span id="cb145-1104"><a href="#cb145-1104" aria-hidden="true" tabindex="-1"></a>can discard cases with missing data when we fit models.</span>
<span id="cb145-1105"><a href="#cb145-1105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1106"><a href="#cb145-1106" aria-hidden="true" tabindex="-1"></a>In practice, we often find missing data do have a relationship with</span>
<span id="cb145-1107"><a href="#cb145-1107" aria-hidden="true" tabindex="-1"></a>other variables in the dataset but the actual missing values are random.</span>
<span id="cb145-1108"><a href="#cb145-1108" aria-hidden="true" tabindex="-1"></a>This situation of data conditionally missing at random is called</span>
<span id="cb145-1109"><a href="#cb145-1109" aria-hidden="true" tabindex="-1"></a>*Missing at random (MAR)* data. For a particular survey question, the</span>
<span id="cb145-1110"><a href="#cb145-1110" aria-hidden="true" tabindex="-1"></a>response rate may differ depending on the respondent's gender. In this</span>
<span id="cb145-1111"><a href="#cb145-1111" aria-hidden="true" tabindex="-1"></a>situation, the actual missingness may be random but still related to the</span>
<span id="cb145-1112"><a href="#cb145-1112" aria-hidden="true" tabindex="-1"></a>gender variable.</span>
<span id="cb145-1113"><a href="#cb145-1113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1114"><a href="#cb145-1114" aria-hidden="true" tabindex="-1"></a>*Missing not at random (MNAR)* is the pattern when missingness is</span>
<span id="cb145-1115"><a href="#cb145-1115" aria-hidden="true" tabindex="-1"></a>related to other variables in the dataset, as well as the values of the</span>
<span id="cb145-1116"><a href="#cb145-1116" aria-hidden="true" tabindex="-1"></a>missing data are not random. In other words, there is a predictable</span>
<span id="cb145-1117"><a href="#cb145-1117" aria-hidden="true" tabindex="-1"></a>pattern in the missingness. So we cannot avoid the bias when missing</span>
<span id="cb145-1118"><a href="#cb145-1118" aria-hidden="true" tabindex="-1"></a>cases are omitted.</span>
<span id="cb145-1119"><a href="#cb145-1119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1120"><a href="#cb145-1120" aria-hidden="true" tabindex="-1"></a>There are also situations such as censoring where we just record a</span>
<span id="cb145-1121"><a href="#cb145-1121" aria-hidden="true" tabindex="-1"></a>single value without actually measuring the variable of interest.</span>
<span id="cb145-1122"><a href="#cb145-1122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1123"><a href="#cb145-1123" aria-hidden="true" tabindex="-1"></a>Imputation of data can be made except for the case of MCAR type. A</span>
<span id="cb145-1124"><a href="#cb145-1124" aria-hidden="true" tabindex="-1"></a>number of R packages are available for data imputation; see</span>
<span id="cb145-1125"><a href="#cb145-1125" aria-hidden="true" tabindex="-1"></a><span class="ot">&lt;https://cran.r-project.org/web/views/MissingData.html&gt;</span> or</span>
<span id="cb145-1126"><a href="#cb145-1126" aria-hidden="true" tabindex="-1"></a><span class="ot">&lt;https://stefvanbuuren.name/fimd/&gt;</span>. We may occasionally cover data</span>
<span id="cb145-1127"><a href="#cb145-1127" aria-hidden="true" tabindex="-1"></a>imputation issue in an assignment question.</span>
<span id="cb145-1128"><a href="#cb145-1128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1129"><a href="#cb145-1129" aria-hidden="true" tabindex="-1"></a>There are also R packages to perform automatic investigation for data</span>
<span id="cb145-1130"><a href="#cb145-1130" aria-hidden="true" tabindex="-1"></a>cleaning. Try-</span>
<span id="cb145-1131"><a href="#cb145-1131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1134"><a href="#cb145-1134" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb145-1135"><a href="#cb145-1135" aria-hidden="true" tabindex="-1"></a><span class="co">#| results: hide</span></span>
<span id="cb145-1136"><a href="#cb145-1136" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb145-1137"><a href="#cb145-1137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1138"><a href="#cb145-1138" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dataMaid)</span>
<span id="cb145-1139"><a href="#cb145-1139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1140"><a href="#cb145-1140" aria-hidden="true" tabindex="-1"></a><span class="fu">makeDataReport</span>(rsos192136_si_001, <span class="at">output=</span><span class="st">"html"</span>, <span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb145-1141"><a href="#cb145-1141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1142"><a href="#cb145-1142" aria-hidden="true" tabindex="-1"></a><span class="co"># or</span></span>
<span id="cb145-1143"><a href="#cb145-1143" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DataExplorer)</span>
<span id="cb145-1144"><a href="#cb145-1144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1145"><a href="#cb145-1145" aria-hidden="true" tabindex="-1"></a><span class="fu">create_report</span>(rsos192136_si_001)</span>
<span id="cb145-1146"><a href="#cb145-1146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1147"><a href="#cb145-1147" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb145-1148"><a href="#cb145-1148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1149"><a href="#cb145-1149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1150"><a href="#cb145-1150" aria-hidden="true" tabindex="-1"></a>Rule based validation is enabled in the R package *validate*. The R</span>
<span id="cb145-1151"><a href="#cb145-1151" aria-hidden="true" tabindex="-1"></a>package *janitor* has a function get<span class="sc">\_</span>dupes() to find duplicate entries</span>
<span id="cb145-1152"><a href="#cb145-1152" aria-hidden="true" tabindex="-1"></a>in the dataset. *Cleaner* package will allow to clean the variables so</span>
<span id="cb145-1153"><a href="#cb145-1153" aria-hidden="true" tabindex="-1"></a>that the columns are consistent in terms of the factor, date, numerical</span>
<span id="cb145-1154"><a href="#cb145-1154" aria-hidden="true" tabindex="-1"></a>variable types. You will be largely using data that are already cleaned</span>
<span id="cb145-1155"><a href="#cb145-1155" aria-hidden="true" tabindex="-1"></a>for your assignments but be aware that you have to perform data cleaning</span>
<span id="cb145-1156"><a href="#cb145-1156" aria-hidden="true" tabindex="-1"></a>and perform necessary quality checks before analysis.</span>
<span id="cb145-1157"><a href="#cb145-1157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1158"><a href="#cb145-1158" aria-hidden="true" tabindex="-1"></a><span class="fu"># Further Help {.unnumbered}</span></span>
<span id="cb145-1159"><a href="#cb145-1159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1160"><a href="#cb145-1160" aria-hidden="true" tabindex="-1"></a>There are a number of online sources (tutorials, discussion groups etc)</span>
<span id="cb145-1161"><a href="#cb145-1161" aria-hidden="true" tabindex="-1"></a>for getting help with R. These links are available at your class Stream.</span>
<span id="cb145-1162"><a href="#cb145-1162" aria-hidden="true" tabindex="-1"></a>You may also use the advanced search facility of Goggle at</span>
<span id="cb145-1163"><a href="#cb145-1163" aria-hidden="true" tabindex="-1"></a><span class="ot">&lt;https://www.google.com/advanced_search&gt;</span>; more specifically at</span>
<span id="cb145-1164"><a href="#cb145-1164" aria-hidden="true" tabindex="-1"></a><span class="ot">&lt;https://stackoverflow.com&gt;</span>.</span>
<span id="cb145-1165"><a href="#cb145-1165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1166"><a href="#cb145-1166" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>For further online tutorials</span>
<span id="cb145-1167"><a href="#cb145-1167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1168"><a href="#cb145-1168" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span><span class="ot">&lt;https://r4ds.had.co.nz/&gt;</span></span>
<span id="cb145-1169"><a href="#cb145-1169" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span><span class="ot">&lt;https://www.datacamp.org&gt;</span></span>
<span id="cb145-1170"><a href="#cb145-1170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1171"><a href="#cb145-1171" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>For further graphing example</span>
<span id="cb145-1172"><a href="#cb145-1172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1173"><a href="#cb145-1173" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span><span class="ot">&lt;https://www.r-graph-gallery.com/all-graphs&gt;</span></span>
<span id="cb145-1174"><a href="#cb145-1174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1175"><a href="#cb145-1175" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Getting help:</span>
<span id="cb145-1176"><a href="#cb145-1176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1177"><a href="#cb145-1177" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>RStudio cheat sheets:</span>
<span id="cb145-1178"><a href="#cb145-1178" aria-hidden="true" tabindex="-1"></a>        <span class="ot">&lt;https://www.rstudio.com/resources/cheatsheets&gt;</span></span>
<span id="cb145-1179"><a href="#cb145-1179" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>RStudio resources <span class="ot">&lt;https://resources.rstudio.com&gt;</span></span>
<span id="cb145-1180"><a href="#cb145-1180" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Recommended R packages by topic:</span>
<span id="cb145-1181"><a href="#cb145-1181" aria-hidden="true" tabindex="-1"></a>        <span class="ot">&lt;https://cran.r-project.org/web/views/&gt;</span></span>
<span id="cb145-1182"><a href="#cb145-1182" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>StackOverflow: <span class="ot">&lt;https://stackoverflow.com/questions/tagged/r&gt;</span></span>
<span id="cb145-1183"><a href="#cb145-1183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1184"><a href="#cb145-1184" aria-hidden="true" tabindex="-1"></a><span class="fu"># R default (base) Graphing {.unnumbered}</span></span>
<span id="cb145-1185"><a href="#cb145-1185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1186"><a href="#cb145-1186" aria-hidden="true" tabindex="-1"></a>For a simple bar chart, try</span>
<span id="cb145-1187"><a href="#cb145-1187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1188"><a href="#cb145-1188" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.show="hide"}</span></span>
<span id="cb145-1189"><a href="#cb145-1189" aria-hidden="true" tabindex="-1"></a>freq <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>)</span>
<span id="cb145-1190"><a href="#cb145-1190" aria-hidden="true" tabindex="-1"></a>names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"A"</span>,<span class="st">"B"</span>,<span class="st">"C"</span>,<span class="st">"D"</span>,<span class="st">"E"</span>)</span>
<span id="cb145-1191"><a href="#cb145-1191" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(freq, <span class="at">names.arg=</span>names)</span>
<span id="cb145-1192"><a href="#cb145-1192" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb145-1193"><a href="#cb145-1193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1194"><a href="#cb145-1194" aria-hidden="true" tabindex="-1"></a>Let us generate random data from the normal distribution *N(10,1)*</span>
<span id="cb145-1195"><a href="#cb145-1195" aria-hidden="true" tabindex="-1"></a>distribution and form a batch of data for illustrating graphing in R.</span>
<span id="cb145-1196"><a href="#cb145-1196" aria-hidden="true" tabindex="-1"></a>Try the following commands one by one.</span>
<span id="cb145-1197"><a href="#cb145-1197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1200"><a href="#cb145-1200" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb145-1201"><a href="#cb145-1201" aria-hidden="true" tabindex="-1"></a><span class="co">#| results: hide</span></span>
<span id="cb145-1202"><a href="#cb145-1202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1203"><a href="#cb145-1203" aria-hidden="true" tabindex="-1"></a>x  <span class="ot">&lt;-</span>  <span class="fu">rnorm</span>(<span class="dv">40</span>, <span class="dv">10</span>,<span class="dv">1</span>)</span>
<span id="cb145-1204"><a href="#cb145-1204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1205"><a href="#cb145-1205" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x)</span>
<span id="cb145-1206"><a href="#cb145-1206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1207"><a href="#cb145-1207" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(x)</span>
<span id="cb145-1208"><a href="#cb145-1208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1209"><a href="#cb145-1209" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x)</span>
<span id="cb145-1210"><a href="#cb145-1210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1211"><a href="#cb145-1211" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(x), <span class="at">xlab=</span><span class="st">""</span>)</span>
<span id="cb145-1212"><a href="#cb145-1212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1213"><a href="#cb145-1213" aria-hidden="true" tabindex="-1"></a><span class="fu">stripchart</span>(<span class="fu">round</span>(x,<span class="dv">1</span>), <span class="at">method =</span> <span class="st">"stack"</span>, <span class="at">pch=</span><span class="dv">20</span>)</span>
<span id="cb145-1214"><a href="#cb145-1214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1215"><a href="#cb145-1215" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">ecdf</span>(x), <span class="at">verticals=</span><span class="cn">TRUE</span>)</span>
<span id="cb145-1216"><a href="#cb145-1216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1217"><a href="#cb145-1217" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb145-1218"><a href="#cb145-1218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1219"><a href="#cb145-1219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1220"><a href="#cb145-1220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1221"><a href="#cb145-1221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1222"><a href="#cb145-1222" aria-hidden="true" tabindex="-1"></a>We can form a matrix of order 3X2 or (or 2X3) and display all the above</span>
<span id="cb145-1223"><a href="#cb145-1223" aria-hidden="true" tabindex="-1"></a>six graphs in a panel. This is done using the option <span class="in">`par()`</span>, which</span>
<span id="cb145-1224"><a href="#cb145-1224" aria-hidden="true" tabindex="-1"></a>controls the graphics *par*ameters.</span>
<span id="cb145-1225"><a href="#cb145-1225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1226"><a href="#cb145-1226" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.width=6, fig.height=5}</span></span>
<span id="cb145-1227"><a href="#cb145-1227" aria-hidden="true" tabindex="-1"></a>x  <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">40</span>, <span class="dv">10</span>,<span class="dv">1</span>)</span>
<span id="cb145-1228"><a href="#cb145-1228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1229"><a href="#cb145-1229" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>))</span>
<span id="cb145-1230"><a href="#cb145-1230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1231"><a href="#cb145-1231" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x) </span>
<span id="cb145-1232"><a href="#cb145-1232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1233"><a href="#cb145-1233" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(x)</span>
<span id="cb145-1234"><a href="#cb145-1234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1235"><a href="#cb145-1235" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x)</span>
<span id="cb145-1236"><a href="#cb145-1236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1237"><a href="#cb145-1237" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(x), <span class="at">xlab=</span><span class="st">''</span>)</span>
<span id="cb145-1238"><a href="#cb145-1238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1239"><a href="#cb145-1239" aria-hidden="true" tabindex="-1"></a><span class="fu">stripchart</span>(<span class="fu">round</span>(x,<span class="dv">1</span>), <span class="at">method =</span> <span class="st">"stack"</span>, <span class="at">pch=</span><span class="dv">20</span>)</span>
<span id="cb145-1240"><a href="#cb145-1240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1241"><a href="#cb145-1241" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">ecdf</span>(x), <span class="at">verticals=</span><span class="cn">TRUE</span>)</span>
<span id="cb145-1242"><a href="#cb145-1242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1243"><a href="#cb145-1243" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb145-1244"><a href="#cb145-1244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1245"><a href="#cb145-1245" aria-hidden="true" tabindex="-1"></a>Although we shall not cover them here, many plotting options can be set using <span class="in">`par()`</span> function; including size of margins, font types, the colour of axis labels etc. See <span class="in">`help("par")`</span>. The option <span class="in">`par(new=T)`</span> will be useful for an overlaid graph (instead of splitting a graph). Try the following:</span>
<span id="cb145-1246"><a href="#cb145-1246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1247"><a href="#cb145-1247" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.show="hide"}</span></span>
<span id="cb145-1248"><a href="#cb145-1248" aria-hidden="true" tabindex="-1"></a>x  <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">40</span>, <span class="dv">10</span>,<span class="dv">1</span>)</span>
<span id="cb145-1249"><a href="#cb145-1249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1250"><a href="#cb145-1250" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, <span class="at">type =</span> <span class="st">"o"</span>, <span class="at">pch =</span> <span class="dv">1</span>, <span class="at">ylab =</span> <span class="st">""</span>, </span>
<span id="cb145-1251"><a href="#cb145-1251" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="fl">6.5</span>, <span class="fl">13.5</span>), <span class="at">lty =</span> <span class="dv">1</span>)</span>
<span id="cb145-1252"><a href="#cb145-1252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1253"><a href="#cb145-1253" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new=</span>T)</span>
<span id="cb145-1254"><a href="#cb145-1254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1255"><a href="#cb145-1255" aria-hidden="true" tabindex="-1"></a>y  <span class="ot">&lt;-</span>  <span class="fu">rnorm</span>(<span class="dv">40</span>, <span class="dv">10</span>,<span class="dv">1</span>)</span>
<span id="cb145-1256"><a href="#cb145-1256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1257"><a href="#cb145-1257" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(y, <span class="at">type =</span> <span class="st">"o"</span>, <span class="at">pch =</span> <span class="dv">2</span>,</span>
<span id="cb145-1258"><a href="#cb145-1258" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Two Batches of Random Normal Data"</span>,</span>
<span id="cb145-1259"><a href="#cb145-1259" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="fl">6.5</span>, <span class="fl">13.5</span>), <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb145-1260"><a href="#cb145-1260" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb145-1261"><a href="#cb145-1261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1262"><a href="#cb145-1262" aria-hidden="true" tabindex="-1"></a>Note that <span class="in">`pch`</span> specifies for the plotting character and <span class="in">`lty`</span> specifies</span>
<span id="cb145-1263"><a href="#cb145-1263" aria-hidden="true" tabindex="-1"></a>the line type. You can add a legend by the following command line:</span>
<span id="cb145-1264"><a href="#cb145-1264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1265"><a href="#cb145-1265" aria-hidden="true" tabindex="-1"></a><span class="in">`legend("topright", c("Batch I", "Batch II"), pch=1:2, lty=1:2)`</span></span>
<span id="cb145-1266"><a href="#cb145-1266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1267"><a href="#cb145-1267" aria-hidden="true" tabindex="-1"></a>For scatter and other related plots, the command is <span class="in">`plot()`</span>. Try</span>
<span id="cb145-1268"><a href="#cb145-1268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1269"><a href="#cb145-1269" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.show="hide"}</span></span>
<span id="cb145-1270"><a href="#cb145-1270" aria-hidden="true" tabindex="-1"></a>x  <span class="ot">&lt;-</span>  <span class="fu">rnorm</span>(<span class="dv">40</span>, <span class="dv">10</span>,<span class="dv">1</span>)</span>
<span id="cb145-1271"><a href="#cb145-1271" aria-hidden="true" tabindex="-1"></a>y  <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">40</span>, <span class="dv">10</span>,<span class="dv">1</span>)</span>
<span id="cb145-1272"><a href="#cb145-1272" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(y<span class="sc">~</span>x)  <span class="co"># or plot(x,y) </span></span>
<span id="cb145-1273"><a href="#cb145-1273" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb145-1274"><a href="#cb145-1274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1275"><a href="#cb145-1275" aria-hidden="true" tabindex="-1"></a>Add a title by the command</span>
<span id="cb145-1276"><a href="#cb145-1276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1277"><a href="#cb145-1277" aria-hidden="true" tabindex="-1"></a><span class="in">`title("This is my title")`</span></span>
<span id="cb145-1278"><a href="#cb145-1278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1279"><a href="#cb145-1279" aria-hidden="true" tabindex="-1"></a>Add a reference line for the mean at the x-axis by the command</span>
<span id="cb145-1280"><a href="#cb145-1280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1281"><a href="#cb145-1281" aria-hidden="true" tabindex="-1"></a><span class="in">`abline(v=10)`</span></span>
<span id="cb145-1282"><a href="#cb145-1282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1283"><a href="#cb145-1283" aria-hidden="true" tabindex="-1"></a>and again with <span class="in">`abline(h=10)`</span> for the y-axis. A 45 degree (Y=X) line can be added by the command</span>
<span id="cb145-1284"><a href="#cb145-1284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1285"><a href="#cb145-1285" aria-hidden="true" tabindex="-1"></a><span class="in">`abline(0,1) #slope, b=1, y-intercept a=1`</span></span>
<span id="cb145-1286"><a href="#cb145-1286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1287"><a href="#cb145-1287" aria-hidden="true" tabindex="-1"></a>You may also specify two points on the graph, and ask them to be</span>
<span id="cb145-1288"><a href="#cb145-1288" aria-hidden="true" tabindex="-1"></a>connected using the command</span>
<span id="cb145-1289"><a href="#cb145-1289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1290"><a href="#cb145-1290" aria-hidden="true" tabindex="-1"></a><span class="in">`lines(c(8, 12), c(8, 12), lty=2, col=4, lwd=2)`</span></span>
<span id="cb145-1291"><a href="#cb145-1291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1292"><a href="#cb145-1292" aria-hidden="true" tabindex="-1"></a>Note that the <span class="in">`line()`</span> has extra arguments to control the line type,</span>
<span id="cb145-1293"><a href="#cb145-1293" aria-hidden="true" tabindex="-1"></a>line width, and colour.</span>
<span id="cb145-1294"><a href="#cb145-1294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1295"><a href="#cb145-1295" aria-hidden="true" tabindex="-1"></a>The command <span class="in">`rug(x)`</span> draws will draw small vertical lines on the x-axis (the command actually suits better for one dimensional graphs such as a boxplot). Try</span>
<span id="cb145-1296"><a href="#cb145-1296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1297"><a href="#cb145-1297" aria-hidden="true" tabindex="-1"></a><span class="in">`rug(x)`</span></span>
<span id="cb145-1298"><a href="#cb145-1298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1299"><a href="#cb145-1299" aria-hidden="true" tabindex="-1"></a><span class="in">`rug(y, side=2)  #side =2 specifies y-axis`</span></span>
<span id="cb145-1300"><a href="#cb145-1300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1301"><a href="#cb145-1301" aria-hidden="true" tabindex="-1"></a>Graphs can be saved in various file formats, such as PDF (.pdf), JPEG (.jpeg or .jpg), or postscript (.ps), by enclosing the plotting function in the appropriate commands. For example, to save a simple figure as a PDF file, we use the <span class="in">`pdf()`</span> function.</span>
<span id="cb145-1302"><a href="#cb145-1302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1303"><a href="#cb145-1303" aria-hidden="true" tabindex="-1"></a><span class="in">`x  &lt;-  1:10`</span></span>
<span id="cb145-1304"><a href="#cb145-1304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1305"><a href="#cb145-1305" aria-hidden="true" tabindex="-1"></a><span class="in">`y  &lt;-  x^2`</span></span>
<span id="cb145-1306"><a href="#cb145-1306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1307"><a href="#cb145-1307" aria-hidden="true" tabindex="-1"></a><span class="in">`pdf(file = "Fig.pdf")`</span></span>
<span id="cb145-1308"><a href="#cb145-1308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1309"><a href="#cb145-1309" aria-hidden="true" tabindex="-1"></a><span class="in">`plot(x, y)`</span></span>
<span id="cb145-1310"><a href="#cb145-1310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1311"><a href="#cb145-1311" aria-hidden="true" tabindex="-1"></a><span class="in">`dev.off()`</span></span>
<span id="cb145-1312"><a href="#cb145-1312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1313"><a href="#cb145-1313" aria-hidden="true" tabindex="-1"></a>The <span class="in">`command dev.off()`</span> closes the file. You may use the copy and paste facility for processing graphs or use the RStudio option to save graphs.</span>
<span id="cb145-1314"><a href="#cb145-1314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1315"><a href="#cb145-1315" aria-hidden="true" tabindex="-1"></a>The<span class="in">`lattice`</span> package contains extra graphing facilities but such graphs can be produced using <span class="in">`ggplot2`</span> package. Try-</span>
<span id="cb145-1316"><a href="#cb145-1316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1319"><a href="#cb145-1319" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb145-1320"><a href="#cb145-1320" aria-hidden="true" tabindex="-1"></a>my.data <span class="ot">&lt;-</span><span class="fu">read.csv</span>(</span>
<span id="cb145-1321"><a href="#cb145-1321" aria-hidden="true" tabindex="-1"></a>  <span class="st">"https://www.massey.ac.nz/~anhsmith/data/tv.csv"</span>, </span>
<span id="cb145-1322"><a href="#cb145-1322" aria-hidden="true" tabindex="-1"></a>  <span class="at">header=</span><span class="cn">TRUE</span>)</span>
<span id="cb145-1323"><a href="#cb145-1323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1324"><a href="#cb145-1324" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lattice)</span>
<span id="cb145-1325"><a href="#cb145-1325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1326"><a href="#cb145-1326" aria-hidden="true" tabindex="-1"></a><span class="fu">bwplot</span>(TELETIME <span class="sc">~</span> <span class="fu">factor</span>(SCHOOL), </span>
<span id="cb145-1327"><a href="#cb145-1327" aria-hidden="true" tabindex="-1"></a>       <span class="at">data =</span> my.data)</span>
<span id="cb145-1328"><a href="#cb145-1328" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb145-1329"><a href="#cb145-1329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1330"><a href="#cb145-1330" aria-hidden="true" tabindex="-1"></a>It requires a bit of coding to combine base, lattice and ggplot graphs. Try the following codes which combines three density plots of the same data produced in different styles.</span>
<span id="cb145-1331"><a href="#cb145-1331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1332"><a href="#cb145-1332" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.show="hide"}</span></span>
<span id="cb145-1333"><a href="#cb145-1333" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"grid"</span>)</span>
<span id="cb145-1334"><a href="#cb145-1334" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"ggplotify"</span>)</span>
<span id="cb145-1335"><a href="#cb145-1335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1336"><a href="#cb145-1336" aria-hidden="true" tabindex="-1"></a>x<span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">30</span>)</span>
<span id="cb145-1337"><a href="#cb145-1337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1338"><a href="#cb145-1338" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">as.grob</span>(<span class="sc">~</span><span class="fu">plot</span>(<span class="fu">density</span>(x)))</span>
<span id="cb145-1339"><a href="#cb145-1339" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">as.ggplot</span>(p1)</span>
<span id="cb145-1340"><a href="#cb145-1340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1341"><a href="#cb145-1341" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">as.grob</span>(<span class="fu">densityplot</span>(x))</span>
<span id="cb145-1342"><a href="#cb145-1342" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">as.ggplot</span>(p2)</span>
<span id="cb145-1343"><a href="#cb145-1343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1344"><a href="#cb145-1344" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb145-1345"><a href="#cb145-1345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1346"><a href="#cb145-1346" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x=</span>x) <span class="sc">|&gt;</span> </span>
<span id="cb145-1347"><a href="#cb145-1347" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb145-1348"><a href="#cb145-1348" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(x) <span class="sc">+</span></span>
<span id="cb145-1349"><a href="#cb145-1349" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>()</span>
<span id="cb145-1350"><a href="#cb145-1350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1351"><a href="#cb145-1351" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb145-1352"><a href="#cb145-1352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1353"><a href="#cb145-1353" aria-hidden="true" tabindex="-1"></a>p1<span class="sc">/</span>(p2<span class="sc">+</span>p3)</span>
<span id="cb145-1354"><a href="#cb145-1354" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb145-1355"><a href="#cb145-1355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1356"><a href="#cb145-1356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1357"><a href="#cb145-1357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1358"><a href="#cb145-1358" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip}</span>
<span id="cb145-1359"><a href="#cb145-1359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1360"><a href="#cb145-1360" aria-hidden="true" tabindex="-1"></a>It is optional to work through the activities that follow to gain an appreciation of how R works. Do not try to remember how to do everything right now. For your assignment work, we will be given the R codes to load data, graphing and modelling. These codes will give you a head-start. Note that we often often learn R by doing and sometime making mistakes.</span>
<span id="cb145-1361"><a href="#cb145-1361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1362"><a href="#cb145-1362" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb145-1363"><a href="#cb145-1363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1364"><a href="#cb145-1364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1365"><a href="#cb145-1365" aria-hidden="true" tabindex="-1"></a><span class="fu"># R Objects, Model Syntax etc. {.unnumbered}</span></span>
<span id="cb145-1366"><a href="#cb145-1366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1367"><a href="#cb145-1367" aria-hidden="true" tabindex="-1"></a>In R, we work with objects. There are different classes of objects</span>
<span id="cb145-1368"><a href="#cb145-1368" aria-hidden="true" tabindex="-1"></a>including: <span class="in">`character`</span>, <span class="in">`integer`</span>, <span class="in">`numeric`</span>, <span class="in">`vector`</span>, <span class="in">`matrix`</span>,</span>
<span id="cb145-1369"><a href="#cb145-1369" aria-hidden="true" tabindex="-1"></a><span class="in">`array`</span>, <span class="in">`data.frame`</span>, <span class="in">`list`</span>, <span class="in">`lm`</span> (linear model). An object may belong to several classes at once.</span>
<span id="cb145-1370"><a href="#cb145-1370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1371"><a href="#cb145-1371" aria-hidden="true" tabindex="-1"></a>Suppose that your data consists of 4 numbers say 1 to 4. We can combine these numbers using the <span class="in">`c()`</span> function namely <span class="in">`c(1,2,3,4)`</span> and then assign it to <span class="in">`x`</span>, an object.</span>
<span id="cb145-1372"><a href="#cb145-1372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1373"><a href="#cb145-1373" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.show="hide", results='hide'}</span></span>
<span id="cb145-1374"><a href="#cb145-1374" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>)</span>
<span id="cb145-1375"><a href="#cb145-1375" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb145-1376"><a href="#cb145-1376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1377"><a href="#cb145-1377" aria-hidden="true" tabindex="-1"></a>Alternatively, we can use the <span class="in">`scan()`</span> function to enter the data</span>
<span id="cb145-1378"><a href="#cb145-1378" aria-hidden="true" tabindex="-1"></a>manually one by one. In practice we load/import data and these details are explained in the next section.</span>
<span id="cb145-1379"><a href="#cb145-1379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1380"><a href="#cb145-1380" aria-hidden="true" tabindex="-1"></a>Evidently <span class="in">`x`</span> is a vector and also belongs to other classes of objects. This can be queried as follows:</span>
<span id="cb145-1381"><a href="#cb145-1381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1382"><a href="#cb145-1382" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.show="hide", results='hide'}</span></span>
<span id="cb145-1383"><a href="#cb145-1383" aria-hidden="true" tabindex="-1"></a><span class="fu">is</span>(x)</span>
<span id="cb145-1384"><a href="#cb145-1384" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb145-1385"><a href="#cb145-1385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1386"><a href="#cb145-1386" aria-hidden="true" tabindex="-1"></a>The main class it belongs to is queried as</span>
<span id="cb145-1387"><a href="#cb145-1387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1388"><a href="#cb145-1388" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.show="hide", results='hide'}</span></span>
<span id="cb145-1389"><a href="#cb145-1389" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(x)</span>
<span id="cb145-1390"><a href="#cb145-1390" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb145-1391"><a href="#cb145-1391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1392"><a href="#cb145-1392" aria-hidden="true" tabindex="-1"></a>Our data are actually integers and arranged in a pattern. So we can</span>
<span id="cb145-1393"><a href="#cb145-1393" aria-hidden="true" tabindex="-1"></a>define <span class="in">`x`</span> as follows:</span>
<span id="cb145-1394"><a href="#cb145-1394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1395"><a href="#cb145-1395" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.show="hide", results='hide'}</span></span>
<span id="cb145-1396"><a href="#cb145-1396" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span></span>
<span id="cb145-1397"><a href="#cb145-1397" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb145-1398"><a href="#cb145-1398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1399"><a href="#cb145-1399" aria-hidden="true" tabindex="-1"></a>The colon (<span class="in">`:`</span>) operator created the desired pattern. Alternative</span>
<span id="cb145-1400"><a href="#cb145-1400" aria-hidden="true" tabindex="-1"></a>expressions include</span>
<span id="cb145-1401"><a href="#cb145-1401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1402"><a href="#cb145-1402" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.show="hide", results='hide'}</span></span>
<span id="cb145-1403"><a href="#cb145-1403" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">4</span>, <span class="at">by=</span><span class="dv">1</span>)</span>
<span id="cb145-1404"><a href="#cb145-1404" aria-hidden="true" tabindex="-1"></a><span class="in">```</span> </span>
<span id="cb145-1405"><a href="#cb145-1405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1406"><a href="#cb145-1406" aria-hidden="true" tabindex="-1"></a>Try <span class="in">`is(x)`</span> and <span class="in">`class(x)`</span> and check whether our data are recognised as integer class.</span>
<span id="cb145-1407"><a href="#cb145-1407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1408"><a href="#cb145-1408" aria-hidden="true" tabindex="-1"></a>We can do many mathematical manipulations on <span class="in">`x`</span>. Try</span>
<span id="cb145-1409"><a href="#cb145-1409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1410"><a href="#cb145-1410" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.show="hide", results='hide'}</span></span>
<span id="cb145-1411"><a href="#cb145-1411" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(x)</span>
<span id="cb145-1412"><a href="#cb145-1412" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(x)</span>
<span id="cb145-1413"><a href="#cb145-1413" aria-hidden="true" tabindex="-1"></a><span class="fu">max</span>(x)</span>
<span id="cb145-1414"><a href="#cb145-1414" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(x)</span>
<span id="cb145-1415"><a href="#cb145-1415" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(x)</span>
<span id="cb145-1416"><a href="#cb145-1416" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(x)</span>
<span id="cb145-1417"><a href="#cb145-1417" aria-hidden="true" tabindex="-1"></a><span class="fu">sort</span>(x, T)</span>
<span id="cb145-1418"><a href="#cb145-1418" aria-hidden="true" tabindex="-1"></a><span class="fu">trunc</span>(x<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb145-1419"><a href="#cb145-1419" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb145-1420"><a href="#cb145-1420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1421"><a href="#cb145-1421" aria-hidden="true" tabindex="-1"></a>Vector elements are accessed by square brackets, <span class="in">`[]`</span>. Try</span>
<span id="cb145-1422"><a href="#cb145-1422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1423"><a href="#cb145-1423" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.show="hide", results='hide'}</span></span>
<span id="cb145-1424"><a href="#cb145-1424" aria-hidden="true" tabindex="-1"></a>x[<span class="dv">2</span>]<span class="sc">+</span>x[<span class="dv">4</span>]</span>
<span id="cb145-1425"><a href="#cb145-1425" aria-hidden="true" tabindex="-1"></a>x[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb145-1426"><a href="#cb145-1426" aria-hidden="true" tabindex="-1"></a>x[<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>)]</span>
<span id="cb145-1427"><a href="#cb145-1427" aria-hidden="true" tabindex="-1"></a>x[<span class="sc">-</span><span class="dv">2</span>]</span>
<span id="cb145-1428"><a href="#cb145-1428" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb145-1429"><a href="#cb145-1429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1430"><a href="#cb145-1430" aria-hidden="true" tabindex="-1"></a>Assume that our data are actually categorical codes. Then the correct way of defining the character data is to use single quotes as</span>
<span id="cb145-1431"><a href="#cb145-1431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1432"><a href="#cb145-1432" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.show="hide", results='hide'}</span></span>
<span id="cb145-1433"><a href="#cb145-1433" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'a'</span>, <span class="st">'b'</span>, <span class="st">'c'</span>, <span class="st">'d'</span>)</span>
<span id="cb145-1434"><a href="#cb145-1434" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb145-1435"><a href="#cb145-1435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1436"><a href="#cb145-1436" aria-hidden="true" tabindex="-1"></a>Now try Try <span class="in">`is(x)`</span> and <span class="in">`class(x)`</span>. For large patterned categorical</span>
<span id="cb145-1437"><a href="#cb145-1437" aria-hidden="true" tabindex="-1"></a>data, placing quotes is laborious. So we can change the class as</span>
<span id="cb145-1438"><a href="#cb145-1438" aria-hidden="true" tabindex="-1"></a>follows:</span>
<span id="cb145-1439"><a href="#cb145-1439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1440"><a href="#cb145-1440" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.show="hide", results='hide'}</span></span>
<span id="cb145-1441"><a href="#cb145-1441" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)</span>
<span id="cb145-1442"><a href="#cb145-1442" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb145-1443"><a href="#cb145-1443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1444"><a href="#cb145-1444" aria-hidden="true" tabindex="-1"></a>Assume that you have two batches of data. The first one is</span>
<span id="cb145-1445"><a href="#cb145-1445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1446"><a href="#cb145-1446" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.show="hide", results='hide'}</span></span>
<span id="cb145-1447"><a href="#cb145-1447" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span> </span>
<span id="cb145-1448"><a href="#cb145-1448" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb145-1449"><a href="#cb145-1449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1450"><a href="#cb145-1450" aria-hidden="true" tabindex="-1"></a>and the second one is</span>
<span id="cb145-1451"><a href="#cb145-1451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1452"><a href="#cb145-1452" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.show="hide", results='hide'}</span></span>
<span id="cb145-1453"><a href="#cb145-1453" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'a'</span>, <span class="st">'b'</span>, <span class="st">'c'</span>, <span class="st">'d'</span>)</span>
<span id="cb145-1454"><a href="#cb145-1454" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb145-1455"><a href="#cb145-1455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1456"><a href="#cb145-1456" aria-hidden="true" tabindex="-1"></a>These two batches can be combined into a matrix as follows:</span>
<span id="cb145-1457"><a href="#cb145-1457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1458"><a href="#cb145-1458" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.show="hide", results='hide'}</span></span>
<span id="cb145-1459"><a href="#cb145-1459" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">cbind</span>(x,y)</span>
<span id="cb145-1460"><a href="#cb145-1460" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb145-1461"><a href="#cb145-1461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1462"><a href="#cb145-1462" aria-hidden="true" tabindex="-1"></a>Here the matrix <span class="in">`m`</span> is formed by binding the columns (vectors). The</span>
<span id="cb145-1463"><a href="#cb145-1463" aria-hidden="true" tabindex="-1"></a>other option is to bind as rows</span>
<span id="cb145-1464"><a href="#cb145-1464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1465"><a href="#cb145-1465" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.show="hide", results='hide'}</span></span>
<span id="cb145-1466"><a href="#cb145-1466" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">rbind</span>(x,y)</span>
<span id="cb145-1467"><a href="#cb145-1467" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb145-1468"><a href="#cb145-1468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1469"><a href="#cb145-1469" aria-hidden="true" tabindex="-1"></a>Evidently vectors must be of the same length for these commands to work. We can also form a matrix by splitting a vector. Try</span>
<span id="cb145-1470"><a href="#cb145-1470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1471"><a href="#cb145-1471" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.show="hide", results='hide'}</span></span>
<span id="cb145-1472"><a href="#cb145-1472" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span></span>
<span id="cb145-1473"><a href="#cb145-1473" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">matrix</span>(x, <span class="at">byrow =</span> <span class="cn">TRUE</span>, <span class="at">ncol =</span> <span class="dv">3</span>)</span>
<span id="cb145-1474"><a href="#cb145-1474" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">matrix</span>(x, <span class="at">byrow =</span> <span class="cn">TRUE</span>, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb145-1475"><a href="#cb145-1475" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb145-1476"><a href="#cb145-1476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1477"><a href="#cb145-1477" aria-hidden="true" tabindex="-1"></a>and just type <span class="in">`m`</span> to see the generated matrix on the R console.</span>
<span id="cb145-1478"><a href="#cb145-1478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1479"><a href="#cb145-1479" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.show="hide", results='hide'}</span></span>
<span id="cb145-1480"><a href="#cb145-1480" aria-hidden="true" tabindex="-1"></a>m</span>
<span id="cb145-1481"><a href="#cb145-1481" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb145-1482"><a href="#cb145-1482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1483"><a href="#cb145-1483" aria-hidden="true" tabindex="-1"></a>To access the first of row of the matrix <span class="in">`m`</span>, we use <span class="in">`m[1,]`</span>; to access the first column of <span class="in">`m`</span>, we use <span class="in">`m[,1]`</span>.</span>
<span id="cb145-1484"><a href="#cb145-1484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1485"><a href="#cb145-1485" aria-hidden="true" tabindex="-1"></a>A <span class="in">`data frame`</span> is an R object that contains vectors; the vectors are</span>
<span id="cb145-1486"><a href="#cb145-1486" aria-hidden="true" tabindex="-1"></a>stored vertically in a matrix like structure, and can be referred to by the name of the column. The main advantage of a data frame is that the variables in a data frame do not all need to be the same type; e.g. some variables can be of class numeric, and some variables can be of class character. We can create a data frame object using the <span class="in">`data.frame()`</span> function. This data frame contains two small vectors, the first of which is named <span class="in">`ID`</span>, and the second <span class="in">`NAME`</span>. Try </span>
<span id="cb145-1487"><a href="#cb145-1487" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1488"><a href="#cb145-1488" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.show="hide", results='hide'}</span></span>
<span id="cb145-1489"><a href="#cb145-1489" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span></span>
<span id="cb145-1490"><a href="#cb145-1490" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'a'</span>, <span class="st">'b'</span>, <span class="st">'c'</span>, <span class="st">'d'</span>)</span>
<span id="cb145-1491"><a href="#cb145-1491" aria-hidden="true" tabindex="-1"></a>my.data <span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">ID=</span>x, <span class="at">NAME=</span>y)</span>
<span id="cb145-1492"><a href="#cb145-1492" aria-hidden="true" tabindex="-1"></a>my.data </span>
<span id="cb145-1493"><a href="#cb145-1493" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb145-1494"><a href="#cb145-1494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1495"><a href="#cb145-1495" aria-hidden="true" tabindex="-1"></a>We can access the original vector of interest in the following way:</span>
<span id="cb145-1496"><a href="#cb145-1496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1497"><a href="#cb145-1497" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.show="hide", results='hide'}</span></span>
<span id="cb145-1498"><a href="#cb145-1498" aria-hidden="true" tabindex="-1"></a>my.data<span class="sc">$</span>NAME</span>
<span id="cb145-1499"><a href="#cb145-1499" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb145-1500"><a href="#cb145-1500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1501"><a href="#cb145-1501" aria-hidden="true" tabindex="-1"></a>or with <span class="in">`tidyverse`</span></span>
<span id="cb145-1502"><a href="#cb145-1502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1503"><a href="#cb145-1503" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.show="hide", results='hide'}</span></span>
<span id="cb145-1504"><a href="#cb145-1504" aria-hidden="true" tabindex="-1"></a>my.data <span class="sc">|&gt;</span> <span class="fu">pull</span>(NAME)</span>
<span id="cb145-1505"><a href="#cb145-1505" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb145-1506"><a href="#cb145-1506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1507"><a href="#cb145-1507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1508"><a href="#cb145-1508" aria-hidden="true" tabindex="-1"></a>There are times when it is useful to convert a data frame into a matrix; we can do this with the <span class="in">`as.matrix()`</span> function.</span>
<span id="cb145-1509"><a href="#cb145-1509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1510"><a href="#cb145-1510" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.show="hide", results='hide'}</span></span>
<span id="cb145-1511"><a href="#cb145-1511" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(my.data)</span>
<span id="cb145-1512"><a href="#cb145-1512" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb145-1513"><a href="#cb145-1513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1514"><a href="#cb145-1514" aria-hidden="true" tabindex="-1"></a>Type <span class="in">`class(m)`</span> and see the changes.</span>
<span id="cb145-1515"><a href="#cb145-1515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1516"><a href="#cb145-1516" aria-hidden="true" tabindex="-1"></a>Two data frames can also be merged into a single data frame using the <span class="in">`merge`</span> command.</span>
<span id="cb145-1517"><a href="#cb145-1517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1518"><a href="#cb145-1518" aria-hidden="true" tabindex="-1"></a>The internal structure of an R object can be viewed using the diagnostic function <span class="in">`str()`</span>.</span>
<span id="cb145-1519"><a href="#cb145-1519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1520"><a href="#cb145-1520" aria-hidden="true" tabindex="-1"></a>*Simple Manipulations*</span>
<span id="cb145-1521"><a href="#cb145-1521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1522"><a href="#cb145-1522" aria-hidden="true" tabindex="-1"></a>There is always more than one-way of manipulating the data, producing summaries and tables from raw data.</span>
<span id="cb145-1523"><a href="#cb145-1523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1524"><a href="#cb145-1524" aria-hidden="true" tabindex="-1"></a>One of the simplest manipulations on a batch of data we may do is to</span>
<span id="cb145-1525"><a href="#cb145-1525" aria-hidden="true" tabindex="-1"></a>change the data type say numeric to character. For example, the</span>
<span id="cb145-1526"><a href="#cb145-1526" aria-hidden="true" tabindex="-1"></a>television viewing time data in the text file <span class="in">`tv.csv`</span> is read into a dataframe by the command line</span>
<span id="cb145-1527"><a href="#cb145-1527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1528"><a href="#cb145-1528" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.show="hide", results='hide'}</span></span>
<span id="cb145-1529"><a href="#cb145-1529" aria-hidden="true" tabindex="-1"></a>my.data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(</span>
<span id="cb145-1530"><a href="#cb145-1530" aria-hidden="true" tabindex="-1"></a>  <span class="st">"https://www.massey.ac.nz/~anhsmith/data/tv.csv"</span>, </span>
<span id="cb145-1531"><a href="#cb145-1531" aria-hidden="true" tabindex="-1"></a>  <span class="at">header =</span><span class="cn">TRUE</span></span>
<span id="cb145-1532"><a href="#cb145-1532" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb145-1533"><a href="#cb145-1533" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb145-1534"><a href="#cb145-1534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1535"><a href="#cb145-1535" aria-hidden="true" tabindex="-1"></a>We can improve the <span class="in">`read.csv`</span> command to recognise the data type while reading the table as follows, using the <span class="in">`read_csv`</span> command from the <span class="in">`readr`</span> package:</span>
<span id="cb145-1536"><a href="#cb145-1536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1539"><a href="#cb145-1539" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb145-1540"><a href="#cb145-1540" aria-hidden="true" tabindex="-1"></a>my.data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(</span>
<span id="cb145-1541"><a href="#cb145-1541" aria-hidden="true" tabindex="-1"></a>  <span class="st">"https://www.massey.ac.nz/~anhsmith/data/tv.csv"</span>, </span>
<span id="cb145-1542"><a href="#cb145-1542" aria-hidden="true" tabindex="-1"></a>  <span class="at">col_types =</span> <span class="st">"nfcc"</span></span>
<span id="cb145-1543"><a href="#cb145-1543" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb145-1544"><a href="#cb145-1544" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb145-1545"><a href="#cb145-1545" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1546"><a href="#cb145-1546" aria-hidden="true" tabindex="-1"></a>The argument <span class="in">`col_types = "nfcc"`</span> stands for <span class="sc">\{</span><span class="in">`numeric`</span>, <span class="in">`factor`</span>, <span class="in">`character`</span>, <span class="in">`character`</span><span class="sc">\}</span>, to match the order of the columns.</span>
<span id="cb145-1547"><a href="#cb145-1547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1550"><a href="#cb145-1550" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb145-1551"><a href="#cb145-1551" aria-hidden="true" tabindex="-1"></a>my.data</span>
<span id="cb145-1552"><a href="#cb145-1552" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb145-1553"><a href="#cb145-1553" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1554"><a href="#cb145-1554" aria-hidden="true" tabindex="-1"></a>We often do a summary of a numerical variable for a given categorical variable. For example, we like to see obtain the summary statistics of TV viewing times for various schools. The commands</span>
<span id="cb145-1555"><a href="#cb145-1555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1556"><a href="#cb145-1556" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.show="hide", results='hide'}</span></span>
<span id="cb145-1557"><a href="#cb145-1557" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(my.data)</span>
<span id="cb145-1558"><a href="#cb145-1558" aria-hidden="true" tabindex="-1"></a><span class="fu">by</span>(TELETIME, SCHOOL, summary)</span>
<span id="cb145-1559"><a href="#cb145-1559" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb145-1560"><a href="#cb145-1560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1561"><a href="#cb145-1561" aria-hidden="true" tabindex="-1"></a>We employed the <span class="in">`by()`</span> command above and instead, we may also use</span>
<span id="cb145-1562"><a href="#cb145-1562" aria-hidden="true" tabindex="-1"></a><span class="in">`tapply()`</span> <span class="in">`aggregate()`</span> functions:</span>
<span id="cb145-1563"><a href="#cb145-1563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1564"><a href="#cb145-1564" aria-hidden="true" tabindex="-1"></a><span class="in">`tapply(TELETIME, SCHOOL, summary)`</span></span>
<span id="cb145-1565"><a href="#cb145-1565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1566"><a href="#cb145-1566" aria-hidden="true" tabindex="-1"></a><span class="in">`aggregate(TELETIME, list(SCHOOL), summary)`</span></span>
<span id="cb145-1567"><a href="#cb145-1567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1568"><a href="#cb145-1568" aria-hidden="true" tabindex="-1"></a>A tabulated summary of categorical data is obtained using the <span class="in">`table()`</span></span>
<span id="cb145-1569"><a href="#cb145-1569" aria-hidden="true" tabindex="-1"></a>command.</span>
<span id="cb145-1570"><a href="#cb145-1570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1571"><a href="#cb145-1571" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.show="hide", results='hide'}</span></span>
<span id="cb145-1572"><a href="#cb145-1572" aria-hidden="true" tabindex="-1"></a>my.data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(</span>
<span id="cb145-1573"><a href="#cb145-1573" aria-hidden="true" tabindex="-1"></a>  <span class="st">"https://www.massey.ac.nz/~anhsmith/data/rangitikei.csv"</span>,</span>
<span id="cb145-1574"><a href="#cb145-1574" aria-hidden="true" tabindex="-1"></a>  <span class="at">header=</span><span class="cn">TRUE</span></span>
<span id="cb145-1575"><a href="#cb145-1575" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb145-1576"><a href="#cb145-1576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1577"><a href="#cb145-1577" aria-hidden="true" tabindex="-1"></a>wind <span class="ot">&lt;-</span> my.data <span class="sc">|&gt;</span> <span class="fu">pull</span>(wind)</span>
<span id="cb145-1578"><a href="#cb145-1578" aria-hidden="true" tabindex="-1"></a>river <span class="ot">&lt;-</span> my.data <span class="sc">|&gt;</span> <span class="fu">pull</span>(river)</span>
<span id="cb145-1579"><a href="#cb145-1579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1580"><a href="#cb145-1580" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(wind, river)</span>
<span id="cb145-1581"><a href="#cb145-1581" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb145-1582"><a href="#cb145-1582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1583"><a href="#cb145-1583" aria-hidden="true" tabindex="-1"></a>It is sometimes convenient to work with matrices for some R functions</span>
<span id="cb145-1584"><a href="#cb145-1584" aria-hidden="true" tabindex="-1"></a>such as <span class="in">`apply()`</span>. For example, the number of admissions data in</span>
<span id="cb145-1585"><a href="#cb145-1585" aria-hidden="true" tabindex="-1"></a><span class="in">`hospital.txt`</span> data can be formed as a matrix. Note that this is</span>
<span id="cb145-1586"><a href="#cb145-1586" aria-hidden="true" tabindex="-1"></a>possible because we have the same number of observations for each</span>
<span id="cb145-1587"><a href="#cb145-1587" aria-hidden="true" tabindex="-1"></a>hospital location.</span>
<span id="cb145-1588"><a href="#cb145-1588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1589"><a href="#cb145-1589" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.show="hide", results='hide'}</span></span>
<span id="cb145-1590"><a href="#cb145-1590" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.table</span>(</span>
<span id="cb145-1591"><a href="#cb145-1591" aria-hidden="true" tabindex="-1"></a>  <span class="st">"https://www.massey.ac.nz/~anhsmith/data/hospital.txt"</span>,</span>
<span id="cb145-1592"><a href="#cb145-1592" aria-hidden="true" tabindex="-1"></a>  <span class="at">header=</span><span class="cn">TRUE</span>, </span>
<span id="cb145-1593"><a href="#cb145-1593" aria-hidden="true" tabindex="-1"></a>  <span class="at">sep=</span><span class="st">","</span>)</span>
<span id="cb145-1594"><a href="#cb145-1594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1595"><a href="#cb145-1595" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> </span>
<span id="cb145-1596"><a href="#cb145-1596" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(NORTH1, NORTH2, NORTH3, </span>
<span id="cb145-1597"><a href="#cb145-1597" aria-hidden="true" tabindex="-1"></a>         SOUTH1, SOUTH2, SOUTH3) <span class="sc">|&gt;</span> </span>
<span id="cb145-1598"><a href="#cb145-1598" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sqrt</span>()</span>
<span id="cb145-1599"><a href="#cb145-1599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1600"><a href="#cb145-1600" aria-hidden="true" tabindex="-1"></a>means <span class="ot">&lt;-</span> <span class="fu">apply</span>(M, <span class="dv">1</span>, mean)</span>
<span id="cb145-1601"><a href="#cb145-1601" aria-hidden="true" tabindex="-1"></a>sds <span class="ot">&lt;-</span> <span class="fu">apply</span>(M, <span class="dv">1</span>, sd)</span>
<span id="cb145-1602"><a href="#cb145-1602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1603"><a href="#cb145-1603" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(means, sds)</span>
<span id="cb145-1604"><a href="#cb145-1604" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb145-1605"><a href="#cb145-1605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1606"><a href="#cb145-1606" aria-hidden="true" tabindex="-1"></a>*R default options for Hypothesis tests and modelling*</span>
<span id="cb145-1607"><a href="#cb145-1607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1608"><a href="#cb145-1608" aria-hidden="true" tabindex="-1"></a>The <span class="in">`stats`</span> default package in R has a number of functions for</span>
<span id="cb145-1609"><a href="#cb145-1609" aria-hidden="true" tabindex="-1"></a>performing hypothesis tests. However you will only use the following for</span>
<span id="cb145-1610"><a href="#cb145-1610" aria-hidden="true" tabindex="-1"></a>this course:</span>
<span id="cb145-1611"><a href="#cb145-1611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1612"><a href="#cb145-1612" aria-hidden="true" tabindex="-1"></a><span class="in">`ks.test`</span> - Kolmogorov-Smirnov Tests</span>
<span id="cb145-1613"><a href="#cb145-1613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1614"><a href="#cb145-1614" aria-hidden="true" tabindex="-1"></a><span class="in">`shapiro.test`</span> - Shapiro-Wilk Normality Test</span>
<span id="cb145-1615"><a href="#cb145-1615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1616"><a href="#cb145-1616" aria-hidden="true" tabindex="-1"></a><span class="in">`t.test`</span> - Student's t-Test (one &amp; two samples, paired t-test etc)</span>
<span id="cb145-1617"><a href="#cb145-1617" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1618"><a href="#cb145-1618" aria-hidden="true" tabindex="-1"></a><span class="in">`pairwise.t.test`</span> - Pairwise t tests (for multiple comparison)</span>
<span id="cb145-1619"><a href="#cb145-1619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1620"><a href="#cb145-1620" aria-hidden="true" tabindex="-1"></a><span class="in">`oneway.test`</span> - Test for Equal Means in a One-Way Layout</span>
<span id="cb145-1621"><a href="#cb145-1621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1622"><a href="#cb145-1622" aria-hidden="true" tabindex="-1"></a><span class="in">`TukeyHSD`</span> - To Compute Tukey's Honest Significant Differences</span>
<span id="cb145-1623"><a href="#cb145-1623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1624"><a href="#cb145-1624" aria-hidden="true" tabindex="-1"></a><span class="in">`var.test`</span> - F Test to Compare Two Variances</span>
<span id="cb145-1625"><a href="#cb145-1625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1626"><a href="#cb145-1626" aria-hidden="true" tabindex="-1"></a><span class="in">`bartlett.test`</span> - Bartlett Test of Homogeneity of Variances</span>
<span id="cb145-1627"><a href="#cb145-1627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1628"><a href="#cb145-1628" aria-hidden="true" tabindex="-1"></a><span class="in">`fisher.test`</span> - Fisher's Exact Test for Count Data</span>
<span id="cb145-1629"><a href="#cb145-1629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1630"><a href="#cb145-1630" aria-hidden="true" tabindex="-1"></a><span class="in">`chisq.test`</span> - Pearson's Chi-squared Test for Count Data</span>
<span id="cb145-1631"><a href="#cb145-1631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1632"><a href="#cb145-1632" aria-hidden="true" tabindex="-1"></a><span class="in">`cor.test`</span> - Test for Association/Correlation Between Paired Samples</span>
<span id="cb145-1633"><a href="#cb145-1633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1634"><a href="#cb145-1634" aria-hidden="true" tabindex="-1"></a>The <span class="in">`car`</span> package is needed for the following:</span>
<span id="cb145-1635"><a href="#cb145-1635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1636"><a href="#cb145-1636" aria-hidden="true" tabindex="-1"></a><span class="in">`durbinWatsonTest `</span> Durbin-Watson Test for autocorrelated Errors</span>
<span id="cb145-1637"><a href="#cb145-1637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1638"><a href="#cb145-1638" aria-hidden="true" tabindex="-1"></a><span class="in">`leveneTest`</span> Levene's Test</span>
<span id="cb145-1639"><a href="#cb145-1639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1640"><a href="#cb145-1640" aria-hidden="true" tabindex="-1"></a>We will largely use the R function <span class="in">`lm`</span> in this course. The syntax for specifying a model under <span class="in">`lm`</span> command (and various other model related commands) is explained below:</span>
<span id="cb145-1641"><a href="#cb145-1641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1642"><a href="#cb145-1642" aria-hidden="true" tabindex="-1"></a>The structure of the model is that the response variable is modelled as a function of the response variables. The symbol <span class="in">`~`</span> (tilde) is used to say "a function of". The simple regression of <span class="in">`y`</span> on <span class="in">`x`</span> is therefore specified as</span>
<span id="cb145-1643"><a href="#cb145-1643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1644"><a href="#cb145-1644" aria-hidden="true" tabindex="-1"></a><span class="in">`lm(y ~ x)`</span></span>
<span id="cb145-1645"><a href="#cb145-1645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1646"><a href="#cb145-1646" aria-hidden="true" tabindex="-1"></a>The same applies to a one-way ANOVA in which <span class="in">`x`</span> is a categorical factor. For example, consider <span class="in">`tv.txt`</span> dataset and the one-way ANOVA model of <span class="in">`TELETIME`</span> for <span class="in">`SCHOOL`</span> is specified as follows:</span>
<span id="cb145-1647"><a href="#cb145-1647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1648"><a href="#cb145-1648" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, results='hide'}</span></span>
<span id="cb145-1649"><a href="#cb145-1649" aria-hidden="true" tabindex="-1"></a>mydata <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(</span>
<span id="cb145-1650"><a href="#cb145-1650" aria-hidden="true" tabindex="-1"></a>  <span class="st">"https://www.massey.ac.nz/~anhsmith/data/tv.csv"</span>, </span>
<span id="cb145-1651"><a href="#cb145-1651" aria-hidden="true" tabindex="-1"></a>  <span class="at">header=</span><span class="cn">TRUE</span></span>
<span id="cb145-1652"><a href="#cb145-1652" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb145-1653"><a href="#cb145-1653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1654"><a href="#cb145-1654" aria-hidden="true" tabindex="-1"></a>mymodel <span class="ot">&lt;-</span> <span class="fu">lm</span>(TELETIME <span class="sc">~</span> <span class="fu">factor</span>(SCHOOL), </span>
<span id="cb145-1655"><a href="#cb145-1655" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> mydata) <span class="co"># replace lm by aov and try</span></span>
<span id="cb145-1656"><a href="#cb145-1656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1657"><a href="#cb145-1657" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mymodel)</span>
<span id="cb145-1658"><a href="#cb145-1658" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb145-1659"><a href="#cb145-1659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1660"><a href="#cb145-1660" aria-hidden="true" tabindex="-1"></a>The function <span class="in">`summary()`</span> gives the summary of the model (F statistics, residual SD etc). The model summary output can be stored into a text file using the function <span class="in">`sink()`</span> or copy and paste in the windows version. Graphs associated with a model can be obtained using the command</span>
<span id="cb145-1661"><a href="#cb145-1661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1662"><a href="#cb145-1662" aria-hidden="true" tabindex="-1"></a><span class="in">`plot(mymodel)`</span></span>
<span id="cb145-1663"><a href="#cb145-1663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1664"><a href="#cb145-1664" aria-hidden="true" tabindex="-1"></a>In the above context, we may also use the specific test command which will give the same result but this test can also be performed without assuming equal variances.</span>
<span id="cb145-1665"><a href="#cb145-1665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1666"><a href="#cb145-1666" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.show="hide", results='hide'}</span></span>
<span id="cb145-1667"><a href="#cb145-1667" aria-hidden="true" tabindex="-1"></a><span class="fu">oneway.test</span>(TELETIME <span class="sc">~</span> SCHOOL, </span>
<span id="cb145-1668"><a href="#cb145-1668" aria-hidden="true" tabindex="-1"></a>            <span class="at">var.equal =</span> <span class="cn">TRUE</span>, </span>
<span id="cb145-1669"><a href="#cb145-1669" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> mydata) </span>
<span id="cb145-1670"><a href="#cb145-1670" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb145-1671"><a href="#cb145-1671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1672"><a href="#cb145-1672" aria-hidden="true" tabindex="-1"></a>For the <span class="in">`lm`</span> command, note the following:</span>
<span id="cb145-1673"><a href="#cb145-1673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1674"><a href="#cb145-1674" aria-hidden="true" tabindex="-1"></a><span class="in">`+`</span> indicates inclusion (not addition) of an explanatory variable in the model</span>
<span id="cb145-1675"><a href="#cb145-1675" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1676"><a href="#cb145-1676" aria-hidden="true" tabindex="-1"></a><span class="in">`-`</span> indicates deletion (not subtraction) of an explanatory variable from the model</span>
<span id="cb145-1677"><a href="#cb145-1677" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1678"><a href="#cb145-1678" aria-hidden="true" tabindex="-1"></a><span class="in">`*`</span> indicates the inclusion of the explanatory variables and their</span>
<span id="cb145-1679"><a href="#cb145-1679" aria-hidden="true" tabindex="-1"></a>interaction (not multiplication) between explanatory variables</span>
<span id="cb145-1680"><a href="#cb145-1680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1681"><a href="#cb145-1681" aria-hidden="true" tabindex="-1"></a><span class="in">`:`</span> (colon) means only interaction between explanatory variables</span>
<span id="cb145-1682"><a href="#cb145-1682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1683"><a href="#cb145-1683" aria-hidden="true" tabindex="-1"></a><span class="in">`/`</span> indicates the nesting (not division) of explanatory variables</span>
<span id="cb145-1684"><a href="#cb145-1684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1685"><a href="#cb145-1685" aria-hidden="true" tabindex="-1"></a><span class="in">`|`</span> indicates the conditioning (for example <span class="in">`y ~ x|z`</span> means that y is a function of x for given z).</span>
<span id="cb145-1686"><a href="#cb145-1686" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1687"><a href="#cb145-1687" aria-hidden="true" tabindex="-1"></a>For our course, you will not use the last two types. Some model examples are given below:</span>
<span id="cb145-1688"><a href="#cb145-1688" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1689"><a href="#cb145-1689" aria-hidden="true" tabindex="-1"></a><span class="in">`lm(y ~ x + z)`</span> <span class="sc">\#</span>regression of y on x and z (flat surface fit)</span>
<span id="cb145-1690"><a href="#cb145-1690" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1691"><a href="#cb145-1691" aria-hidden="true" tabindex="-1"></a><span class="in">`lm(y ~ x*z)`</span> <span class="sc">\#</span>includes the interaction term ie <span class="in">`lm(y ~ x + z + x:z)`</span></span>
<span id="cb145-1692"><a href="#cb145-1692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1693"><a href="#cb145-1693" aria-hidden="true" tabindex="-1"></a><span class="in">`lm(y ~ x + I(x^2)`</span> <span class="sc">\#</span> fits a quadratic model or use <span class="in">`poly(x,2)`</span></span>
<span id="cb145-1694"><a href="#cb145-1694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1695"><a href="#cb145-1695" aria-hidden="true" tabindex="-1"></a><span class="in">`lm(log(y) ~ sqrt(x) + log(z))`</span> <span class="sc">\#</span>all variables are transformed</span>
<span id="cb145-1696"><a href="#cb145-1696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1697"><a href="#cb145-1697" aria-hidden="true" tabindex="-1"></a>As a further example, consider a study guide dataset. The following</span>
<span id="cb145-1698"><a href="#cb145-1698" aria-hidden="true" tabindex="-1"></a>commands fit a simple regression model and then plot the fitted line on a scatter plot. Note that commands can be shortened but deliberately shown this way.</span>
<span id="cb145-1699"><a href="#cb145-1699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1700"><a href="#cb145-1700" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.show="hide", results='hide'}</span></span>
<span id="cb145-1701"><a href="#cb145-1701" aria-hidden="true" tabindex="-1"></a>mydata <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(</span>
<span id="cb145-1702"><a href="#cb145-1702" aria-hidden="true" tabindex="-1"></a>  <span class="st">"https://www.massey.ac.nz/~anhsmith/data/horsehearts.csv"</span>, </span>
<span id="cb145-1703"><a href="#cb145-1703" aria-hidden="true" tabindex="-1"></a>  <span class="at">header=</span><span class="cn">TRUE</span></span>
<span id="cb145-1704"><a href="#cb145-1704" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb145-1705"><a href="#cb145-1705" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1706"><a href="#cb145-1706" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> mydata<span class="sc">$</span>EXTDIA</span>
<span id="cb145-1707"><a href="#cb145-1707" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> mydata<span class="sc">$</span>WEIGHT</span>
<span id="cb145-1708"><a href="#cb145-1708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1709"><a href="#cb145-1709" aria-hidden="true" tabindex="-1"></a>simplereg <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x)</span>
<span id="cb145-1710"><a href="#cb145-1710" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb145-1711"><a href="#cb145-1711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1712"><a href="#cb145-1712" aria-hidden="true" tabindex="-1"></a>Note that our model object <span class="in">`simplereg`</span> can be queried in many ways. The command <span class="in">`summary()`</span> gives the following output.</span>
<span id="cb145-1713"><a href="#cb145-1713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1714"><a href="#cb145-1714" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.show="hide", results='hide'}</span></span>
<span id="cb145-1715"><a href="#cb145-1715" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(simplereg)</span>
<span id="cb145-1716"><a href="#cb145-1716" aria-hidden="true" tabindex="-1"></a><span class="co"># or</span></span>
<span id="cb145-1717"><a href="#cb145-1717" aria-hidden="true" tabindex="-1"></a><span class="co"># library(broom)</span></span>
<span id="cb145-1718"><a href="#cb145-1718" aria-hidden="true" tabindex="-1"></a><span class="co"># tidy(simplereg)</span></span>
<span id="cb145-1719"><a href="#cb145-1719" aria-hidden="true" tabindex="-1"></a><span class="co"># glance(simplereg)</span></span>
<span id="cb145-1720"><a href="#cb145-1720" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb145-1721"><a href="#cb145-1721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1722"><a href="#cb145-1722" aria-hidden="true" tabindex="-1"></a>The command <span class="in">`names(simplereg)`</span> will gives the names of many individual components of the object <span class="in">`simplereg`</span> we created. For example, a plot of the residuals against the fitted values can be obtained as</span>
<span id="cb145-1723"><a href="#cb145-1723" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-1724"><a href="#cb145-1724" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.show="hide", results='hide'}</span></span>
<span id="cb145-1725"><a href="#cb145-1725" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">residuals</span>(simplereg) <span class="sc">~</span> <span class="fu">fitted.values</span>(simplereg))</span>
<span id="cb145-1726"><a href="#cb145-1726" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb145-1727"><a href="#cb145-1727" aria-hidden="true" tabindex="-1"></a></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>